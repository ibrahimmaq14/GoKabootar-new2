/*! For license information please see upload.js.LICENSE.txt */
(()=>{var e,t={11:(e,t,n)=>{let r;e.exports="function"==typeof queueMicrotask?queueMicrotask.bind("undefined"!=typeof window?window:n.g):e=>(r||(r=Promise.resolve())).then(e).catch((e=>setTimeout((()=>{throw e}),0)))},477:()=>{},519:(e,t,n)=>{"use strict";var r=n(564),o=n(725),s=/^[\x00-\x20\u00a0\u1680\u2000-\u200a\u2028\u2029\u202f\u205f\u3000\ufeff]+/,i=/[\n\r\t]/g,a=/^[A-Za-z][A-Za-z0-9+-.]*:\/\//,l=/:\d+$/,c=/^([a-z][a-z0-9.+-]*:)?(\/\/)?([\\/]+)?([\S\s]*)/i,u=/^[a-zA-Z]:/;function d(e){return(e||"").toString().replace(s,"")}var p=[["#","hash"],["?","query"],function(e,t){return m(t.protocol)?e.replace(/\\/g,"/"):e},["/","pathname"],["@","auth",1],[NaN,"host",void 0,1,1],[/:(\d*)$/,"port",void 0,1],[NaN,"hostname",void 0,1,1]],f={hash:1,query:1};function h(e){var t,r=("undefined"!=typeof window?window:void 0!==n.g?n.g:"undefined"!=typeof self?self:{}).location||{},o={},s=typeof(e=e||r);if("blob:"===e.protocol)o=new g(unescape(e.pathname),{});else if("string"===s)for(t in o=new g(e,{}),f)delete o[t];else if("object"===s){for(t in e)t in f||(o[t]=e[t]);void 0===o.slashes&&(o.slashes=a.test(e.href))}return o}function m(e){return"file:"===e||"ftp:"===e||"http:"===e||"https:"===e||"ws:"===e||"wss:"===e}function w(e,t){e=(e=d(e)).replace(i,""),t=t||{};var n,r=c.exec(e),o=r[1]?r[1].toLowerCase():"",s=!!r[2],a=!!r[3],l=0;return s?a?(n=r[2]+r[3]+r[4],l=r[2].length+r[3].length):(n=r[2]+r[4],l=r[2].length):a?(n=r[3]+r[4],l=r[3].length):n=r[4],"file:"===o?l>=2&&(n=n.slice(2)):m(o)?n=r[4]:o?s&&(n=n.slice(2)):l>=2&&m(t.protocol)&&(n=r[4]),{protocol:o,slashes:s||m(o),slashesCount:l,rest:n}}function g(e,t,n){if(e=(e=d(e)).replace(i,""),!(this instanceof g))return new g(e,t,n);var s,a,l,c,f,v,b=p.slice(),y=typeof t,A=this,_=0;for("object"!==y&&"string"!==y&&(n=t,t=null),n&&"function"!=typeof n&&(n=o.parse),s=!(a=w(e||"",t=h(t))).protocol&&!a.slashes,A.slashes=a.slashes||s&&t.slashes,A.protocol=a.protocol||t.protocol||"",e=a.rest,("file:"===a.protocol&&(2!==a.slashesCount||u.test(e))||!a.slashes&&(a.protocol||a.slashesCount<2||!m(A.protocol)))&&(b[3]=[/(.*)/,"pathname"]);_<b.length;_++)"function"!=typeof(c=b[_])?(l=c[0],v=c[1],l!=l?A[v]=e:"string"==typeof l?~(f="@"===l?e.lastIndexOf(l):e.indexOf(l))&&("number"==typeof c[2]?(A[v]=e.slice(0,f),e=e.slice(f+c[2])):(A[v]=e.slice(f),e=e.slice(0,f))):(f=l.exec(e))&&(A[v]=f[1],e=e.slice(0,f.index)),A[v]=A[v]||s&&c[3]&&t[v]||"",c[4]&&(A[v]=A[v].toLowerCase())):e=c(e,A);n&&(A.query=n(A.query)),s&&t.slashes&&"/"!==A.pathname.charAt(0)&&(""!==A.pathname||""!==t.pathname)&&(A.pathname=function(e,t){if(""===e)return t;for(var n=(t||"/").split("/").slice(0,-1).concat(e.split("/")),r=n.length,o=n[r-1],s=!1,i=0;r--;)"."===n[r]?n.splice(r,1):".."===n[r]?(n.splice(r,1),i++):i&&(0===r&&(s=!0),n.splice(r,1),i--);return s&&n.unshift(""),"."!==o&&".."!==o||n.push(""),n.join("/")}(A.pathname,t.pathname)),"/"!==A.pathname.charAt(0)&&m(A.protocol)&&(A.pathname="/"+A.pathname),r(A.port,A.protocol)||(A.host=A.hostname,A.port=""),A.username=A.password="",A.auth&&(~(f=A.auth.indexOf(":"))?(A.username=A.auth.slice(0,f),A.username=encodeURIComponent(decodeURIComponent(A.username)),A.password=A.auth.slice(f+1),A.password=encodeURIComponent(decodeURIComponent(A.password))):A.username=encodeURIComponent(decodeURIComponent(A.auth)),A.auth=A.password?A.username+":"+A.password:A.username),A.origin="file:"!==A.protocol&&m(A.protocol)&&A.host?A.protocol+"//"+A.host:"null",A.href=A.toString()}g.prototype={set:function(e,t,n){var s=this;switch(e){case"query":"string"==typeof t&&t.length&&(t=(n||o.parse)(t)),s[e]=t;break;case"port":s[e]=t,r(t,s.protocol)?t&&(s.host=s.hostname+":"+t):(s.host=s.hostname,s[e]="");break;case"hostname":s[e]=t,s.port&&(t+=":"+s.port),s.host=t;break;case"host":s[e]=t,l.test(t)?(t=t.split(":"),s.port=t.pop(),s.hostname=t.join(":")):(s.hostname=t,s.port="");break;case"protocol":s.protocol=t.toLowerCase(),s.slashes=!n;break;case"pathname":case"hash":if(t){var i="pathname"===e?"/":"#";s[e]=t.charAt(0)!==i?i+t:t}else s[e]=t;break;case"username":case"password":s[e]=encodeURIComponent(t);break;case"auth":var a=t.indexOf(":");~a?(s.username=t.slice(0,a),s.username=encodeURIComponent(decodeURIComponent(s.username)),s.password=t.slice(a+1),s.password=encodeURIComponent(decodeURIComponent(s.password))):s.username=encodeURIComponent(decodeURIComponent(t))}for(var c=0;c<p.length;c++){var u=p[c];u[4]&&(s[u[1]]=s[u[1]].toLowerCase())}return s.auth=s.password?s.username+":"+s.password:s.username,s.origin="file:"!==s.protocol&&m(s.protocol)&&s.host?s.protocol+"//"+s.host:"null",s.href=s.toString(),s},toString:function(e){e&&"function"==typeof e||(e=o.stringify);var t,n=this,r=n.host,s=n.protocol;s&&":"!==s.charAt(s.length-1)&&(s+=":");var i=s+(n.protocol&&n.slashes||m(n.protocol)?"//":"");return n.username?(i+=n.username,n.password&&(i+=":"+n.password),i+="@"):n.password?(i+=":"+n.password,i+="@"):"file:"!==n.protocol&&m(n.protocol)&&!r&&"/"!==n.pathname&&(i+="@"),(":"===r[r.length-1]||l.test(n.hostname)&&!n.port)&&(r+=":"),i+=r+n.pathname,(t="object"==typeof n.query?e(n.query):n.query)&&(i+="?"!==t.charAt(0)?"?"+t:t),n.hash&&(i+=n.hash),i}},g.extractProtocol=w,g.location=h,g.trimLeft=d,g.qs=o,e.exports=g},563:(e,t,n)=>{e.exports=function(e,t){let n,o,s,i=!0;function a(e){function o(){t&&t(e,n),t=null}i?r(o):o()}function l(e,t,r){n[e]=r,(0===--o||t)&&a(t)}Array.isArray(e)?(n=[],o=e.length):(s=Object.keys(e),n={},o=s.length),o?s?s.forEach((function(t){e[t]((function(e,n){l(t,e,n)}))})):e.forEach((function(e,t){e((function(e,n){l(t,e,n)}))})):a(null),i=!1};const r=n(11)},564:e=>{"use strict";e.exports=function(e,t){if(t=t.split(":")[0],!(e=+e))return!1;switch(t){case"http":case"ws":return 80!==e;case"https":case"wss":return 443!==e;case"ftp":return 21!==e;case"gopher":return 70!==e;case"file":return!1}return 0!==e}},614:function(e,t,n){var r,o;o="undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==n.g?n.g:this,e.exports=function(n){"use strict";var o,s=(n=n||{}).Base64,i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",a=function(e){for(var t={},n=0,r=e.length;n<r;n++)t[e.charAt(n)]=n;return t}(i),l=String.fromCharCode,c=function(e){if(e.length<2)return(t=e.charCodeAt(0))<128?e:t<2048?l(192|t>>>6)+l(128|63&t):l(224|t>>>12&15)+l(128|t>>>6&63)+l(128|63&t);var t=65536+1024*(e.charCodeAt(0)-55296)+(e.charCodeAt(1)-56320);return l(240|t>>>18&7)+l(128|t>>>12&63)+l(128|t>>>6&63)+l(128|63&t)},u=/[\uD800-\uDBFF][\uDC00-\uDFFFF]|[^\x00-\x7F]/g,d=function(e){return e.replace(u,c)},p=function(e){var t=[0,2,1][e.length%3],n=e.charCodeAt(0)<<16|(e.length>1?e.charCodeAt(1):0)<<8|(e.length>2?e.charCodeAt(2):0);return[i.charAt(n>>>18),i.charAt(n>>>12&63),t>=2?"=":i.charAt(n>>>6&63),t>=1?"=":i.charAt(63&n)].join("")},f=n.btoa&&"function"==typeof n.btoa?function(e){return n.btoa(e)}:function(e){if(e.match(/[^\x00-\xFF]/))throw new RangeError("The string contains invalid characters.");return e.replace(/[\s\S]{1,3}/g,p)},h=function(e){return f(d(String(e)))},m=function(e){return e.replace(/[+\/]/g,(function(e){return"+"==e?"-":"_"})).replace(/=/g,"")},w=function(e,t){return t?m(h(e)):h(e)};n.Uint8Array&&(o=function(e,t){for(var n="",r=0,o=e.length;r<o;r+=3){var s=e[r],a=e[r+1],l=e[r+2],c=s<<16|a<<8|l;n+=i.charAt(c>>>18)+i.charAt(c>>>12&63)+(void 0!==a?i.charAt(c>>>6&63):"=")+(void 0!==l?i.charAt(63&c):"=")}return t?m(n):n});var g,v=/[\xC0-\xDF][\x80-\xBF]|[\xE0-\xEF][\x80-\xBF]{2}|[\xF0-\xF7][\x80-\xBF]{3}/g,b=function(e){switch(e.length){case 4:var t=((7&e.charCodeAt(0))<<18|(63&e.charCodeAt(1))<<12|(63&e.charCodeAt(2))<<6|63&e.charCodeAt(3))-65536;return l((t>>>10)+55296)+l(56320+(1023&t));case 3:return l((15&e.charCodeAt(0))<<12|(63&e.charCodeAt(1))<<6|63&e.charCodeAt(2));default:return l((31&e.charCodeAt(0))<<6|63&e.charCodeAt(1))}},y=function(e){return e.replace(v,b)},A=function(e){var t=e.length,n=t%4,r=(t>0?a[e.charAt(0)]<<18:0)|(t>1?a[e.charAt(1)]<<12:0)|(t>2?a[e.charAt(2)]<<6:0)|(t>3?a[e.charAt(3)]:0),o=[l(r>>>16),l(r>>>8&255),l(255&r)];return o.length-=[0,0,2,1][n],o.join("")},_=n.atob&&"function"==typeof n.atob?function(e){return n.atob(e)}:function(e){return e.replace(/\S{1,4}/g,A)},C=function(e){return _(String(e).replace(/[^A-Za-z0-9\+\/]/g,""))},x=function(e){return function(e){return y(_(e))}(String(e).replace(/[-_]/g,(function(e){return"-"==e?"+":"/"})).replace(/[^A-Za-z0-9\+\/]/g,""))};n.Uint8Array&&(g=function(e){return Uint8Array.from(C(e),(function(e){return e.charCodeAt(0)}))});if(n.Base64={VERSION:"2.6.2",atob:C,btoa:f,fromBase64:x,toBase64:w,utob:d,encode:w,encodeURI:function(e){return w(e,!0)},btou:y,decode:x,noConflict:function(){var e=n.Base64;return n.Base64=s,e},fromUint8Array:o,toUint8Array:g},"function"==typeof Object.defineProperty){var S=function(e){return{value:e,enumerable:!1,writable:!0,configurable:!0}};n.Base64.extendString=function(){Object.defineProperty(String.prototype,"fromBase64",S((function(){return x(this)}))),Object.defineProperty(String.prototype,"toBase64",S((function(e){return w(this,e)}))),Object.defineProperty(String.prototype,"toBase64URI",S((function(){return w(this,!0)})))}}return n.Meteor&&(Base64=n.Base64),e.exports?e.exports.Base64=n.Base64:void 0===(r=function(){return n.Base64}.apply(t,[]))||(e.exports=r),{Base64:n.Base64}}(o)},628:(e,t,n)=>{e.exports=function(e,t){if("string"==typeof e){const t=e;if(!(e=window.document.querySelector(e)))throw new Error(`"${t}" does not match any HTML elements`)}if(!e)throw new Error(`"${e}" is not a valid HTML element`);"function"==typeof t&&(t={onDrop:t}),e.addEventListener("dragenter",i,!1),e.addEventListener("dragover",a,!1),e.addEventListener("dragleave",l,!1),e.addEventListener("drop",c,!1);let n=!1,r=0;return function(){u(),e.removeEventListener("dragenter",i,!1),e.removeEventListener("dragover",a,!1),e.removeEventListener("dragleave",l,!1),e.removeEventListener("drop",c,!1)};function s(e){if(e.dataTransfer.items||e.dataTransfer.types){const n=Array.from(e.dataTransfer.items),r=Array.from(e.dataTransfer.types);let o,s;if(n.length)o=n.filter((e=>"file"===e.kind)),s=n.filter((e=>"string"===e.kind));else{if(!r.length)return!1;o=r.filter((e=>"Files"===e)),s=r.filter((e=>e.startsWith("text/")))}return!(0===o.length&&!t.onDropText||0===s.length&&!t.onDrop||0===o.length&&0===s.length)}return!1}function i(o){if(o.stopPropagation(),o.preventDefault(),s(o))return n?(r+=1,!1):(n=!0,t.onDragEnter&&t.onDragEnter(o),e.classList.add("drag"),!1)}function a(e){if(e.stopPropagation(),e.preventDefault(),s(e))return t.onDragOver&&t.onDragOver(e),e.dataTransfer.dropEffect="copy",!1}function l(e){if(e.stopPropagation(),e.preventDefault(),s(e))return r>0?(r-=1,!1):(n=!1,t.onDragLeave&&t.onDragLeave(e),u(),!1)}function c(e){e.stopPropagation(),e.preventDefault(),t.onDragLeave&&t.onDragLeave(e),u(),n=!1,r=0;const s={x:e.clientX,y:e.clientY},i=e.dataTransfer.getData("text");return i&&t.onDropText&&t.onDropText(i,s),t.onDrop&&e.dataTransfer.items&&o(e.dataTransfer.items,((n,r,o)=>{if(n)return void console.error(n);if(0===r.length)return;const i=e.dataTransfer.files;t.onDrop(r,s,i,o)})),!1}function u(){e.classList.remove("drag")}},e.exports.processItems=o;const r=n(563);function o(e,t){0===(e=Array.from(e).filter((e=>"file"===e.kind))).length&&t(null,[],[]),r(e.map((e=>t=>{s(e.webkitGetAsEntry(),t)})),((e,n)=>{if(e)return void t(e);const r=n.flat(1/0),o=r.filter((e=>e.isFile)),s=r.filter((e=>e.isDirectory));t(null,o,s)}))}function s(e,t){let n=[];e.isFile?e.file((n=>{n.fullPath=e.fullPath,n.isFile=!0,n.isDirectory=!1,t(null,n)}),(e=>{t(e)})):e.isDirectory&&function o(i){i.readEntries((a=>{a.length>0?(n=n.concat(Array.from(a)),o(i)):r(n.map((e=>t=>{s(e,t)})),((n,r)=>{n?t(n):(r.push({fullPath:e.fullPath,name:e.name,isFile:!1,isDirectory:!0}),t(null,r))}))}))}(e.createReader())}},725:(e,t)=>{"use strict";var n=Object.prototype.hasOwnProperty;function r(e){try{return decodeURIComponent(e.replace(/\+/g," "))}catch(e){return null}}function o(e){try{return encodeURIComponent(e)}catch(e){return null}}t.stringify=function(e,t){t=t||"";var r,s,i=[];for(s in"string"!=typeof t&&(t="?"),e)if(n.call(e,s)){if((r=e[s])||null!=r&&!isNaN(r)||(r=""),s=o(s),r=o(r),null===s||null===r)continue;i.push(s+"="+r)}return i.length?t+i.join("&"):""},t.parse=function(e){for(var t,n=/([^=?#&]+)=?([^&]*)/g,o={};t=n.exec(e);){var s=r(t[1]),i=r(t[2]);null===s||null===i||s in o||(o[s]=i)}return o}},754:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>a});var r=n(594),o=n.n(r),s=n(621),i=n.n(s)()(o());i.push([e.id,"\ncode[data-v-11d25acc] {\r\n  font-family: 'Courier New', monospace;\r\n  font-weight: bold;\n}\r\n","",{version:3,sources:["webpack://./src/Upload/RoomCreation.vue"],names:[],mappings:";AAqIA;EACA,qCAAA;EACA,iBAAA;AACA",sourcesContent:['<template lang="pug">\r\n  modal(:has-header="true", @close="$emit(\'close\')")\r\n    div(slot="header")\r\n      h4 Create Private Room\r\n    div(slot="body")\r\n      .alert.alert-success(v-if="roomCreated")\r\n        icon.fa-fw(name="check-circle")\r\n        strong  Room Created Successfully!\r\n        p(style="margin: 10px 0 5px 0")\r\n          strong Room ID:\r\n          |\r\n          code(style="background: #fff; padding: 2px 8px; border-radius: 3px; font-size: 14px; user-select: all") {{ createdRoomId }}\r\n        p(style="margin: 5px 0")\r\n          strong Password:\r\n          |\r\n          code(style="background: #fff; padding: 2px 8px; border-radius: 3px; font-size: 14px") {{ roomPassword }}\r\n        p(style="margin-top: 10px; font-size: 13px; color: #666")\r\n          icon.fa-fw(name="info-circle")\r\n          |  Share this Room ID and password with your team members so they can join.\r\n        .text-right(style="margin-top: 15px")\r\n          button.btn.btn-primary(@click="$emit(\'close\')", type="button")\r\n            icon.fa-fw(name="check")\r\n            |  Done\r\n\r\n      .alert.alert-info(v-if="!roomCreated")\r\n        icon.fa-fw(name="info-circle")\r\n        |  Create a private room to share files with specific people. Share the room ID and password with your team.\r\n\r\n      .alert.alert-danger(v-if="error && !roomCreated")\r\n        icon.fa-fw(name="exclamation-triangle")\r\n        |  {{ error }}\r\n\r\n      form(@submit.prevent="createRoom", v-if="!roomCreated")\r\n        .form-group\r\n          label(for="roomName") Room Name\r\n          input#roomName.form-control(\r\n            type="text",\r\n            v-model="roomName",\r\n            placeholder="Enter room name",\r\n            required,\r\n            autofocus\r\n          )\r\n\r\n        .form-group\r\n          label(for="roomPassword") Room Password\r\n          input#roomPassword.form-control(\r\n            type="password",\r\n            v-model="roomPassword",\r\n            placeholder="Create a password",\r\n            required\r\n          )\r\n\r\n        .form-group\r\n          label(for="confirmPassword") Confirm Password\r\n          input#confirmPassword.form-control(\r\n            type="password",\r\n            v-model="confirmPassword",\r\n            placeholder="Confirm password",\r\n            required\r\n          )\r\n\r\n        .text-right\r\n          button.btn.btn-default(type="button", @click="$emit(\'close\')", style="margin-right: 10px") Cancel\r\n          button.btn.btn-primary(type="submit", :disabled="creating")\r\n            icon.fa-fw(name="spinner", spin, v-if="creating")\r\n            icon.fa-fw(name="plus", v-else)\r\n            |  Create Room\r\n</template>\r\n\r\n<script>\r\nimport Modal from \'../common/Modal.vue\';\r\nimport \'vue-awesome/icons/info-circle\';\r\nimport \'vue-awesome/icons/spinner\';\r\nimport \'vue-awesome/icons/plus\';\r\nimport \'vue-awesome/icons/exclamation-triangle\';\r\nimport \'vue-awesome/icons/check-circle\';\r\nimport \'vue-awesome/icons/check\';\r\n\r\nexport default {\r\n  name: \'RoomCreation\',\r\n  components: { Modal },\r\n\r\n  data() {\r\n    return {\r\n      roomName: \'\',\r\n      roomPassword: \'\',\r\n      confirmPassword: \'\',\r\n      error: \'\',\r\n      creating: false,\r\n      roomCreated: false,\r\n      createdRoomId: \'\'\r\n    };\r\n  },\r\n\r\n  methods: {\r\n    async createRoom() {\r\n      this.error = \'\';\r\n\r\n      if (!this.roomName.trim()) {\r\n        this.error = \'Please enter a room name\';\r\n        return;\r\n      }\r\n\r\n      if (this.roomPassword.length < 4) {\r\n        this.error = \'Password must be at least 4 characters\';\r\n        return;\r\n      }\r\n\r\n      if (this.roomPassword !== this.confirmPassword) {\r\n        this.error = \'Passwords do not match\';\r\n        return;\r\n      }\r\n\r\n      this.creating = true;\r\n\r\n      try {\r\n        const room = await this.$store.dispatch(\'rooms/createRoom\', {\r\n          name: this.roomName,\r\n          password: this.roomPassword\r\n        });\r\n        this.roomCreated = true;\r\n        this.createdRoomId = room.id;\r\n      } catch (e) {\r\n        this.error = e.message;\r\n      } finally {\r\n        this.creating = false;\r\n      }\r\n    }\r\n  }\r\n};\r\n<\/script>\r\n\r\n<style scoped>\r\ncode {\r\n  font-family: \'Courier New\', monospace;\r\n  font-weight: bold;\r\n}\r\n</style>\r\n'],sourceRoot:""}]);const a=i},775:(e,t,n)=>{var r=n(754);"string"==typeof r&&(r=[[e.id,r,""]]),r.locals&&(e.exports=r.locals),(0,n(83).A)("1b0f5532",r,!0,{})},866:(e,t,n)=>{var r=n(881);"string"==typeof r&&(r=[[e.id,r,""]]),r.locals&&(e.exports=r.locals),(0,n(83).A)("6a172d82",r,!0,{})},881:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>a});var r=n(594),o=n.n(r),s=n(621),i=n.n(s)()(o());i.push([e.id,"\n@media all and (max-width: 500px) {\n.well {\n    padding: 19px 8px;\n}\n.upload-success-btns {\n    width: 100%;\n    margin-bottom: 10px;\n}\n.upload-success-btns .btn {\n    padding: 7px 5px;\n    font-size: 12px;\n}\n}\n.room-toggle {\n  margin-bottom: 20px;\n}\n.room-code {\n  background: #fff;\n  padding: 3px 8px;\n  border-radius: 3px;\n  font-size: 14px;\n  font-family: 'Courier New', monospace;\n  font-weight: bold;\n  user-select: all;\n  border: 1px solid #ddd;\n}\n.room-messages {\n  padding: 15px;\n}\n.message-item {\n  margin-bottom: 15px;\n  padding: 10px;\n  background: #fff;\n  border-radius: 8px;\n  border: 1px solid #ddd;\n  box-shadow: 0 1px 2px rgba(0,0,0,0.05);\n}\n.message-item.own {\n  background: #e3f2fd;\n  border-color: #90caf9;\n}\n.message-header {\n  margin-bottom: 8px;\n  padding-bottom: 5px;\n  border-bottom: 1px solid #eee;\n}\n.file-share-box {\n  display: flex;\n  align-items: center;\n  gap: 15px;\n}\n.file-icon {\n  color: #5bc0de;\n}\n.file-info {\n  flex: 1;\n}\n.file-name {\n  margin: 0 0 5px 0;\n  font-size: 14px;\n}\n.file-message {\n  margin: 0;\n  color: #666;\n  font-size: 13px;\n  font-style: italic;\n}\n.file-actions {\n  display: flex;\n  flex-direction: column;\n  gap: 5px;\n}\n.file-actions .btn {\n  white-space: nowrap;\n}\n.room-upload-section {\n  margin-top: 20px;\n}\n.selected-files {\n  margin-top: 10px;\n  padding: 10px;\n  background: #f0f0f0;\n  border-radius: 4px;\n}\n.selected-files ul {\n  margin: 5px 0 0 0;\n  padding-left: 20px;\n}\n.download-limit {\n  margin: 5px 0 0 0;\n}\n.download-limit .text-danger {\n  font-weight: bold;\n  margin-left: 5px;\n}\n.btn.disabled {\n  opacity: 0.5;\n  cursor: not-allowed;\n  pointer-events: none;\n}\n.share-link {\n  margin-top: 15px;\n  padding: 10px;\n  background-color: #f5f5f5;\n  border-radius: 4px;\n  word-break: break-all;\n}\n.share-link .title {\n  font-weight: bold;\n  color: #333;\n}\n.share-link a {\n  color: #337ab7;\n  text-decoration: none;\n}\n.share-link a:hover {\n  text-decoration: underline;\n}\n","",{version:3,sources:["webpack://./src/Upload.vue"],names:[],mappings:";AAotBA;AACA;IACA,iBAAA;AACA;AACA;IACA,WAAA;IACA,mBAAA;AACA;AAEA;IACA,gBAAA;IACA,eAAA;AACA;AACA;AAEA;EACA,mBAAA;AACA;AAEA;EACA,gBAAA;EACA,gBAAA;EACA,kBAAA;EACA,eAAA;EACA,qCAAA;EACA,iBAAA;EACA,gBAAA;EACA,sBAAA;AACA;AAEA;EACA,aAAA;AACA;AAEA;EACA,mBAAA;EACA,aAAA;EACA,gBAAA;EACA,kBAAA;EACA,sBAAA;EACA,sCAAA;AACA;AAEA;EACA,mBAAA;EACA,qBAAA;AACA;AAEA;EACA,kBAAA;EACA,mBAAA;EACA,6BAAA;AACA;AAEA;EACA,aAAA;EACA,mBAAA;EACA,SAAA;AACA;AAEA;EACA,cAAA;AACA;AAEA;EACA,OAAA;AACA;AAEA;EACA,iBAAA;EACA,eAAA;AACA;AAEA;EACA,SAAA;EACA,WAAA;EACA,eAAA;EACA,kBAAA;AACA;AAEA;EACA,aAAA;EACA,sBAAA;EACA,QAAA;AACA;AAEA;EACA,mBAAA;AACA;AAEA;EACA,gBAAA;AACA;AAEA;EACA,gBAAA;EACA,aAAA;EACA,mBAAA;EACA,kBAAA;AACA;AAEA;EACA,iBAAA;EACA,kBAAA;AACA;AAEA;EACA,iBAAA;AACA;AAEA;EACA,iBAAA;EACA,gBAAA;AACA;AAEA;EACA,YAAA;EACA,mBAAA;EACA,oBAAA;AACA;AAEA;EACA,gBAAA;EACA,aAAA;EACA,yBAAA;EACA,kBAAA;EACA,qBAAA;AACA;AAEA;EACA,iBAAA;EACA,WAAA;AACA;AAEA;EACA,cAAA;EACA,qBAAA;AACA;AAEA;EACA,0BAAA;AACA",sourcesContent:["<template lang=\"pug\">\r\n  .upload-app#uploadApp\r\n    //- Room Navigation Toggle\r\n    .room-toggle(v-if=\"!showLogin\")\r\n      .btn-group.btn-group-sm\r\n        button.btn.btn-default(:class=\"{active: viewMode === 'upload'}\", @click=\"viewMode = 'upload'\")\r\n          icon(name=\"cloud-upload-alt\")\r\n          |  Upload Files\r\n        button.btn.btn-info(:class=\"{active: viewMode === 'room'}\", @click=\"viewMode = 'room'\")\r\n          icon(name=\"comments\")\r\n          |  Team Room\r\n\r\n    //- UPLOAD VIEW (Original functionality - unchanged)\r\n    div(v-if=\"viewMode === 'upload'\")\r\n      a.btn.btn-sm.btn-info.btn-new-session(\r\n        v-if='!showLogin',\r\n        @click='newSession()',\r\n        @keydown.enter.prevent='newSession()',\r\n        @keydown.space.prevent='newSession()',\r\n        :title='$root.lang.newUpload',\r\n        tabindex=\"-1\",\r\n        role=\"button\"\r\n      )\r\n        icon.fa-fw(name=\"cloud-upload-alt\")\r\n        span.hidden-xs  {{ $root.lang.newUpload }}\r\n      .alert.alert-danger(v-show=\"error\")\r\n        strong\r\n          icon.fa-fw(name=\"exclamation-triangle\")\r\n          |  {{ error }}\r\n      form.well.upload-uploadPassword(v-if='showLogin', @submit.prevent='setUploadPass()')\r\n        h3 {{ $root.lang.uploadPassword }}\r\n        .form-group\r\n          input.form-control(type='password', v-model='uploadPassword', autofocus)\r\n        p.text-danger(v-show='uploadPasswordWrong')\r\n          strong {{ $root.lang.accessDenied }}\r\n        |\r\n        button.uploadPass.btn.btn-primary(:disabled='uploadPassword.length<1', type=\"submit\")\r\n          icon.fa-fw(name=\"key\")\r\n          |  {{ $root.lang.login }}\r\n      div(v-else-if=\"$root.configFetched\")\r\n        .well(v-show=\"state === 'uploaded'\")\r\n          .pull-right.btn-group.upload-success-btns\r\n            a.btn.btn-primary(\r\n              v-if=\"!disableQrCode\",\r\n              @click.prevent=\"showQrCode\",\r\n              @keydown.enter.prevent=\"showQrCode\",\r\n              @keydown.space.prevent=\"showQrCode\",\r\n              href=\"#\",\r\n              :title=\"$root.lang.showQrCode\",\r\n              tabindex=\"0\",\r\n              role=\"button\"\r\n            )\r\n              icon.fa-fw(name=\"qrcode\")\r\n              | QR-Code\r\n            a.btn.btn-primary(\r\n              :href=\"mailLnk\",\r\n              :title=\"$root.lang.sendViaMail\",\r\n              tabindex=\"0\"\r\n            )\r\n              icon.fa-fw(name=\"envelope\")\r\n              |  {{ $root.lang.email }}\r\n            clipboard.btn.btn-primary(\r\n              :value='shareUrl',\r\n              :title=\"$root.lang.copyToClipboard\",\r\n              tabindex=\"0\"\r\n            )\r\n          h3.text-success\r\n            icon.fa-fw(name=\"check\")\r\n            |  {{ $root.lang.uploadCompleted }}\r\n          div.share-link\r\n            span.title {{ $root.lang.downloadLink }}:\r\n            |\r\n            a(:href='shareUrl') {{ shareUrl }}\r\n        .row.overall-process(v-show=\"state === 'uploading'\")\r\n          .col-xs-12\r\n            icon.pull-left(name=\"spinner\", scale=\"2\", spin=\"\", style=\"margin-right: 10px\")\r\n            .progress\r\n              .progress-bar.progress-bar-success.progress-bar-striped.active(:style=\"{width: percentUploaded+'%'}\")\r\n                span(v-show='percentUploaded>8') {{ percentUploaded }}%\r\n                span(v-show='percentUploaded>15' style=\"margin-left: 10px\") ({{ humanFileSize(bytesUploaded) }} / {{ humanFileSize(bucketSize) }})\r\n        .row\r\n          .col-sm-7\r\n            files\r\n          .col-sm-5\r\n            settings\r\n            .text-right(v-show='showUploadBtn')\r\n              button#uploadBtn.btn.btn-lg.btn-success(@click=\"$store.dispatch('upload/upload')\")\r\n                icon.fa-fw(name=\"upload\")\r\n                |  {{ $root.lang.upload }}\r\n            .text-right(v-show=\"state === 'uploadError'\")\r\n              button#uploadRetryBtn.btn.btn-lg.btn-success(@click=\"$store.dispatch('upload/upload')\")\r\n                icon.fa-fw(name=\"upload\")\r\n                |  {{ $root.lang.retry }}\r\n\r\n    //- ROOM VIEW (Separate chat-based room interface)\r\n    div(v-if=\"viewMode === 'room'\")\r\n      //- Not in a room - show join/create options\r\n      .room-lobby(v-if=\"!$store.getters['rooms/isInRoom']\")\r\n        .well.text-center\r\n          h3\r\n            icon(name=\"comments\")\r\n            |  Team Room\r\n          p Share file links with your team in a private room\r\n          .row\r\n            .col-sm-6\r\n              .panel.panel-primary\r\n                .panel-heading\r\n                  strong Create New Room\r\n                .panel-body\r\n                  button.btn.btn-primary.btn-block(@click=\"showRoomCreation = true\")\r\n                    icon(name=\"plus\")\r\n                    |  Create Room\r\n            .col-sm-6\r\n              .panel.panel-info\r\n                .panel-heading\r\n                  strong Join Existing Room\r\n                .panel-body\r\n                  button.btn.btn-info.btn-block(@click=\"showRoomJoin = true\")\r\n                    icon(name=\"sign-in-alt\")\r\n                    |  Join Room\r\n\r\n      //- In a room - show chat interface\r\n      .room-chat(v-if=\"$store.getters['rooms/isInRoom']\")\r\n        .panel.panel-info\r\n          .panel-heading\r\n            .pull-right\r\n              button.btn.btn-xs.btn-warning(@click=\"leaveRoom\")\r\n                icon(name=\"sign-out-alt\")\r\n                |  Leave Room\r\n            h4(style=\"margin: 5px 0\")\r\n              icon(name=\"users\")\r\n              |  {{ $store.state.rooms.currentRoom.name }}\r\n          .panel-body\r\n            .room-info\r\n              .row\r\n                .col-sm-6\r\n                  p(style=\"margin: 5px 0\")\r\n                    strong Room ID:\r\n                    |\r\n                    code.room-code {{ $store.state.rooms.currentRoom.id }}\r\n                    button.btn.btn-xs.btn-default(@click=\"copyRoomId\", style=\"margin-left: 5px\")\r\n                      icon(name=\"copy\")\r\n                .col-sm-6\r\n                  p(style=\"margin: 5px 0\")\r\n                    strong Password:\r\n                    |\r\n                    code.room-code {{ $store.state.rooms.currentRoom.password }}\r\n\r\n        //- Chat Messages Area\r\n        .room-messages-container\r\n          .panel.panel-default\r\n            .panel-heading\r\n              strong\r\n                icon(name=\"comments\")\r\n                |  Shared Files\r\n            .panel-body.room-messages(ref=\"messageArea\", style=\"height: 400px; overflow-y: auto; background: #f9f9f9\")\r\n              .alert.alert-info.text-center(v-if=\"roomMessages.length === 0\")\r\n                icon(name=\"info-circle\")\r\n                |  No files shared yet. Upload a file below to share with your team.\r\n              .message-item(v-for=\"msg in roomMessages\", :key=\"msg.id\", :class=\"{own: msg.isOwn}\")\r\n                .message-header\r\n                  strong {{ msg.userName }}\r\n                  small.text-muted  {{ formatDate(msg.timestamp) }}\r\n                .message-content\r\n                  .file-share-box\r\n                    icon.file-icon(name=\"file\", scale=\"1.5\")\r\n                    .file-info\r\n                      p.file-name\r\n                        strong {{ msg.fileName }}\r\n                        span.text-muted(v-if=\"msg.fileSize\")  ({{ msg.fileSize }})\r\n                      p.file-message(v-if=\"msg.message\") {{ msg.message }}\r\n                      p.download-limit(v-if=\"msg.downloadLimit\")\r\n                        small.text-muted\r\n                          icon(name=\"download\")\r\n                          |  Downloads: {{ msg.downloadCount || 0 }} / {{ msg.downloadLimit }}\r\n                          span.text-danger(v-if=\"msg.downloadCount >= msg.downloadLimit\")  (Link Expired)\r\n                    .file-actions\r\n                      a.btn.btn-sm.btn-success(\r\n                        :href=\"msg.fileLink\",\r\n                        target=\"_blank\",\r\n                        :disabled=\"msg.downloadCount >= msg.downloadLimit\",\r\n                        :class=\"{'disabled': msg.downloadCount >= msg.downloadLimit}\"\r\n                      )\r\n                        icon(name=\"download\")\r\n                        |  {{ msg.downloadCount >= msg.downloadLimit ? 'Expired' : 'Download' }}\r\n                      clipboard.btn.btn-sm.btn-default(:value=\"msg.fileLink\", title=\"Copy link\", v-if=\"msg.downloadCount < msg.downloadLimit\")\r\n                        icon(name=\"copy\")\r\n\r\n        //- Upload Section for Room\r\n        .room-upload-section\r\n          .panel.panel-success\r\n            .panel-heading\r\n              strong\r\n                icon(name=\"upload\")\r\n                |  Share a File with Team\r\n            .panel-body\r\n              .alert.alert-info(style=\"margin-bottom: 15px\")\r\n                icon(name=\"info-circle\")\r\n                |  Upload a file below. Once uploaded, the link will be automatically shared in the room.\r\n\r\n              //- Mini upload interface\r\n              .row\r\n                .col-sm-8\r\n                  .form-group\r\n                    label Select File to Share\r\n                    input.form-control(type=\"file\", @change=\"handleRoomFileSelect\", ref=\"roomFileInput\", multiple)\r\n                  .form-group(v-if=\"roomUploadFiles.length > 0\")\r\n                    label Add a message (optional)\r\n                    input.form-control(v-model=\"roomUploadMessage\", placeholder=\"Enter a message about this file...\", maxlength=\"200\")\r\n                  .form-group(v-if=\"roomUploadFiles.length > 0\")\r\n                    label Download Limit\r\n                    .input-group\r\n                      input.form-control(\r\n                        type=\"number\",\r\n                        v-model.number=\"roomDownloadLimit\",\r\n                        min=\"1\",\r\n                        max=\"100\",\r\n                        placeholder=\"Max downloads\"\r\n                      )\r\n                      span.input-group-addon\r\n                        icon(name=\"download\")\r\n                    small.text-muted Link will be destroyed after this many downloads\r\n                .col-sm-4\r\n                  label &nbsp;\r\n                  button.btn.btn-success.btn-block(\r\n                    @click=\"uploadToRoom\",\r\n                    :disabled=\"roomUploadFiles.length === 0 || roomUploading\",\r\n                    style=\"margin-top: 25px\"\r\n                  )\r\n                    icon(name=\"spinner\", spin, v-if=\"roomUploading\")\r\n                    icon(name=\"upload\", v-else)\r\n                    |  {{ roomUploading ? 'Uploading...' : 'Upload & Share' }}\r\n\r\n              .selected-files(v-if=\"roomUploadFiles.length > 0\")\r\n                p\r\n                  strong Selected Files:\r\n                ul\r\n                  li(v-for=\"(file, idx) in roomUploadFiles\", :key=\"idx\") {{ file.name }} ({{ humanFileSize(file.size) }})\r\n\r\n    //- Room Modals\r\n    RoomCreation(v-if=\"showRoomCreation\", @close=\"showRoomCreation = false\", @created=\"onRoomCreated\")\r\n    RoomJoin(v-if=\"showRoomJoin\", @close=\"showRoomJoin = false\")\r\n</template>\r\n\r\n<script type=\"text/babel\">\r\n  import { Encoder, Byte } from \"@nuintun/qrcode\";\r\n  import { mapState, mapGetters } from 'vuex';\r\n  import * as tus from \"tus-js-client\";\r\n\r\n  import Clipboard from './common/Clipboard.vue';\r\n  import Settings from './Upload/Settings.vue';\r\n  import Files from './Upload/Files.vue';\r\n  import RoomCreation from './Upload/RoomCreation.vue';\r\n  import RoomJoin from './Upload/RoomJoin.vue';\r\n\r\n  import 'vue-awesome/icons/cloud-upload-alt';\r\n  import 'vue-awesome/icons/upload';\r\n  import 'vue-awesome/icons/check';\r\n  import 'vue-awesome/icons/spinner';\r\n  import 'vue-awesome/icons/envelope';\r\n  import 'vue-awesome/icons/qrcode';\r\n  import 'vue-awesome/icons/exclamation-triangle';\r\n  import 'vue-awesome/icons/key';\r\n  import 'vue-awesome/icons/users';\r\n  import 'vue-awesome/icons/plus';\r\n  import 'vue-awesome/icons/sign-in-alt';\r\n  import 'vue-awesome/icons/sign-out-alt';\r\n  import 'vue-awesome/icons/copy';\r\n  import 'vue-awesome/icons/link';\r\n  import 'vue-awesome/icons/share-alt';\r\n  import 'vue-awesome/icons/comments';\r\n  import 'vue-awesome/icons/file';\r\n  import 'vue-awesome/icons/download';\r\n  import 'vue-awesome/icons/info-circle';\r\n\r\n  import { humanFileSize } from \"./Upload/store/upload\";\r\n\r\n  export default {\r\n    name: 'Upload',\r\n    components: {\r\n      Settings,\r\n      Files,\r\n      Clipboard,\r\n      RoomCreation,\r\n      RoomJoin\r\n    },\r\n\r\n    data() {\r\n      return {\r\n        uploadPassword: '',\r\n        uploadPasswordWrong: null,\r\n        showRoomCreation: false,\r\n        showRoomJoin: false,\r\n        viewMode: 'upload', // 'upload' or 'room'\r\n        roomUploadFiles: [],\r\n        roomUploadMessage: '',\r\n        roomUploading: false,\r\n        roomDownloadLimit: 10, // Default download limit\r\n        downloadStatsInterval: null\r\n      }\r\n    },\r\n\r\n    computed: {\r\n      ...mapState(['state']),\r\n      ...mapState('config', ['uploadPassRequired', 'uploadPass', 'requireBucketPassword', 'disableQrCode']),\r\n      ...mapState('upload', ['sid', 'files', 'password']),\r\n      ...mapGetters(['error', 'disabled']),\r\n      ...mapGetters('upload', ['percentUploaded', 'shareUrl', 'bucketSize', 'bytesUploaded']),\r\n      mailLnk: function() {\r\n        return this.$store.state.config\r\n          && this.$store.state.config.mailTemplate\r\n          && this.$store.state.config.mailTemplate.replace('%%URL%%', this.shareUrl);\r\n      },\r\n      showLogin() {\r\n        return this.uploadPassRequired && this.uploadPasswordWrong !== false;\r\n      },\r\n      showUploadBtn() {\r\n        return this.files.length\r\n          && !this.disabled\r\n          && (this.requireBucketPassword && this.password || !this.requireBucketPassword)\r\n      },\r\n      roomMessages() {\r\n        return this.$store.state.rooms.currentRoom\r\n          ? this.$store.state.rooms.currentRoom.messages || []\r\n          : [];\r\n      }\r\n    },\r\n\r\n    watch: {\r\n      state: function(val) {\r\n        if (val === 'uploaded' || val === 'uploadError') {\r\n          const el = document.getElementById('uploadApp');\r\n          if (!el || !el.scrollIntoView) return;\r\n          el.scrollIntoView(true);\r\n        }\r\n      },\r\n      roomMessages: {\r\n        handler() {\r\n          this.$nextTick(() => {\r\n            this.scrollMessagesToBottom();\r\n          });\r\n        },\r\n        deep: true\r\n      }\r\n    },\r\n\r\n    async mounted() {\r\n      // Initialize rooms from localStorage\r\n      await this.$store.dispatch('rooms/initializeFromStorage');\r\n\r\n      // Start refreshing download counts when in room\r\n      this.startDownloadStatsRefresh();\r\n    },\r\n\r\n    beforeDestroy() {\r\n      // Clean up interval\r\n      if (this.downloadStatsInterval) {\r\n        clearInterval(this.downloadStatsInterval);\r\n      }\r\n    },\r\n\r\n    methods: {\r\n      newSession() {\r\n        if (!confirm(this.$root.lang.createNewUploadSession)) return;\r\n        document.location.reload();\r\n      },\r\n      async setUploadPass() {\r\n        try {\r\n          this.$store.commit('config/SET', {uploadPass: this.uploadPassword});\r\n          await this.$store.dispatch('config/fetch');\r\n          this.uploadPasswordWrong = false;\r\n        } catch(e) {\r\n          if(e.code === 'PWDREQ') {\r\n            this.uploadPassword = '';\r\n            this.uploadPasswordWrong = true;\r\n          } else {\r\n            console.error(e);\r\n          }\r\n        }\r\n      },\r\n      showQrCode() {\r\n        const qrcode = new Encoder({level: 'H'}).encode(new Byte(this.shareUrl));\r\n        const imgSrc = qrcode.toDataURL(7, 10);\r\n        const data = imgSrc.substr(imgSrc.indexOf(',') + 1);\r\n        const byteCharacters = atob(data);\r\n        const byteNumbers = new Array(byteCharacters.length);\r\n        for (let i = 0; i < byteCharacters.length; i++) {\r\n          byteNumbers[i] = byteCharacters.charCodeAt(i);\r\n        }\r\n        const byteArray = new Uint8Array(byteNumbers);\r\n        const file = new Blob([byteArray], { type: 'image/gif;base64' });\r\n        window.open(URL.createObjectURL(file));\r\n      },\r\n      humanFileSize,\r\n      leaveRoom() {\r\n        if (confirm('Are you sure you want to leave this room?')) {\r\n          this.$store.dispatch('rooms/leaveRoom');\r\n        }\r\n      },\r\n      copyRoomId() {\r\n        const roomId = this.$store.state.rooms.currentRoom.id;\r\n        if (navigator.clipboard && navigator.clipboard.writeText) {\r\n          navigator.clipboard.writeText(roomId).then(() => {\r\n            alert('Room ID copied to clipboard!');\r\n          }).catch(() => {\r\n            this.fallbackCopyRoomId(roomId);\r\n          });\r\n        } else {\r\n          this.fallbackCopyRoomId(roomId);\r\n        }\r\n      },\r\n      fallbackCopyRoomId(text) {\r\n        const textArea = document.createElement('textarea');\r\n        textArea.value = text;\r\n        textArea.style.position = 'fixed';\r\n        textArea.style.left = '-999999px';\r\n        document.body.appendChild(textArea);\r\n        textArea.select();\r\n        try {\r\n          document.execCommand('copy');\r\n          alert('Room ID copied to clipboard!');\r\n        } catch (err) {\r\n          alert('Failed to copy. Room ID: ' + text);\r\n        }\r\n        document.body.removeChild(textArea);\r\n      },\r\n      handleRoomFileSelect(event) {\r\n        this.roomUploadFiles = Array.from(event.target.files);\r\n      },\r\n      async uploadToRoom() {\r\n        if (this.roomUploadFiles.length === 0) return;\r\n\r\n        this.roomUploading = true;\r\n\r\n        try {\r\n          // Create a new upload session for these files\r\n          const uploadResult = await this.uploadFilesAndGetLink(this.roomUploadFiles);\r\n\r\n          // Add message to room with the file link\r\n          await this.$store.dispatch('rooms/addMessage', {\r\n            fileName: this.roomUploadFiles.map(f => f.name).join(', '),\r\n            fileSize: humanFileSize(this.roomUploadFiles.reduce((sum, f) => sum + f.size, 0)),\r\n            fileLink: uploadResult.shareUrl,\r\n            message: this.roomUploadMessage,\r\n            userName: 'You',\r\n            isOwn: true,\r\n            downloadLimit: this.roomDownloadLimit,\r\n            downloadCount: 0\r\n          });\r\n\r\n          // Clear form\r\n          this.roomUploadFiles = [];\r\n          this.roomUploadMessage = '';\r\n          this.roomDownloadLimit = 10; // Reset to default\r\n          this.$refs.roomFileInput.value = '';\r\n\r\n          alert('File uploaded and shared with team!');\r\n        } catch (error) {\r\n          console.error('Upload failed:', error);\r\n          alert('Failed to upload file: ' + error.message);\r\n        } finally {\r\n          this.roomUploading = false;\r\n        }\r\n      },\r\n      async uploadFilesAndGetLink(files) {\r\n        // This creates a separate upload session and returns the share link\r\n        return new Promise((resolve, reject) => {\r\n          // Generate a new sid for this upload\r\n          const sid = Math.random().toString(36).substr(2, 9);\r\n          const baseUrl = document.head.getElementsByTagName('base')[0].href;\r\n          const shareUrl = baseUrl + sid;\r\n\r\n          // Use the TUS upload mechanism\r\n          const uploadURI = (window.PSITRANSFER_UPLOAD_PATH || '/') + 'files';\r\n          let uploadedCount = 0;\r\n          const totalFiles = files.length;\r\n\r\n          files.forEach(file => {\r\n            const upload = new tus.Upload(file, {\r\n              endpoint: uploadURI,\r\n              metadata: {\r\n                sid: sid,\r\n                retention: this.$store.state.config.defaultRetention || '2592000',\r\n                password: '',\r\n                name: file.name,\r\n                comment: '',\r\n                type: file.type,\r\n                downloadLimit: this.roomDownloadLimit.toString(),\r\n                downloadCount: '0'\r\n              },\r\n              headers: {\r\n                \"x-passwd\": this.$store.state.config.uploadPass || ''\r\n              },\r\n              chunkSize: 5000000,\r\n              onSuccess: () => {\r\n                uploadedCount++;\r\n                if (uploadedCount === totalFiles) {\r\n                  // Lock the bucket\r\n                  fetch(uploadURI + '/' + sid + '?lock=yes', { method: 'PATCH' });\r\n                  resolve({ shareUrl, sid });\r\n                }\r\n              },\r\n              onError: (error) => {\r\n                reject(error);\r\n              }\r\n            });\r\n            upload.start();\r\n          });\r\n        });\r\n      },\r\n      formatDate(timestamp) {\r\n        const date = new Date(timestamp);\r\n        const now = new Date();\r\n        const diff = now - date;\r\n\r\n        if (diff < 60000) return 'Just now';\r\n        if (diff < 3600000) return Math.floor(diff / 60000) + ' min ago';\r\n        if (diff < 86400000) return Math.floor(diff / 3600000) + ' hours ago';\r\n\r\n        return date.toLocaleString();\r\n      },\r\n      scrollMessagesToBottom() {\r\n        const el = this.$refs.messageArea;\r\n        if (el) {\r\n          el.scrollTop = el.scrollHeight;\r\n        }\r\n      },\r\n      onRoomCreated() {\r\n        this.viewMode = 'room';\r\n      },\r\n      async refreshDownloadStats() {\r\n        // Only refresh if in a room and have messages\r\n        if (!this.$store.getters['rooms/isInRoom'] || this.roomMessages.length === 0) {\r\n          return;\r\n        }\r\n\r\n        const baseUrl = document.head.getElementsByTagName('base')[0].href;\r\n\r\n        for (const msg of this.roomMessages) {\r\n          if (!msg.fileLink || !msg.downloadLimit) continue;\r\n\r\n          try {\r\n            // Extract fid from the file link\r\n            const urlParts = msg.fileLink.split('/files/');\r\n            if (urlParts.length < 2) continue;\r\n\r\n            const fid = urlParts[1];\r\n\r\n            // Fetch current download stats from server\r\n            const response = await fetch(`${baseUrl}file-stats/${fid}`);\r\n            if (response.ok) {\r\n              const stats = await response.json();\r\n\r\n              // Update the message with current stats\r\n              msg.downloadCount = stats.downloadCount;\r\n\r\n              // Update in store to persist\r\n              await this.$store.dispatch('rooms/updateMessageStats', {\r\n                messageId: msg.id,\r\n                downloadCount: stats.downloadCount\r\n              });\r\n            }\r\n          } catch (e) {\r\n            console.error('Failed to fetch download stats:', e);\r\n          }\r\n        }\r\n      },\r\n      startDownloadStatsRefresh() {\r\n        // Refresh every 5 seconds when viewing room\r\n        this.downloadStatsInterval = setInterval(() => {\r\n          if (this.viewMode === 'room' && this.$store.getters['rooms/isInRoom']) {\r\n            this.refreshDownloadStats();\r\n          }\r\n        }, 5000);\r\n      }\r\n    }\r\n  }\r\n<\/script>\r\n\r\n<style>\r\n  @media all and (max-width: 500px) {\r\n    .well {\r\n      padding: 19px 8px;\r\n    }\r\n    .upload-success-btns {\r\n      width: 100%;\r\n      margin-bottom: 10px;\r\n    }\r\n\r\n    .upload-success-btns .btn {\r\n      padding: 7px 5px;\r\n      font-size: 12px;\r\n    }\r\n  }\r\n\r\n  .room-toggle {\r\n    margin-bottom: 20px;\r\n  }\r\n\r\n  .room-code {\r\n    background: #fff;\r\n    padding: 3px 8px;\r\n    border-radius: 3px;\r\n    font-size: 14px;\r\n    font-family: 'Courier New', monospace;\r\n    font-weight: bold;\r\n    user-select: all;\r\n    border: 1px solid #ddd;\r\n  }\r\n\r\n  .room-messages {\r\n    padding: 15px;\r\n  }\r\n\r\n  .message-item {\r\n    margin-bottom: 15px;\r\n    padding: 10px;\r\n    background: #fff;\r\n    border-radius: 8px;\r\n    border: 1px solid #ddd;\r\n    box-shadow: 0 1px 2px rgba(0,0,0,0.05);\r\n  }\r\n\r\n  .message-item.own {\r\n    background: #e3f2fd;\r\n    border-color: #90caf9;\r\n  }\r\n\r\n  .message-header {\r\n    margin-bottom: 8px;\r\n    padding-bottom: 5px;\r\n    border-bottom: 1px solid #eee;\r\n  }\r\n\r\n  .file-share-box {\r\n    display: flex;\r\n    align-items: center;\r\n    gap: 15px;\r\n  }\r\n\r\n  .file-icon {\r\n    color: #5bc0de;\r\n  }\r\n\r\n  .file-info {\r\n    flex: 1;\r\n  }\r\n\r\n  .file-name {\r\n    margin: 0 0 5px 0;\r\n    font-size: 14px;\r\n  }\r\n\r\n  .file-message {\r\n    margin: 0;\r\n    color: #666;\r\n    font-size: 13px;\r\n    font-style: italic;\r\n  }\r\n\r\n  .file-actions {\r\n    display: flex;\r\n    flex-direction: column;\r\n    gap: 5px;\r\n  }\r\n\r\n  .file-actions .btn {\r\n    white-space: nowrap;\r\n  }\r\n\r\n  .room-upload-section {\r\n    margin-top: 20px;\r\n  }\r\n\r\n  .selected-files {\r\n    margin-top: 10px;\r\n    padding: 10px;\r\n    background: #f0f0f0;\r\n    border-radius: 4px;\r\n  }\r\n\r\n  .selected-files ul {\r\n    margin: 5px 0 0 0;\r\n    padding-left: 20px;\r\n  }\r\n\r\n  .download-limit {\r\n    margin: 5px 0 0 0;\r\n  }\r\n\r\n  .download-limit .text-danger {\r\n    font-weight: bold;\r\n    margin-left: 5px;\r\n  }\r\n\r\n  .btn.disabled {\r\n    opacity: 0.5;\r\n    cursor: not-allowed;\r\n    pointer-events: none;\r\n  }\r\n\r\n  .share-link {\r\n    margin-top: 15px;\r\n    padding: 10px;\r\n    background-color: #f5f5f5;\r\n    border-radius: 4px;\r\n    word-break: break-all;\r\n  }\r\n\r\n  .share-link .title {\r\n    font-weight: bold;\r\n    color: #333;\r\n  }\r\n\r\n  .share-link a {\r\n    color: #337ab7;\r\n    text-decoration: none;\r\n  }\r\n\r\n  .share-link a:hover {\r\n    text-decoration: underline;\r\n  }\r\n</style>\r\n"],sourceRoot:""}]);const a=i},891:(e,t,n)=>{"use strict";var r=n(257),o=n.n(r);const s=new Map;class i{#e;#t;static TERMINATOR=new i([0,0,0],0);static NUMERIC=new i([10,12,14],1);static ALPHANUMERIC=new i([9,11,13],2);static STRUCTURED_APPEND=new i([0,0,0],3);static BYTE=new i([8,16,16],4);static ECI=new i([0,0,0],7);static KANJI=new i([8,10,12],8);static FNC1_FIRST_POSITION=new i([0,0,0],5);static FNC1_SECOND_POSITION=new i([0,0,0],9);static HANZI=new i([8,10,12],13);constructor(e,t){this.#e=t,this.#t=new Int32Array(e),s.set(t,this)}get bits(){return this.#e}getCharacterCountBits({version:e}){let t;return t=e<=9?0:e<=26?1:2,this.#t[t]}}function a(e){return 1&e}function l(e){return 0|e}function c(e){return 31&e}function u(e){return 32-Math.clz32(e)}function d(e,t){const n=u(t);for(e<<=n-1;u(e)>=n;)e^=t<<u(e)-n;return e}function p(e,t,n){return 1===e.get(t,n)}function f(e,t){let n=0;const{size:r}=e;for(let o=0;o<r;o++){let s=-1,i=0;for(let a=0;a<r;a++){const r=t?e.get(o,a):e.get(a,o);r===s?i++:(i>=5&&(n+=i-5+3),s=r,i=1)}i>=5&&(n+=i-5+3)}return n}function h(e,t,n,r,o){if(n<0||r>e.size)return!1;for(let s=n;s<r;s++)if(o?p(e,t,s):p(e,s,t))return!1;return!0}function m(e){return function(e){return f(e)+f(e,!0)}(e)+function(e){let t=0;const n=e.size-1;for(let r=0;r<n;r++)for(let o=0;o<n;o++){const n=e.get(o,r);n===e.get(o+1,r)&&n===e.get(o,r+1)&&n===e.get(o+1,r+1)&&(t+=3)}return t}(e)+function(e){let t=0;const{size:n}=e;for(let r=0;r<n;r++)for(let o=0;o<n;o++)o+6<n&&p(e,o,r)&&!p(e,o+1,r)&&p(e,o+2,r)&&p(e,o+3,r)&&p(e,o+4,r)&&!p(e,o+5,r)&&p(e,o+6,r)&&(h(e,r,o-4,o)||h(e,r,o+7,o+11))&&t++,r+6<n&&p(e,o,r)&&!p(e,o,r+1)&&p(e,o,r+2)&&p(e,o,r+3)&&p(e,o,r+4)&&!p(e,o,r+5)&&p(e,o,r+6)&&(h(e,o,r-4,r,!0)||h(e,o,r+7,r+11,!0))&&t++;return 40*t}(e)+function(e){let t=0;const{size:n}=e;for(let r=0;r<n;r++)for(let o=0;o<n;o++)p(e,o,r)&&t++;const r=n*n;return 10*l(10*Math.abs(2*t-r)/r)}(e)}function w(e,t,n){let r,o;switch(e){case 0:o=n+t&1;break;case 1:o=1&n;break;case 2:o=t%3;break;case 3:o=(n+t)%3;break;case 4:o=l(n/2)+l(t/3)&1;break;case 5:r=n*t,o=(1&r)+r%3;break;case 6:r=n*t,o=(1&r)+r%3&1;break;case 7:o=n*t%3+(n+t&1)&1;break;default:throw new Error(`illegal mask: ${e}`)}return 0===o}function g(e){return l(e/32)}function v(e){return new Int32Array(Math.ceil(e/32))}class b{#n;#e;constructor(e=0){this.#n=e,this.#e=v(e)}#r(e){const t=this.#e;if(e>32*t.length){const n=v(Math.ceil(e/.75));n.set(t),this.#e=n}this.#n=e}get length(){return this.#n}get byteLength(){return Math.ceil(this.#n/8)}set(e){this.#e[g(e)]|=1<<c(e)}get(e){return a(this.#e[g(e)]>>>c(e))}xor(e){const t=this.#e,n=e.#e,r=Math.min(this.#n,e.#n);for(let e=0;e<r;e++)t[e]^=n[e]}append(e,t=1){let n=this.#n;if(e instanceof b){t=e.#n,this.#r(n+t);for(let r=0;r<t;r++)0!==e.get(r)&&this.set(n),n++}else{this.#r(n+t);for(let r=t-1;r>=0;r--)0!==a(e>>>r)&&this.set(n),n++}}writeToUint8Array(e,t,n,r){for(let o=0;o<r;o++){let r=0;for(let t=0;t<8;t++)0!==this.get(e++)&&(r|=1<<7-t);t[n+o]=r}}clear(){this.#e.fill(0)}}class y{#o;#s;constructor(e){this.#o=e,this.#s=new Int8Array(e*e)}get size(){return this.#o}set(e,t,n){this.#s[t*this.#o+e]=n}get(e,t){return this.#s[t*this.#o+e]}clear(e){this.#s.fill(e)}}class A{#i;#a;constructor(e,t){this.#i=e,this.#a=t}get count(){return this.#i}get numDataCodewords(){return this.#a}}class _{#l;#c;#u;#d;#p;constructor(e,...t){let n=0,r=0;for(const{count:e,numDataCodewords:o}of t)n+=e,r+=o*e;const o=e*n;this.#l=t,this.#u=o,this.#d=r,this.#p=e,this.#c=r+o}get ecBlocks(){return this.#l}get numTotalCodewords(){return this.#c}get numTotalECCodewords(){return this.#u}get numTotalDataCodewords(){return this.#d}get numECCodewordsPerBlock(){return this.#p}}class C{#o;#f;#l;#h;constructor(e,t,...n){this.#f=e,this.#l=n,this.#o=17+4*e,this.#h=t}get size(){return this.#o}get version(){return this.#f}get alignmentPatterns(){return this.#h}getECBlocks({level:e}){return this.#l[e]}}const x=[new C(1,[],new _(7,new A(1,19)),new _(10,new A(1,16)),new _(13,new A(1,13)),new _(17,new A(1,9))),new C(2,[6,18],new _(10,new A(1,34)),new _(16,new A(1,28)),new _(22,new A(1,22)),new _(28,new A(1,16))),new C(3,[6,22],new _(15,new A(1,55)),new _(26,new A(1,44)),new _(18,new A(2,17)),new _(22,new A(2,13))),new C(4,[6,26],new _(20,new A(1,80)),new _(18,new A(2,32)),new _(26,new A(2,24)),new _(16,new A(4,9))),new C(5,[6,30],new _(26,new A(1,108)),new _(24,new A(2,43)),new _(18,new A(2,15),new A(2,16)),new _(22,new A(2,11),new A(2,12))),new C(6,[6,34],new _(18,new A(2,68)),new _(16,new A(4,27)),new _(24,new A(4,19)),new _(28,new A(4,15))),new C(7,[6,22,38],new _(20,new A(2,78)),new _(18,new A(4,31)),new _(18,new A(2,14),new A(4,15)),new _(26,new A(4,13),new A(1,14))),new C(8,[6,24,42],new _(24,new A(2,97)),new _(22,new A(2,38),new A(2,39)),new _(22,new A(4,18),new A(2,19)),new _(26,new A(4,14),new A(2,15))),new C(9,[6,26,46],new _(30,new A(2,116)),new _(22,new A(3,36),new A(2,37)),new _(20,new A(4,16),new A(4,17)),new _(24,new A(4,12),new A(4,13))),new C(10,[6,28,50],new _(18,new A(2,68),new A(2,69)),new _(26,new A(4,43),new A(1,44)),new _(24,new A(6,19),new A(2,20)),new _(28,new A(6,15),new A(2,16))),new C(11,[6,30,54],new _(20,new A(4,81)),new _(30,new A(1,50),new A(4,51)),new _(28,new A(4,22),new A(4,23)),new _(24,new A(3,12),new A(8,13))),new C(12,[6,32,58],new _(24,new A(2,92),new A(2,93)),new _(22,new A(6,36),new A(2,37)),new _(26,new A(4,20),new A(6,21)),new _(28,new A(7,14),new A(4,15))),new C(13,[6,34,62],new _(26,new A(4,107)),new _(22,new A(8,37),new A(1,38)),new _(24,new A(8,20),new A(4,21)),new _(22,new A(12,11),new A(4,12))),new C(14,[6,26,46,66],new _(30,new A(3,115),new A(1,116)),new _(24,new A(4,40),new A(5,41)),new _(20,new A(11,16),new A(5,17)),new _(24,new A(11,12),new A(5,13))),new C(15,[6,26,48,70],new _(22,new A(5,87),new A(1,88)),new _(24,new A(5,41),new A(5,42)),new _(30,new A(5,24),new A(7,25)),new _(24,new A(11,12),new A(7,13))),new C(16,[6,26,50,74],new _(24,new A(5,98),new A(1,99)),new _(28,new A(7,45),new A(3,46)),new _(24,new A(15,19),new A(2,20)),new _(30,new A(3,15),new A(13,16))),new C(17,[6,30,54,78],new _(28,new A(1,107),new A(5,108)),new _(28,new A(10,46),new A(1,47)),new _(28,new A(1,22),new A(15,23)),new _(28,new A(2,14),new A(17,15))),new C(18,[6,30,56,82],new _(30,new A(5,120),new A(1,121)),new _(26,new A(9,43),new A(4,44)),new _(28,new A(17,22),new A(1,23)),new _(28,new A(2,14),new A(19,15))),new C(19,[6,30,58,86],new _(28,new A(3,113),new A(4,114)),new _(26,new A(3,44),new A(11,45)),new _(26,new A(17,21),new A(4,22)),new _(26,new A(9,13),new A(16,14))),new C(20,[6,34,62,90],new _(28,new A(3,107),new A(5,108)),new _(26,new A(3,41),new A(13,42)),new _(30,new A(15,24),new A(5,25)),new _(28,new A(15,15),new A(10,16))),new C(21,[6,28,50,72,94],new _(28,new A(4,116),new A(4,117)),new _(26,new A(17,42)),new _(28,new A(17,22),new A(6,23)),new _(30,new A(19,16),new A(6,17))),new C(22,[6,26,50,74,98],new _(28,new A(2,111),new A(7,112)),new _(28,new A(17,46)),new _(30,new A(7,24),new A(16,25)),new _(24,new A(34,13))),new C(23,[6,30,54,78,102],new _(30,new A(4,121),new A(5,122)),new _(28,new A(4,47),new A(14,48)),new _(30,new A(11,24),new A(14,25)),new _(30,new A(16,15),new A(14,16))),new C(24,[6,28,54,80,106],new _(30,new A(6,117),new A(4,118)),new _(28,new A(6,45),new A(14,46)),new _(30,new A(11,24),new A(16,25)),new _(30,new A(30,16),new A(2,17))),new C(25,[6,32,58,84,110],new _(26,new A(8,106),new A(4,107)),new _(28,new A(8,47),new A(13,48)),new _(30,new A(7,24),new A(22,25)),new _(30,new A(22,15),new A(13,16))),new C(26,[6,30,58,86,114],new _(28,new A(10,114),new A(2,115)),new _(28,new A(19,46),new A(4,47)),new _(28,new A(28,22),new A(6,23)),new _(30,new A(33,16),new A(4,17))),new C(27,[6,34,62,90,118],new _(30,new A(8,122),new A(4,123)),new _(28,new A(22,45),new A(3,46)),new _(30,new A(8,23),new A(26,24)),new _(30,new A(12,15),new A(28,16))),new C(28,[6,26,50,74,98,122],new _(30,new A(3,117),new A(10,118)),new _(28,new A(3,45),new A(23,46)),new _(30,new A(4,24),new A(31,25)),new _(30,new A(11,15),new A(31,16))),new C(29,[6,30,54,78,102,126],new _(30,new A(7,116),new A(7,117)),new _(28,new A(21,45),new A(7,46)),new _(30,new A(1,23),new A(37,24)),new _(30,new A(19,15),new A(26,16))),new C(30,[6,26,52,78,104,130],new _(30,new A(5,115),new A(10,116)),new _(28,new A(19,47),new A(10,48)),new _(30,new A(15,24),new A(25,25)),new _(30,new A(23,15),new A(25,16))),new C(31,[6,30,56,82,108,134],new _(30,new A(13,115),new A(3,116)),new _(28,new A(2,46),new A(29,47)),new _(30,new A(42,24),new A(1,25)),new _(30,new A(23,15),new A(28,16))),new C(32,[6,34,60,86,112,138],new _(30,new A(17,115)),new _(28,new A(10,46),new A(23,47)),new _(30,new A(10,24),new A(35,25)),new _(30,new A(19,15),new A(35,16))),new C(33,[6,30,58,86,114,142],new _(30,new A(17,115),new A(1,116)),new _(28,new A(14,46),new A(21,47)),new _(30,new A(29,24),new A(19,25)),new _(30,new A(11,15),new A(46,16))),new C(34,[6,34,62,90,118,146],new _(30,new A(13,115),new A(6,116)),new _(28,new A(14,46),new A(23,47)),new _(30,new A(44,24),new A(7,25)),new _(30,new A(59,16),new A(1,17))),new C(35,[6,30,54,78,102,126,150],new _(30,new A(12,121),new A(7,122)),new _(28,new A(12,47),new A(26,48)),new _(30,new A(39,24),new A(14,25)),new _(30,new A(22,15),new A(41,16))),new C(36,[6,24,50,76,102,128,154],new _(30,new A(6,121),new A(14,122)),new _(28,new A(6,47),new A(34,48)),new _(30,new A(46,24),new A(10,25)),new _(30,new A(2,15),new A(64,16))),new C(37,[6,28,54,80,106,132,158],new _(30,new A(17,122),new A(4,123)),new _(28,new A(29,46),new A(14,47)),new _(30,new A(49,24),new A(10,25)),new _(30,new A(24,15),new A(46,16))),new C(38,[6,32,58,84,110,136,162],new _(30,new A(4,122),new A(18,123)),new _(28,new A(13,46),new A(32,47)),new _(30,new A(48,24),new A(14,25)),new _(30,new A(42,15),new A(32,16))),new C(39,[6,26,54,82,110,138,166],new _(30,new A(20,117),new A(4,118)),new _(28,new A(40,47),new A(7,48)),new _(30,new A(43,24),new A(22,25)),new _(30,new A(10,15),new A(67,16))),new C(40,[6,30,58,86,114,142,170],new _(30,new A(19,118),new A(6,119)),new _(28,new A(18,47),new A(31,48)),new _(30,new A(34,24),new A(34,25)),new _(30,new A(20,15),new A(61,16)))],S=[[1,1,1,1,1,1,1],[1,0,0,0,0,0,1],[1,0,1,1,1,0,1],[1,0,1,1,1,0,1],[1,0,1,1,1,0,1],[1,0,0,0,0,0,1],[1,1,1,1,1,1,1]],R=[[1,1,1,1,1],[1,0,0,0,1],[1,0,1,0,1],[1,0,0,0,1],[1,1,1,1,1]],k=[[8,0],[8,1],[8,2],[8,3],[8,4],[8,5],[8,7],[8,8],[7,8],[5,8],[4,8],[3,8],[2,8],[1,8],[0,8]];function E(e,t,n){return-1===e.get(t,n)}function U(e,t,n){for(let r=0;r<7;r++){const o=S[r];for(let s=0;s<7;s++)e.set(t+s,n+r,o[s])}}function P(e,t,n){for(let r=0;r<8;r++)e.set(t+r,n,0)}function O(e,t,n){for(let r=0;r<7;r++)e.set(t,n+r,0)}function I(e,t,n){for(let r=0;r<5;r++){const o=R[r];for(let s=0;s<5;s++)e.set(t+s,n+r,o[s])}}function D(e,t,n,r,o){(function(e,t,n){const r=new b;!function(e,t,n){const r=t.bits<<3|n;e.append(r,5);const o=d(r,1335);e.append(o,10);const s=new b;s.append(21522,15),e.xor(s)}(r,t,n);const{size:o}=e,{length:s}=r;for(let t=0;t<s;t++){const[n,i]=k[t],a=r.get(s-1-t);e.set(n,i,a),t<8?e.set(o-t-1,8,a):e.set(8,o-7+(t-8),a)}!function(e){e.set(8,e.size-8,1)}(e)})(e,r,o),function(e,{version:t}){if(t>=7){const n=new b;!function(e,t){e.append(t,6);const n=d(t,7973);e.append(n,12)}(n,t);let r=17;const{size:o}=e;for(let t=0;t<6;t++)for(let s=0;s<3;s++){const i=n.get(r--);e.set(t,o-11+s,i),e.set(o-11+s,t,i)}}}(e,n),function(e,t,n){let r=0;const{size:o}=e,{length:s}=t;for(let i=o-1;i>=1;i-=2){6===i&&(i=5);for(let a=0;a<o;a++)for(let l=0;l<2;l++){const c=i-l,u=i+1&2?a:o-1-a;if(E(e,c,u)){let o=0;r<s&&(o=t.get(r++)),w(n,c,u)&&(o^=1),e.set(c,u,o)}}}}(e,t,o)}function z(e,t,n,r){const o=new y(t.size);return o.clear(-1),function(e,t){!function(e){const{size:t}=e;U(e,0,0),U(e,t-7,0),U(e,0,t-7),P(e,0,7),P(e,t-8,7),P(e,0,t-8),O(e,7,0),O(e,t-7-1,0),O(e,7,t-7)}(e),function(e,{version:t}){if(t>=2){const{alignmentPatterns:n}=x[t-1],{length:r}=n;for(let t=0;t<r;t++){const o=n[t];for(let t=0;t<r;t++){const r=n[t];E(e,r,o)&&I(e,r-2,o-2)}}}}(e,t),function(e){const t=e.size-8;for(let n=8;n<t;n++){const t=n+1&1;E(e,n,6)&&e.set(n,6,t)}for(let n=8;n<t;n++){const t=n+1&1;E(e,6,n)&&e.set(6,n,t)}}(e)}(o,t),D(o,e,t,n,r),o}class M{#m;#w;constructor(e,t){this.#m=t,this.#w=e}get ecCodewords(){return this.#m}get dataCodewords(){return this.#w}}class T{#g;#v;constructor(e,t){const{length:n}=t;if(n<=0)throw new Error("polynomial coefficients cannot empty");if(this.#g=e,n>1&&0===t[0]){let e=1;for(;e<n&&0===t[e];)e++;if(e===n)this.#v=new Int32Array([0]);else{const r=new Int32Array(n-e);r.set(t.subarray(e)),this.#v=r}}else this.#v=t}get coefficients(){return this.#v}isZero(){return 0===this.#v[0]}getDegree(){return this.#v.length-1}getCoefficient(e){const t=this.#v;return t[t.length-1-e]}evaluate(e){if(0===e)return this.getCoefficient(0);let t;const n=this.#v;if(1===e){t=0;for(const e of n)t^=e;return t}[t]=n;const r=this.#g,{length:o}=n;for(let s=1;s<o;s++)t=r.multiply(e,t)^n[s];return t}multiply(e){const t=this.#g,n=this.#v,{length:r}=n;if(e instanceof T){if(this.isZero()||e.isZero())return t.zero;const o=e.#v,s=o.length,i=new Int32Array(r+s-1);for(let e=0;e<r;e++){const r=n[e];for(let n=0;n<s;n++)i[e+n]^=t.multiply(r,o[n])}return new T(t,i)}if(0===e)return t.zero;if(1===e)return this;const o=new Int32Array(r);for(let s=0;s<r;s++)o[s]=t.multiply(n[s],e);return new T(t,o)}multiplyByMonomial(e,t){const n=this.#g;if(0===t)return n.zero;const r=this.#v,{length:o}=r,s=new Int32Array(o+e);for(let e=0;e<o;e++)s[e]=n.multiply(r[e],t);return new T(n,s)}addOrSubtract(e){if(this.isZero())return e;if(e.isZero())return this;let t=e.#v,n=t.length,r=this.#v,o=r.length;n<o&&([n,o]=[o,n],[t,r]=[r,t]);const s=n-o,i=new Int32Array(n);i.set(t.subarray(0,s));for(let e=s;e<n;e++)i[e]=r[e-s]^t[e];return new T(this.#g,i)}divide(e){const t=this.#g;let n=t.zero,r=this;const o=e.getCoefficient(e.getDegree()),s=t.invert(o);for(;r.getDegree()>=e.getDegree()&&!r.isZero();){const o=r.getDegree(),i=o-e.getDegree(),a=t.multiply(r.getCoefficient(o),s),l=e.multiplyByMonomial(i,a),c=t.buildPolynomial(i,a);n=n.addOrSubtract(c),r=r.addOrSubtract(l)}return[n,r]}}const B=new class{#o;#b;#y;#A;#_;#C;constructor(e,t,n){let r=1;const o=new Int32Array(t);for(let n=0;n<t;n++)o[n]=r,r*=2,r>=t&&(r^=e,r&=t-1);const s=new Int32Array(t);for(let e=0,n=t-1;e<n;e++)s[o[e]]=e;this.#o=t,this.#_=o,this.#C=s,this.#A=n,this.#b=new T(this,new Int32Array([1])),this.#y=new T(this,new Int32Array([0]))}get size(){return this.#o}get one(){return this.#b}get zero(){return this.#y}get generator(){return this.#A}exp(e){return this.#_[e]}log(e){return this.#C[e]}invert(e){return this.#_[this.#o-this.#C[e]-1]}multiply(e,t){if(0===e||0===t)return 0;const n=this.#C;return this.#_[(n[e]+n[t])%(this.#o-1)]}buildPolynomial(e,t){if(0===t)return this.#y;const n=new Int32Array(e+1);return n[0]=t,new T(this,n)}}(285,256,0);class F{#g;#x;constructor(e=B){this.#g=e,this.#x=[new T(e,new Int32Array([1]))]}encode(e,t){const n=e.length-t,r=new Int32Array(n),o=function(e,t,n){const{length:r}=t;if(n>=r){const{generator:o}=e;let s=t[r-1];for(let i=r;i<=n;i++){const n=new Int32Array([1,e.exp(i-1+o)]),r=s.multiply(new T(e,n));t.push(r),s=r}}return t[n]}(this.#g,this.#x,t);r.set(e.subarray(0,n));const s=new T(this.#g,r).multiplyByMonomial(t,1),[,i]=s.divide(o),{coefficients:a}=i,l=n+(t-a.length);e.fill(0,n,l),e.set(a,l)}}function L(e,t){const n=e.length,r=new Int32Array(n+t);return r.set(e),(new F).encode(r,t),new Uint8Array(r.subarray(n))}function $(e){return e.mode===i.BYTE}function N(e){return e.mode===i.HANZI}function j(e,t){e.append(t.bits,4)}function q(e,t,n){if($(t)){const[r]=t.charset.values;if(r!==n)return e.append(i.ECI.bits,4),r<=127?e.append(r,8):r<=16383?e.append(32768|r,16):e.append(12582912|r,24),r}return n}function H(e,t){const[n,r]=t;switch(n){case"GS1":j(e,i.FNC1_FIRST_POSITION);break;case"AIM":j(e,i.FNC1_SECOND_POSITION),e.append(r,8)}}function G(e,t){return $(e)?t.byteLength:e.content.length}function J(e,t,n,r){e.append(r,t.getCharacterCountBits(n))}function W(e,t,n){const r=t.getECBlocks(n),o=Math.ceil(e/8);return r.numTotalDataCodewords>=o}function Q(e,t){for(const n of x)if(W(e,n,t))return n;throw new Error("data too big for all versions")}function V(e,t){let n=0;for(const{mode:r,head:o,body:s}of e)n+=o.length+r.getCharacterCountBits(t)+s.length;return n}class Z{#S;#R;#e;#k;#o;#E;#U;constructor(e){const t=1<<e,n=t+1;this.#S=t,this.#R=n,this.#k=e,this.reset()}get bof(){return this.#S}get eof(){return this.#R}get bits(){return this.#e}get depth(){return this.#k}reset(){const e=this.#k+1;this.#e=e,this.#o=1<<e,this.#U=new Map,this.#E=this.#R+1}add(e,t){let n=this.#E;if(n>4095)return!1;this.#U.set(e<<8|t,n++);let r=this.#e,o=this.#o;return n>o&&(o=1<<++r),this.#e=r,this.#o=o,this.#E=n,!0}get(e,t){return this.#U.get(e<<8|t)}}class K{#e=0;#P;#O=0;#s=[];constructor(e){this.#P=e}write(e){let t=this.#e,n=this.#O|e<<t;t+=this.#P.bits;const r=this.#s;for(;t>=8;)r.push(255&n),n>>=8,t-=8;this.#e=t,this.#O=n}pipe(e){const t=this.#s;this.#e>0&&t.push(this.#O),e.writeByte(this.#P.depth);const{length:n}=t;for(let r=0;r<n;){const o=n-r;o>=255?(e.writeByte(255),e.writeBytes(t,r,255),r+=255):(e.writeByte(o),e.writeBytes(t,r,o),r=n)}e.writeByte(0)}}class Y{#s=[];get bytes(){return this.#s}writeByte(e){this.#s.push(255&e)}writeInt16(e){this.#s.push(255&e,e>>8&255)}writeBytes(e,t=0,n=e.length){const r=this.#s;for(let o=0;o<n;o++)r.push(255&e[t+o])}}const{fromCharCode:X}=String;function ee(e){if((e&=63)>=0){if(e<26)return 65+e;if(e<52)return e-26+97;if(e<62)return e-52+48;if(62===e)return 43;if(63===e)return 47}throw new Error(`illegal char: ${X(e)}`)}class te{#e=0;#O=0;#n=0;#I=new Y;get bytes(){return this.#I.bytes}write(e){let t=this.#e+8;const n=this.#I,r=this.#O<<8|255&e;for(;t>=6;)n.writeByte(ee(r>>>t-6)),t-=6;this.#n++,this.#e=t,this.#O=r}close(){const e=this.#e,t=this.#I;e>0&&(t.writeByte(ee(this.#O<<6-e)),this.#e=0,this.#O=0);const n=this.#n;if(n%3!=0){const e=3-n%3;for(let n=0;n<e;n++)t.writeByte(61)}}}class ne{#D;#z;#M;#T;#B=[];constructor(e,t,{foreground:n=[0,0,0],background:r=[255,255,255]}={}){this.#D=e,this.#z=t,this.#M=n,this.#T=r}#F(){const e=this.#D,t=this.#z,n=new Y,r=this.#T,o=this.#M;return n.writeBytes([71,73,70,56,57,97]),n.writeInt16(e),n.writeInt16(t),n.writeBytes([128,0,0]),n.writeBytes([r[0],r[1],r[2]]),n.writeBytes([o[0],o[1],o[2]]),n.writeByte(44),n.writeInt16(0),n.writeInt16(0),n.writeInt16(e),n.writeInt16(t),n.writeByte(0),function(e,t,n){const r=new Z(2),o=new K(r);if(o.write(r.bof),e.length>0){let t=e[0];const{length:n}=e;for(let s=1;s<n;s++){const n=e[s],i=r.get(t,n);null!=i?t=i:(o.write(t),r.add(t,n)||(o.write(r.bof),r.reset()),t=n)}o.write(t)}o.write(r.eof),o.pipe(n)}(this.#B,0,n),n.writeByte(59),n.bytes}set(e,t,n){this.#B[t*this.#D+e]=n}toDataURL(){const e=this.#F(),t=new te;for(const n of e)t.write(n);t.close();const n=t.bytes;let r="data:image/gif;base64,";for(const e of n)r+=X(e);return r}}class re{#L;#$;#f;#N;constructor(e,t,n,r){this.#L=r,this.#$=n,this.#N=e,this.#f=t}get size(){return this.#N.size}get mask(){return this.#L}get level(){return this.#$.name}get version(){return this.#f.version}get(e,t){const{size:n}=this.#N;if(e<0||t<0||e>=n||t>=n)throw new Error(`illegal coordinate: [${e}, ${t}]`);return this.#N.get(e,t)}toDataURL(e=2,{margin:t=4*e,...n}={}){e=Math.max(1,0|e),t=Math.max(0,0|t);const r=this.#N,o=e*r.size+2*t,s=new ne(o,o,n),i=o-t;for(let n=0;n<o;n++)for(let a=0;a<o;a++)if(a>=t&&a<i&&n>=t&&n<i){const o=l((a-t)/e),i=l((n-t)/e);s.set(a,n,r.get(o,i))}else s.set(a,n,0);return s.toDataURL()}}const oe=new Map;class se{#j;#q;static CP437=new se("cp437",2,0);static ISO_8859_1=new se("iso-8859-1",3,1);static ISO_8859_2=new se("iso-8859-2",4);static ISO_8859_3=new se("iso-8859-3",5);static ISO_8859_4=new se("iso-8859-4",6);static ISO_8859_5=new se("iso-8859-5",7);static ISO_8859_6=new se("iso-8859-6",8);static ISO_8859_7=new se("iso-8859-7",9);static ISO_8859_8=new se("iso-8859-8",10);static ISO_8859_9=new se("iso-8859-9",11);static ISO_8859_10=new se("iso-8859-10",12);static ISO_8859_11=new se("iso-8859-11",13);static ISO_8859_13=new se("iso-8859-13",15);static ISO_8859_14=new se("iso-8859-14",16);static ISO_8859_15=new se("iso-8859-15",17);static ISO_8859_16=new se("iso-8859-16",18);static SHIFT_JIS=new se("shift-jis",20);static CP1250=new se("cp1250",21);static CP1251=new se("cp1251",22);static CP1252=new se("cp1252",23);static CP1256=new se("cp1256",24);static UTF_16BE=new se("utf-16be",25);static UTF_8=new se("utf-8",26);static ASCII=new se("ascii",27);static BIG5=new se("big5",28);static GB2312=new se("gb2312",29);static EUC_KR=new se("euc-kr",30);static GBK=new se("gbk",31);static GB18030=new se("gb18030",32);static UTF_16LE=new se("utf-16le",33);static UTF_32BE=new se("utf-32be",34);static UTF_32LE=new se("utf-32le",35);static ISO_646_INV=new se("iso-646-inv",170);static BINARY=new se("binary",899);constructor(e,...t){this.#j=e,this.#q=Object.freeze(t);for(const e of t){if(!(e>=0&&e<=999999&&Number.isInteger(e)))throw new Error("illegal extended channel interpretation value");oe.set(e,this)}}get label(){return this.#j}get values(){return this.#q}}const ie=new Map;class ae{#H;#e;#$;static L=new ae("L",0,1);static M=new ae("M",1,0);static Q=new ae("Q",2,3);static H=new ae("H",3,2);constructor(e,t,n){this.#e=n,this.#H=e,this.#$=t,ie.set(n,this)}get bits(){return this.#e}get name(){return this.#H}get level(){return this.#$}}function le(e,t){const n=[];for(const r of e){const e=r.codePointAt(0);n.push(null==e||e>t?63:e)}return new Uint8Array(n)}function ce(e,t){switch(t){case se.ASCII:return le(e,127);case se.ISO_8859_1:return le(e,255);case se.UTF_8:return(new TextEncoder).encode(e);default:throw Error(`built-in encode not support charset: ${t.label}`)}}class ue{#G;#$;#F;#f;constructor({hints:e={},level:t="L",version:n="Auto",encode:r=ce}={}){!function(e){const{fnc1:t}=e;if(null!=t){const[e]=t;if("GS1"!==e&&"AIM"!==e)throw new Error("illegal fn1 hint");if("AIM"===e){const[,e]=t;if(e<0||e>255||!Number.isInteger(e))throw new Error("illegal fn1 application indicator")}}}(e),function(e){if(["L","M","Q","H"].indexOf(e)<0)throw new Error("illegal error correction level")}(t),function(e){if("Auto"!==e&&(e<1||e>40||!Number.isInteger(e)))throw new Error("illegal version")}(n),this.#G=e,this.#F=r,this.#f=n,this.#$=ae[t]}encode(...e){const t=this.#$,n=this.#F,{fnc1:r}=this.#G,o=this.#f,s=[];let i,a=!1,[l]=se.ISO_8859_1.values;for(const t of e){const{mode:e}=t,o=new b,i=t.encode(n),c=G(t,i);l=q(o,t,l),null==r||a||(a=!0,H(o,r)),j(o,e),N(t)&&o.append(1,4),s.push({mode:e,head:o,body:i,length:c})}if("Auto"===o)i=function(e,t){const n=Q(V(e,x[0]),t);return Q(V(e,n),t)}(s,t);else if(i=x[o-1],!W(V(s,i),i,t))throw new Error("data too big for requested version");const c=new b;for(const{mode:e,head:t,body:n,length:r}of s)c.append(t),J(c,e,i,r),c.append(n);const u=i.getECBlocks(t);!function(e,t){const n=8*t;for(let t=0;t<4&&e.length<n;t++)e.append(0);const r=7&e.length;if(r>0)for(let t=r;t<8;t++)e.append(0);const o=t-e.byteLength;for(let t=0;t<o;t++)e.append(1&t?17:236,8)}(c,u.numTotalDataCodewords);const d=function(e,{ecBlocks:t,numECCodewordsPerBlock:n}){let r=0,o=0,s=0;const i=[];for(const{count:a,numDataCodewords:l}of t)for(let t=0;t<a;t++){const t=new Uint8Array(l);e.writeToUint8Array(8*s,t,0,l);const a=L(t,n);i.push(new M(t,a)),s+=l,r=Math.max(r,a.length),o=Math.max(o,l)}const a=new b;for(let e=0;e<o;e++)for(const{dataCodewords:t}of i)e<t.length&&a.append(t[e],8);for(let e=0;e<r;e++)for(const{ecCodewords:t}of i)e<t.length&&a.append(t[e],8);return a}(c,u),[p,f]=function(e,t,n){let r=0,o=z(e,t,n,r),s=m(o);for(let i=1;i<8;i++){const a=z(e,t,n,i),l=m(a);l<s&&(r=i,o=a,s=l)}return[r,o]}(d,i,t);return new re(f,i,t,p)}}class de{#J;#W;constructor(e,t=se.ISO_8859_1){!function(e){if(""===e)throw new Error("segment content should be at least 1 character")}(e),function(e){if(!(e instanceof se))throw new Error("illegal charset")}(t),this.#J=e,this.#W=t}get mode(){return i.BYTE}get content(){return this.#J}get charset(){return this.#W}encode(e){const t=new b,n=e(this.#J,this.#W);for(const e of n)t.append(e,8);return t}}var pe=("undefined"!=typeof window?window:void 0!==n.g?n.g:{}).__VUE_DEVTOOLS_GLOBAL_HOOK__;function fe(e,t){if(void 0===t&&(t=[]),null===e||"object"!=typeof e)return e;var n,r=(n=function(t){return t.original===e},t.filter(n)[0]);if(r)return r.copy;var o=Array.isArray(e)?[]:{};return t.push({original:e,copy:o}),Object.keys(e).forEach((function(n){o[n]=fe(e[n],t)})),o}function he(e,t){Object.keys(e).forEach((function(n){return t(e[n],n)}))}function me(e){return null!==e&&"object"==typeof e}var we=function(e,t){this.runtime=t,this._children=Object.create(null),this._rawModule=e;var n=e.state;this.state=("function"==typeof n?n():n)||{}},ge={namespaced:{configurable:!0}};ge.namespaced.get=function(){return!!this._rawModule.namespaced},we.prototype.addChild=function(e,t){this._children[e]=t},we.prototype.removeChild=function(e){delete this._children[e]},we.prototype.getChild=function(e){return this._children[e]},we.prototype.hasChild=function(e){return e in this._children},we.prototype.update=function(e){this._rawModule.namespaced=e.namespaced,e.actions&&(this._rawModule.actions=e.actions),e.mutations&&(this._rawModule.mutations=e.mutations),e.getters&&(this._rawModule.getters=e.getters)},we.prototype.forEachChild=function(e){he(this._children,e)},we.prototype.forEachGetter=function(e){this._rawModule.getters&&he(this._rawModule.getters,e)},we.prototype.forEachAction=function(e){this._rawModule.actions&&he(this._rawModule.actions,e)},we.prototype.forEachMutation=function(e){this._rawModule.mutations&&he(this._rawModule.mutations,e)},Object.defineProperties(we.prototype,ge);var ve,be=function(e){this.register([],e,!1)};function ye(e,t,n){if(t.update(n),n.modules)for(var r in n.modules){if(!t.getChild(r))return;ye(e.concat(r),t.getChild(r),n.modules[r])}}be.prototype.get=function(e){return e.reduce((function(e,t){return e.getChild(t)}),this.root)},be.prototype.getNamespace=function(e){var t=this.root;return e.reduce((function(e,n){return e+((t=t.getChild(n)).namespaced?n+"/":"")}),"")},be.prototype.update=function(e){ye([],this.root,e)},be.prototype.register=function(e,t,n){var r=this;void 0===n&&(n=!0);var o=new we(t,n);0===e.length?this.root=o:this.get(e.slice(0,-1)).addChild(e[e.length-1],o),t.modules&&he(t.modules,(function(t,o){r.register(e.concat(o),t,n)}))},be.prototype.unregister=function(e){var t=this.get(e.slice(0,-1)),n=e[e.length-1],r=t.getChild(n);r&&r.runtime&&t.removeChild(n)},be.prototype.isRegistered=function(e){var t=this.get(e.slice(0,-1)),n=e[e.length-1];return!!t&&t.hasChild(n)};var Ae=function(e){var t=this;void 0===e&&(e={}),!ve&&"undefined"!=typeof window&&window.Vue&&Ue(window.Vue);var n=e.plugins;void 0===n&&(n=[]);var r=e.strict;void 0===r&&(r=!1),this._committing=!1,this._actions=Object.create(null),this._actionSubscribers=[],this._mutations=Object.create(null),this._wrappedGetters=Object.create(null),this._modules=new be(e),this._modulesNamespaceMap=Object.create(null),this._subscribers=[],this._watcherVM=new ve,this._makeLocalGettersCache=Object.create(null);var o=this,s=this.dispatch,i=this.commit;this.dispatch=function(e,t){return s.call(o,e,t)},this.commit=function(e,t,n){return i.call(o,e,t,n)},this.strict=r;var a=this._modules.root.state;Re(this,a,[],this._modules.root),Se(this,a),n.forEach((function(e){return e(t)})),(void 0!==e.devtools?e.devtools:ve.config.devtools)&&function(e){pe&&(e._devtoolHook=pe,pe.emit("vuex:init",e),pe.on("vuex:travel-to-state",(function(t){e.replaceState(t)})),e.subscribe((function(e,t){pe.emit("vuex:mutation",e,t)}),{prepend:!0}),e.subscribeAction((function(e,t){pe.emit("vuex:action",e,t)}),{prepend:!0}))}(this)},_e={state:{configurable:!0}};function Ce(e,t,n){return t.indexOf(e)<0&&(n&&n.prepend?t.unshift(e):t.push(e)),function(){var n=t.indexOf(e);n>-1&&t.splice(n,1)}}function xe(e,t){e._actions=Object.create(null),e._mutations=Object.create(null),e._wrappedGetters=Object.create(null),e._modulesNamespaceMap=Object.create(null);var n=e.state;Re(e,n,[],e._modules.root,!0),Se(e,n,t)}function Se(e,t,n){var r=e._vm;e.getters={},e._makeLocalGettersCache=Object.create(null);var o=e._wrappedGetters,s={};he(o,(function(t,n){s[n]=function(e,t){return function(){return e(t)}}(t,e),Object.defineProperty(e.getters,n,{get:function(){return e._vm[n]},enumerable:!0})}));var i=ve.config.silent;ve.config.silent=!0,e._vm=new ve({data:{$$state:t},computed:s}),ve.config.silent=i,e.strict&&function(e){e._vm.$watch((function(){return this._data.$$state}),(function(){}),{deep:!0,sync:!0})}(e),r&&(n&&e._withCommit((function(){r._data.$$state=null})),ve.nextTick((function(){return r.$destroy()})))}function Re(e,t,n,r,o){var s=!n.length,i=e._modules.getNamespace(n);if(r.namespaced&&(e._modulesNamespaceMap[i],e._modulesNamespaceMap[i]=r),!s&&!o){var a=ke(t,n.slice(0,-1)),l=n[n.length-1];e._withCommit((function(){ve.set(a,l,r.state)}))}var c=r.context=function(e,t,n){var r=""===t,o={dispatch:r?e.dispatch:function(n,r,o){var s=Ee(n,r,o),i=s.payload,a=s.options,l=s.type;return a&&a.root||(l=t+l),e.dispatch(l,i)},commit:r?e.commit:function(n,r,o){var s=Ee(n,r,o),i=s.payload,a=s.options,l=s.type;a&&a.root||(l=t+l),e.commit(l,i,a)}};return Object.defineProperties(o,{getters:{get:r?function(){return e.getters}:function(){return function(e,t){if(!e._makeLocalGettersCache[t]){var n={},r=t.length;Object.keys(e.getters).forEach((function(o){if(o.slice(0,r)===t){var s=o.slice(r);Object.defineProperty(n,s,{get:function(){return e.getters[o]},enumerable:!0})}})),e._makeLocalGettersCache[t]=n}return e._makeLocalGettersCache[t]}(e,t)}},state:{get:function(){return ke(e.state,n)}}}),o}(e,i,n);r.forEachMutation((function(t,n){!function(e,t,n,r){(e._mutations[t]||(e._mutations[t]=[])).push((function(t){n.call(e,r.state,t)}))}(e,i+n,t,c)})),r.forEachAction((function(t,n){var r=t.root?n:i+n,o=t.handler||t;!function(e,t,n,r){(e._actions[t]||(e._actions[t]=[])).push((function(t){var o,s=n.call(e,{dispatch:r.dispatch,commit:r.commit,getters:r.getters,state:r.state,rootGetters:e.getters,rootState:e.state},t);return(o=s)&&"function"==typeof o.then||(s=Promise.resolve(s)),e._devtoolHook?s.catch((function(t){throw e._devtoolHook.emit("vuex:error",t),t})):s}))}(e,r,o,c)})),r.forEachGetter((function(t,n){!function(e,t,n,r){e._wrappedGetters[t]||(e._wrappedGetters[t]=function(e){return n(r.state,r.getters,e.state,e.getters)})}(e,i+n,t,c)})),r.forEachChild((function(r,s){Re(e,t,n.concat(s),r,o)}))}function ke(e,t){return t.reduce((function(e,t){return e[t]}),e)}function Ee(e,t,n){return me(e)&&e.type&&(n=t,t=e,e=e.type),{type:e,payload:t,options:n}}function Ue(e){ve&&e===ve||function(e){if(Number(e.version.split(".")[0])>=2)e.mixin({beforeCreate:n});else{var t=e.prototype._init;e.prototype._init=function(e){void 0===e&&(e={}),e.init=e.init?[n].concat(e.init):n,t.call(this,e)}}function n(){var e=this.$options;e.store?this.$store="function"==typeof e.store?e.store():e.store:e.parent&&e.parent.$store&&(this.$store=e.parent.$store)}}(ve=e)}_e.state.get=function(){return this._vm._data.$$state},_e.state.set=function(e){},Ae.prototype.commit=function(e,t,n){var r=this,o=Ee(e,t,n),s=o.type,i=o.payload,a=(o.options,{type:s,payload:i}),l=this._mutations[s];l&&(this._withCommit((function(){l.forEach((function(e){e(i)}))})),this._subscribers.slice().forEach((function(e){return e(a,r.state)})))},Ae.prototype.dispatch=function(e,t){var n=this,r=Ee(e,t),o=r.type,s=r.payload,i={type:o,payload:s},a=this._actions[o];if(a){try{this._actionSubscribers.slice().filter((function(e){return e.before})).forEach((function(e){return e.before(i,n.state)}))}catch(e){}var l=a.length>1?Promise.all(a.map((function(e){return e(s)}))):a[0](s);return new Promise((function(e,t){l.then((function(t){try{n._actionSubscribers.filter((function(e){return e.after})).forEach((function(e){return e.after(i,n.state)}))}catch(e){}e(t)}),(function(e){try{n._actionSubscribers.filter((function(e){return e.error})).forEach((function(t){return t.error(i,n.state,e)}))}catch(e){}t(e)}))}))}},Ae.prototype.subscribe=function(e,t){return Ce(e,this._subscribers,t)},Ae.prototype.subscribeAction=function(e,t){return Ce("function"==typeof e?{before:e}:e,this._actionSubscribers,t)},Ae.prototype.watch=function(e,t,n){var r=this;return this._watcherVM.$watch((function(){return e(r.state,r.getters)}),t,n)},Ae.prototype.replaceState=function(e){var t=this;this._withCommit((function(){t._vm._data.$$state=e}))},Ae.prototype.registerModule=function(e,t,n){void 0===n&&(n={}),"string"==typeof e&&(e=[e]),this._modules.register(e,t),Re(this,this.state,e,this._modules.get(e),n.preserveState),Se(this,this.state)},Ae.prototype.unregisterModule=function(e){var t=this;"string"==typeof e&&(e=[e]),this._modules.unregister(e),this._withCommit((function(){var n=ke(t.state,e.slice(0,-1));ve.delete(n,e[e.length-1])})),xe(this)},Ae.prototype.hasModule=function(e){return"string"==typeof e&&(e=[e]),this._modules.isRegistered(e)},Ae.prototype.hotUpdate=function(e){this._modules.update(e),xe(this,!0)},Ae.prototype._withCommit=function(e){var t=this._committing;this._committing=!0,e(),this._committing=t},Object.defineProperties(Ae.prototype,_e);var Pe=Me((function(e,t){var n={};return ze(t).forEach((function(t){var r=t.key,o=t.val;n[r]=function(){var t=this.$store.state,n=this.$store.getters;if(e){var r=Te(this.$store,0,e);if(!r)return;t=r.context.state,n=r.context.getters}return"function"==typeof o?o.call(this,t,n):t[o]},n[r].vuex=!0})),n})),Oe=Me((function(e,t){var n={};return ze(t).forEach((function(t){var r=t.key,o=t.val;n[r]=function(){for(var t=[],n=arguments.length;n--;)t[n]=arguments[n];var r=this.$store.commit;if(e){var s=Te(this.$store,0,e);if(!s)return;r=s.context.commit}return"function"==typeof o?o.apply(this,[r].concat(t)):r.apply(this.$store,[o].concat(t))}})),n})),Ie=Me((function(e,t){var n={};return ze(t).forEach((function(t){var r=t.key,o=t.val;o=e+o,n[r]=function(){if(!e||Te(this.$store,0,e))return this.$store.getters[o]},n[r].vuex=!0})),n})),De=Me((function(e,t){var n={};return ze(t).forEach((function(t){var r=t.key,o=t.val;n[r]=function(){for(var t=[],n=arguments.length;n--;)t[n]=arguments[n];var r=this.$store.dispatch;if(e){var s=Te(this.$store,0,e);if(!s)return;r=s.context.dispatch}return"function"==typeof o?o.apply(this,[r].concat(t)):r.apply(this.$store,[o].concat(t))}})),n}));function ze(e){return function(e){return Array.isArray(e)||me(e)}(e)?Array.isArray(e)?e.map((function(e){return{key:e,val:e}})):Object.keys(e).map((function(t){return{key:t,val:e[t]}})):[]}function Me(e){return function(t,n){return"string"!=typeof t?(n=t,t=""):"/"!==t.charAt(t.length-1)&&(t+="/"),e(t,n)}}function Te(e,t,n){return e._modulesNamespaceMap[n]}function Be(e,t,n){var r=n?e.groupCollapsed:e.group;try{r.call(e,t)}catch(n){e.log(t)}}function Fe(e){try{e.groupEnd()}catch(t){e.log("—— log end ——")}}function Le(){var e=new Date;return" @ "+$e(e.getHours(),2)+":"+$e(e.getMinutes(),2)+":"+$e(e.getSeconds(),2)+"."+$e(e.getMilliseconds(),3)}function $e(e,t){return n=t-e.toString().length,new Array(n+1).join("0")+e;var n}var Ne={Store:Ae,install:Ue,version:"3.6.2",mapState:Pe,mapMutations:Oe,mapGetters:Ie,mapActions:De,createNamespacedHelpers:function(e){return{mapState:Pe.bind(null,e),mapGetters:Ie.bind(null,e),mapMutations:Oe.bind(null,e),mapActions:De.bind(null,e)}},createLogger:function(e){void 0===e&&(e={});var t=e.collapsed;void 0===t&&(t=!0);var n=e.filter;void 0===n&&(n=function(e,t,n){return!0});var r=e.transformer;void 0===r&&(r=function(e){return e});var o=e.mutationTransformer;void 0===o&&(o=function(e){return e});var s=e.actionFilter;void 0===s&&(s=function(e,t){return!0});var i=e.actionTransformer;void 0===i&&(i=function(e){return e});var a=e.logMutations;void 0===a&&(a=!0);var l=e.logActions;void 0===l&&(l=!0);var c=e.logger;return void 0===c&&(c=console),function(e){var u=fe(e.state);void 0!==c&&(a&&e.subscribe((function(e,s){var i=fe(s);if(n(e,u,i)){var a=Le(),l=o(e),d="mutation "+e.type+a;Be(c,d,t),c.log("%c prev state","color: #9E9E9E; font-weight: bold",r(u)),c.log("%c mutation","color: #03A9F4; font-weight: bold",l),c.log("%c next state","color: #4CAF50; font-weight: bold",r(i)),Fe(c)}u=i})),l&&e.subscribeAction((function(e,n){if(s(e,n)){var r=Le(),o=i(e),a="action "+e.type+r;Be(c,a,t),c.log("%c action","color: #03A9F4; font-weight: bold",o),Fe(c)}})))}}};const je=Ne;var qe=n(614),He=n(519),Ge=n.n(He);function Je(e){return Je="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Je(e)}function We(e){var t="function"==typeof Map?new Map:void 0;return We=function(e){if(null===e||(n=e,-1===Function.toString.call(n).indexOf("[native code]")))return e;var n;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,r)}function r(){return Qe(e,arguments,Ke(this).constructor)}return r.prototype=Object.create(e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),Ze(r,e)},We(e)}function Qe(e,t,n){return Qe=Ve()?Reflect.construct:function(e,t,n){var r=[null];r.push.apply(r,t);var o=new(Function.bind.apply(e,r));return n&&Ze(o,n.prototype),o},Qe.apply(null,arguments)}function Ve(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function Ze(e,t){return Ze=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},Ze(e,t)}function Ke(e){return Ke=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Ke(e)}const Ye=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ze(e,t)}(o,e);var t,n,r=(t=o,n=Ve(),function(){var e,r=Ke(t);if(n){var o=Ke(this).constructor;e=Reflect.construct(r,arguments,o)}else e=r.apply(this,arguments);return function(e,t){return!t||"object"!==Je(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}(this,e)});function o(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=r.call(this,e)).originalRequest=s,t.originalResponse=i,t.causingError=n,null!=n&&(e+=", caused by ".concat(n.toString())),null!=s){var a=s.getHeader("X-Request-ID")||"n/a",l=s.getMethod(),c=s.getURL(),u=i?i.getStatus():"n/a",d=i?i.getBody()||"":"n/a";e+=", originated from request (method: ".concat(l,", url: ").concat(c,", response code: ").concat(u,", response text: ").concat(d,", request id: ").concat(a,")")}return t.message=e,t}return o}(We(Error));function Xe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function et(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Xe(Object(n),!0).forEach((function(t){tt(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Xe(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function tt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function nt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var rt=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),"resume"in n&&console.log("tus: The `resume` option has been removed in tus-js-client v2. Please use the URL storage API instead."),this.options=n,this.options.chunkSize=+this.options.chunkSize,this._urlStorage=this.options.urlStorage,this.file=t,this.url=null,this._req=null,this._fingerprint=null,this._urlStorageKey=null,this._offset=null,this._aborted=!1,this._size=null,this._source=null,this._retryAttempt=0,this._retryTimeout=null,this._offsetBeforeRetry=0,this._parallelUploads=null,this._parallelUploadUrls=null}var t,n,r;return t=e,n=[{key:"findPreviousUploads",value:function(){var e=this;return this.options.fingerprint(this.file,this.options).then((function(t){return e._urlStorage.findUploadsByFingerprint(t)}))}},{key:"resumeFromPreviousUpload",value:function(e){this.url=e.uploadUrl||null,this._parallelUploadUrls=e.parallelUploadUrls||null,this._urlStorageKey=e.urlStorageKey}},{key:"start",value:function(){var e=this,t=this.file;if(t)if(this.options.endpoint||this.options.uploadUrl){var n=this.options.retryDelays;null==n||"[object Array]"===Object.prototype.toString.call(n)?(this.options.parallelUploads>1&&["uploadUrl","uploadSize","uploadLengthDeferred"].forEach((function(t){e.options[t]&&e._emitError(new Error("tus: cannot use the ".concat(t," option when parallelUploads is enabled")))})),this.options.fingerprint(t,this.options).then((function(n){return null==n||"Calculated fingerprint: ".concat(n),e._fingerprint=n,e._source?e._source:e.options.fileReader.openFile(t,e.options.chunkSize)})).then((function(t){e._source=t,e.options.parallelUploads>1||null!=e._parallelUploadUrls?e._startParallelUpload():e._startSingleUpload()})).catch((function(t){e._emitError(t)}))):this._emitError(new Error("tus: the `retryDelays` option must either be an array or null"))}else this._emitError(new Error("tus: neither an endpoint or an upload URL is provided"));else this._emitError(new Error("tus: no file or stream to upload provided"))}},{key:"_startParallelUpload",value:function(){var t=this,n=this._size=this._source.size,r=0;this._parallelUploads=[];var o=null!=this._parallelUploadUrls?this._parallelUploadUrls.length:this.options.parallelUploads,s=function(e,t,n){for(var r=Math.floor(e/t),o=[],s=0;s<t;s++)o.push({start:r*s,end:r*(s+1)});return o[t-1].end=e,n&&o.forEach((function(e,t){e.uploadUrl=n[t]||null})),o}(this._source.size,o,this._parallelUploadUrls);this._parallelUploadUrls=new Array(s.length);var i,a=s.map((function(o,i){var a=0;return t._source.slice(o.start,o.end).then((function(l){var c=l.value;return new Promise((function(l,u){var d=et(et({},t.options),{},{uploadUrl:o.uploadUrl||null,storeFingerprintForResuming:!1,removeFingerprintOnSuccess:!1,parallelUploads:1,metadata:{},headers:et(et({},t.options.headers),{},{"Upload-Concat":"partial"}),onSuccess:l,onError:u,onProgress:function(e){r=r-a+e,a=e,t._emitProgress(r,n)},_onUploadUrlAvailable:function(){t._parallelUploadUrls[i]=p.url,t._parallelUploadUrls.filter((function(e){return!!e})).length===s.length&&t._saveUploadInUrlStorage()}}),p=new e(c,d);p.start(),t._parallelUploads.push(p)}))}))}));Promise.all(a).then((function(){(i=t._openRequest("POST",t.options.endpoint)).setHeader("Upload-Concat","final;".concat(t._parallelUploadUrls.join(" ")));var e=ot(t.options.metadata);return""!==e&&i.setHeader("Upload-Metadata",e),t._sendRequest(i,null)})).then((function(e){if(st(e.getStatus(),200)){var n=e.getHeader("Location");null!=n?(t.url=ct(t.options.endpoint,n),"Created upload at ".concat(t.url),t._emitSuccess()):t._emitHttpError(i,e,"tus: invalid or missing Location header")}else t._emitHttpError(i,e,"tus: unexpected response while creating upload")})).catch((function(e){t._emitError(e)}))}},{key:"_startSingleUpload",value:function(){if(this.options.uploadLengthDeferred)this._size=null;else if(null!=this.options.uploadSize){if(this._size=+this.options.uploadSize,isNaN(this._size))return void this._emitError(new Error("tus: cannot convert `uploadSize` option into a number"))}else if(this._size=this._source.size,null==this._size)return void this._emitError(new Error("tus: cannot automatically derive upload's size from input. Specify it manually using the `uploadSize` option or use the `uploadLengthDeferred` option"));return this._aborted=!1,null!=this.url?("Resuming upload from previous URL: ".concat(this.url),void this._resumeUpload()):null!=this.options.uploadUrl?("Resuming upload from provided URL: ".concat(this.options.uploadUrl),this.url=this.options.uploadUrl,void this._resumeUpload()):void this._createUpload()}},{key:"abort",value:function(t){var n=this;if(arguments.length>1&&"function"==typeof arguments[1])throw new Error("tus: the abort function does not accept a callback since v2 anymore; please use the returned Promise instead");return null!=this._parallelUploads&&this._parallelUploads.forEach((function(e){e.abort(t)})),null!==this._req&&(this._req.abort(),this._source.close()),this._aborted=!0,null!=this._retryTimeout&&(clearTimeout(this._retryTimeout),this._retryTimeout=null),t&&null!=this.url?e.terminate(this.url,this.options).then((function(){return n._removeFromUrlStorage()})):Promise.resolve()}},{key:"_emitHttpError",value:function(e,t,n,r){this._emitError(new Ye(n,r,e,t))}},{key:"_emitError",value:function(e){var t=this;if(!this._aborted){if(null!=this.options.retryDelays&&(null!=this._offset&&this._offset>this._offsetBeforeRetry&&(this._retryAttempt=0),lt(e,this._retryAttempt,this.options))){var n=this.options.retryDelays[this._retryAttempt++];return this._offsetBeforeRetry=this._offset,void(this._retryTimeout=setTimeout((function(){t.start()}),n))}if("function"!=typeof this.options.onError)throw e;this.options.onError(e)}}},{key:"_emitSuccess",value:function(){this.options.removeFingerprintOnSuccess&&this._removeFromUrlStorage(),"function"==typeof this.options.onSuccess&&this.options.onSuccess()}},{key:"_emitProgress",value:function(e,t){"function"==typeof this.options.onProgress&&this.options.onProgress(e,t)}},{key:"_emitChunkComplete",value:function(e,t,n){"function"==typeof this.options.onChunkComplete&&this.options.onChunkComplete(e,t,n)}},{key:"_createUpload",value:function(){var e=this;if(this.options.endpoint){var t=this._openRequest("POST",this.options.endpoint);this.options.uploadLengthDeferred?t.setHeader("Upload-Defer-Length",1):t.setHeader("Upload-Length",this._size);var n,r=ot(this.options.metadata);""!==r&&t.setHeader("Upload-Metadata",r),this.options.uploadDataDuringCreation&&!this.options.uploadLengthDeferred?(this._offset=0,n=this._addChunkToRequest(t)):n=this._sendRequest(t,null),n.then((function(n){if(st(n.getStatus(),200)){var r=n.getHeader("Location");if(null!=r){if(e.url=ct(e.options.endpoint,r),"Created upload at ".concat(e.url),"function"==typeof e.options._onUploadUrlAvailable&&e.options._onUploadUrlAvailable(),0===e._size)return e._emitSuccess(),void e._source.close();e._saveUploadInUrlStorage(),e.options.uploadDataDuringCreation?e._handleUploadResponse(t,n):(e._offset=0,e._performUpload())}else e._emitHttpError(t,n,"tus: invalid or missing Location header")}else e._emitHttpError(t,n,"tus: unexpected response while creating upload")})).catch((function(n){e._emitHttpError(t,null,"tus: failed to create upload",n)}))}else this._emitError(new Error("tus: unable to create upload because no endpoint is provided"))}},{key:"_resumeUpload",value:function(){var e=this,t=this._openRequest("HEAD",this.url);this._sendRequest(t,null).then((function(n){var r=n.getStatus();if(!st(r,200))return st(r,400)&&e._removeFromUrlStorage(),423===r?void e._emitHttpError(t,n,"tus: upload is currently locked; retry later"):e.options.endpoint?(e.url=null,void e._createUpload()):void e._emitHttpError(t,n,"tus: unable to resume upload (new upload cannot be created without an endpoint)");var o=parseInt(n.getHeader("Upload-Offset"),10);if(isNaN(o))e._emitHttpError(t,n,"tus: invalid or missing offset value");else{var s=parseInt(n.getHeader("Upload-Length"),10);if(!isNaN(s)||e.options.uploadLengthDeferred){if("function"==typeof e.options._onUploadUrlAvailable&&e.options._onUploadUrlAvailable(),o===s)return e._emitProgress(s,s),void e._emitSuccess();e._offset=o,e._performUpload()}else e._emitHttpError(t,n,"tus: invalid or missing length value")}})).catch((function(n){e._emitHttpError(t,null,"tus: failed to resume upload",n)}))}},{key:"_performUpload",value:function(){var e,t=this;this._aborted||(this.options.overridePatchMethod?(e=this._openRequest("POST",this.url)).setHeader("X-HTTP-Method-Override","PATCH"):e=this._openRequest("PATCH",this.url),e.setHeader("Upload-Offset",this._offset),this._addChunkToRequest(e).then((function(n){st(n.getStatus(),200)?t._handleUploadResponse(e,n):t._emitHttpError(e,n,"tus: unexpected response while uploading chunk")})).catch((function(n){t._aborted||t._emitHttpError(e,null,"tus: failed to upload chunk at offset ".concat(t._offset),n)})))}},{key:"_addChunkToRequest",value:function(e){var t=this,n=this._offset,r=this._offset+this.options.chunkSize;return e.setProgressHandler((function(e){t._emitProgress(n+e,t._size)})),e.setHeader("Content-Type","application/offset+octet-stream"),(r===1/0||r>this._size)&&!this.options.uploadLengthDeferred&&(r=this._size),this._source.slice(n,r).then((function(n){var r=n.value,o=n.done;return t.options.uploadLengthDeferred&&o&&(t._size=t._offset+(r&&r.size?r.size:0),e.setHeader("Upload-Length",t._size)),null===r?t._sendRequest(e):(t._emitProgress(t._offset,t._size),t._sendRequest(e,r))}))}},{key:"_handleUploadResponse",value:function(e,t){var n=parseInt(t.getHeader("Upload-Offset"),10);if(isNaN(n))this._emitHttpError(e,t,"tus: invalid or missing offset value");else{if(this._emitProgress(n,this._size),this._emitChunkComplete(n-this._offset,n,this._size),this._offset=n,n==this._size)return this._emitSuccess(),void this._source.close();this._performUpload()}}},{key:"_openRequest",value:function(e,t){var n=it(e,t,this.options);return this._req=n,n}},{key:"_removeFromUrlStorage",value:function(){var e=this;this._urlStorageKey&&(this._urlStorage.removeUpload(this._urlStorageKey).catch((function(t){e._emitError(t)})),this._urlStorageKey=null)}},{key:"_saveUploadInUrlStorage",value:function(){var e=this;if(this.options.storeFingerprintForResuming&&this._fingerprint){var t={size:this._size,metadata:this.options.metadata,creationTime:(new Date).toString()};this._parallelUploads?t.parallelUploadUrls=this._parallelUploadUrls:t.uploadUrl=this.url,this._urlStorage.addUpload(this._fingerprint,t).then((function(t){return e._urlStorageKey=t})).catch((function(t){e._emitError(t)}))}}},{key:"_sendRequest",value:function(e){return at(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,this.options)}}],r=[{key:"terminate",value:function(t,n){if(arguments.length>1&&"function"==typeof arguments[arguments.length-1])throw new Error("tus: the terminate function does not accept a callback since v2 anymore; please use the returned Promise instead");void 0===n&&(n={});var r=it("DELETE",t,n);return at(r,null,n).then((function(e){if(204!==e.getStatus())throw new Ye("tus: unexpected response while terminating upload",null,r,e)})).catch((function(o){if(o instanceof Ye||(o=new Ye("tus: failed to terminate upload",o,r,null)),!lt(o,0,n))throw o;var s=n.retryDelays[0],i=n.retryDelays.slice(1),a=et(et({},n),{},{retryDelays:i});return new Promise((function(e){return setTimeout(e,s)})).then((function(){return e.terminate(t,a)}))}))}}],n&&nt(t.prototype,n),r&&nt(t,r),e}();function ot(e){var t=[];for(var n in e)t.push("".concat(n," ").concat(qe.Base64.encode(e[n])));return t.join(",")}function st(e,t){return e>=t&&e<t+100}function it(e,t,n){var r=n.httpStack.createRequest(e,t);r.setHeader("Tus-Resumable","1.0.0");var o=n.headers||{};for(var s in o)r.setHeader(s,o[s]);if(n.addRequestId){var i="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)}));r.setHeader("X-Request-ID",i)}return r}function at(e,t,n){return("function"==typeof n.onBeforeRequest?Promise.resolve(n.onBeforeRequest(e)):Promise.resolve()).then((function(){return e.send(t).then((function(t){return("function"==typeof n.onAfterResponse?Promise.resolve(n.onAfterResponse(e,t)):Promise.resolve()).then((function(){return t}))}))}))}function lt(e,t,n){if(null==n.retryDelays||t>=n.retryDelays.length||null==e.originalRequest)return!1;if(n&&"function"==typeof n.onShouldRetry)return n.onShouldRetry(e,t,n);var r,o=e.originalResponse?e.originalResponse.getStatus():0;return(!st(o,400)||409===o||423===o)&&(r=!0,"undefined"!=typeof window&&"navigator"in window&&!1===window.navigator.onLine&&(r=!1),r)}function ct(e,t){return new(Ge())(t,e).toString()}rt.defaultOptions={endpoint:null,uploadUrl:null,metadata:{},fingerprint:null,uploadSize:null,onProgress:null,onChunkComplete:null,onSuccess:null,onError:null,_onUploadUrlAvailable:null,overridePatchMethod:!1,headers:{},addRequestId:!1,onBeforeRequest:null,onAfterResponse:null,onShouldRetry:null,chunkSize:1/0,retryDelays:[0,1e3,3e3,5e3],parallelUploads:1,storeFingerprintForResuming:!0,removeFingerprintOnSuccess:!1,uploadLengthDeferred:!1,uploadDataDuringCreation:!1,urlStorage:null,fileReader:null,httpStack:null};const ut=rt;function dt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var pt=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n;return t=e,(n=[{key:"listAllUploads",value:function(){return Promise.resolve([])}},{key:"findUploadsByFingerprint",value:function(e){return Promise.resolve([])}},{key:"removeUpload",value:function(e){return Promise.resolve()}},{key:"addUpload",value:function(e,t){return Promise.resolve(null)}}])&&dt(t.prototype,n),e}();function ft(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var ht=!1;try{ht="localStorage"in window;var mt="tusSupport";localStorage.setItem(mt,localStorage.getItem(mt))}catch(e){if(e.code!==e.SECURITY_ERR&&e.code!==e.QUOTA_EXCEEDED_ERR)throw e;ht=!1}var wt=ht,gt=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n;return t=e,n=[{key:"findAllUploads",value:function(){var e=this._findEntries("tus::");return Promise.resolve(e)}},{key:"findUploadsByFingerprint",value:function(e){var t=this._findEntries("tus::".concat(e,"::"));return Promise.resolve(t)}},{key:"removeUpload",value:function(e){return localStorage.removeItem(e),Promise.resolve()}},{key:"addUpload",value:function(e,t){var n=Math.round(1e12*Math.random()),r="tus::".concat(e,"::").concat(n);return localStorage.setItem(r,JSON.stringify(t)),Promise.resolve(r)}},{key:"_findEntries",value:function(e){for(var t=[],n=0;n<localStorage.length;n++){var r=localStorage.key(n);if(0===r.indexOf(e))try{var o=JSON.parse(localStorage.getItem(r));o.urlStorageKey=r,t.push(o)}catch(e){}}return t}}],n&&ft(t.prototype,n),e}();function vt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function bt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function yt(e,t,n){return t&&bt(e.prototype,t),n&&bt(e,n),e}var At=function(){function e(){vt(this,e)}return yt(e,[{key:"createRequest",value:function(e,t){return new _t(e,t)}},{key:"getName",value:function(){return"XHRHttpStack"}}]),e}(),_t=function(){function e(t,n){vt(this,e),this._xhr=new XMLHttpRequest,this._xhr.open(t,n,!0),this._method=t,this._url=n,this._headers={}}return yt(e,[{key:"getMethod",value:function(){return this._method}},{key:"getURL",value:function(){return this._url}},{key:"setHeader",value:function(e,t){this._xhr.setRequestHeader(e,t),this._headers[e]=t}},{key:"getHeader",value:function(e){return this._headers[e]}},{key:"setProgressHandler",value:function(e){"upload"in this._xhr&&(this._xhr.upload.onprogress=function(t){t.lengthComputable&&e(t.loaded)})}},{key:"send",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return new Promise((function(n,r){e._xhr.onload=function(){n(new Ct(e._xhr))},e._xhr.onerror=function(e){r(e)},e._xhr.send(t)}))}},{key:"abort",value:function(){return this._xhr.abort(),Promise.resolve()}},{key:"getUnderlyingObject",value:function(){return this._xhr}}]),e}(),Ct=function(){function e(t){vt(this,e),this._xhr=t}return yt(e,[{key:"getStatus",value:function(){return this._xhr.status}},{key:"getHeader",value:function(e){return this._xhr.getResponseHeader(e)}},{key:"getBody",value:function(){return this._xhr.responseText}},{key:"getUnderlyingObject",value:function(){return this._xhr}}]),e}();const xt=function(){return"undefined"!=typeof navigator&&"string"==typeof navigator.product&&"reactnative"===navigator.product.toLowerCase()};function St(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Rt=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._file=t,this.size=t.size}var t,n;return t=e,(n=[{key:"slice",value:function(e,t){if("undefined"!=typeof window&&(void 0!==window.PhoneGap||void 0!==window.Cordova||void 0!==window.cordova))return n=this._file.slice(e,t),new Promise((function(e,t){var r=new FileReader;r.onload=function(){var t=new Uint8Array(r.result);e({value:t})},r.onerror=function(e){t(e)},r.readAsArrayBuffer(n)}));var n,r=this._file.slice(e,t);return Promise.resolve({value:r})}},{key:"close",value:function(){}}])&&St(t.prototype,n),e}();function kt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Et(e){return void 0===e?0:void 0!==e.size?e.size:e.length}var Ut=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._chunkSize=n,this._buffer=void 0,this._bufferOffset=0,this._reader=t,this._done=!1}var t,n;return t=e,(n=[{key:"slice",value:function(e,t){return e<this._bufferOffset?Promise.reject(new Error("Requested data is before the reader's current offset")):this._readUntilEnoughDataOrDone(e,t)}},{key:"_readUntilEnoughDataOrDone",value:function(e,t){var n=this,r=t<=this._bufferOffset+Et(this._buffer);if(this._done||r){var o=this._getDataFromBuffer(e,t),s=null==o&&this._done;return Promise.resolve({value:o,done:s})}return this._reader.read().then((function(r){var o=r.value;return r.done?n._done=!0:void 0===n._buffer?n._buffer=o:n._buffer=function(e,t){if(e.concat)return e.concat(t);if(e instanceof Blob)return new Blob([e,t],{type:e.type});if(e.set){var n=new e.constructor(e.length+t.length);return n.set(e),n.set(t,e.length),n}throw new Error("Unknown data type")}(n._buffer,o),n._readUntilEnoughDataOrDone(e,t)}))}},{key:"_getDataFromBuffer",value:function(e,t){e>this._bufferOffset&&(this._buffer=this._buffer.slice(e-this._bufferOffset),this._bufferOffset=e);var n=0===Et(this._buffer);return this._done&&n?null:this._buffer.slice(0,t-e)}},{key:"close",value:function(){this._reader.cancel&&this._reader.cancel()}}])&&kt(t.prototype,n),e}();function Pt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Ot=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n;return t=e,(n=[{key:"openFile",value:function(e,t){return xt()&&e&&void 0!==e.uri?(n=e.uri,new Promise((function(e,t){var r=new XMLHttpRequest;r.responseType="blob",r.onload=function(){var t=r.response;e(t)},r.onerror=function(e){t(e)},r.open("GET",n),r.send()}))).then((function(e){return new Rt(e)})).catch((function(e){throw new Error("tus: cannot fetch `file.uri` as Blob, make sure the uri is correct and accessible. ".concat(e))})):"function"==typeof e.slice&&void 0!==e.size?Promise.resolve(new Rt(e)):"function"==typeof e.read?(t=+t,isFinite(t)?Promise.resolve(new Ut(e,t)):Promise.reject(new Error("cannot create source for stream without a finite value for the `chunkSize` option"))):Promise.reject(new Error("source object may only be an instance of File, Blob, or Reader in this environment"));var n}}])&&Pt(t.prototype,n),e}();function It(e){return It="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},It(e)}function Dt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function zt(e,t){return zt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},zt(e,t)}function Mt(e){return Mt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Mt(e)}function Tt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Bt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Tt(Object(n),!0).forEach((function(t){Ft(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Tt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Ft(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Lt=Bt(Bt({},ut.defaultOptions),{},{httpStack:new At,fileReader:new Ot,urlStorage:wt?new gt:new pt,fingerprint:function(e,t){return xt()?Promise.resolve(function(e,t){var n=e.exif?function(e){var t=0;if(0===e.length)return t;for(var n=0;n<e.length;n++)t=(t<<5)-t+e.charCodeAt(n),t&=t;return t}(JSON.stringify(e.exif)):"noexif";return["tus-rn",e.name||"noname",e.size||"nosize",n,t.endpoint].join("/")}(e,t)):Promise.resolve(["tus-br",e.name,e.type,e.size,e.lastModified,t.endpoint].join("-"))}}),$t=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&zt(e,t)}(i,e);var t,n,r,o,s=(r=i,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Mt(r);if(o){var n=Mt(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return function(e,t){return!t||"object"!==It(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}(this,e)});function i(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),t=Bt(Bt({},Lt),t),s.call(this,e,t)}return t=i,n=[{key:"terminate",value:function(e,t,n){return t=Bt(Bt({},Lt),t),ut.terminate(e,t,n)}}],null&&Dt(t.prototype,null),n&&Dt(t,n),i}(ut),Nt=window,jt=Nt.XMLHttpRequest,qt=Nt.Blob;jt&&qt&&qt.prototype.slice,n(547),n(794),n(211);const Ht={name:"Clipboard",props:{value:{type:String,required:!0}},data:()=>({state:"pristine"}),methods:{copy(){let e=document.createElement("textarea");Object.assign(e.style,{position:"absolute",left:"-200%"}),e.value=this.value,document.body.appendChild(e);let t=!1;try{e.select(),t=document.execCommand("copy")}catch(e){alert(this.$root.lang.oldBrowserError),console.error(e)}document.body.removeChild(e),this.state=t?"copied":"error",this.$emit("change",this.state)}}};var Gt=n(486);const Jt=(0,Gt.A)(Ht,(function(){var e=this,t=e._self._c;return t("span",{staticStyle:{cursor:"pointer"},on:{click:function(t){return t.stopPropagation(),e.copy()}}},[e._t("default",(function(){return["pristine"===e.state?t("icon",{staticClass:"fa-fw",attrs:{name:"copy"}}):e._e(),"copied"===e.state?t("icon",{staticClass:"fa-fw",attrs:{name:"check"}}):e._e(),"error"===e.state?t("icon",{staticClass:"fa-fw",attrs:{name:"exclamation-triangle"}}):e._e(),e._t("text",(function(){return[e._v(" "+e._s(e.$root.lang.clipboard))]}))]}),{state:e.state})],2)}),[],!1,null,null,null).exports;n(560);const Wt={_pattern:/[A-Z0-9_\-+!]/,_getRandomByte:function(){const e=new Uint8Array(1);let t=window.msCrypto;return t||(t=window.crypto),t.getRandomValues(e),e[0]},generate:function(e){let t=window.msCrypto;return t||(t=window.crypto),t&&t.getRandomValues?Array.apply(null,{length:e}).map((function(){let e;for(;;)if(e=String.fromCharCode(this._getRandomByte()),this._pattern.test(e))return e}),this).join(""):""}},Qt={name:"Settings",computed:Pe({config:"config",disabled:"disabled",retention:e=>e.upload.retention,password:e=>e.upload.password}),methods:{generatePassword(){this.disabled||this.$store.commit("upload/PASSWORD",Wt.generate(10))}}},Vt=(0,Gt.A)(Qt,(function(){var e=this,t=e._self._c;return e.config&&e.config.retentions?t("div",[t("div",{staticClass:"panel panel-default",class:{"panel-info":!e.disabled}},[t("div",{staticClass:"panel-heading"},[t("strong",[e._v(e._s(e.$root.lang.settings))])]),t("div",{staticClass:"panel-body"},[t("div",{staticClass:"form-group"},[t("label",{attrs:{for:"retention"}},[e._v(e._s(e.$root.lang.retention))]),t("select",{staticClass:"form-control",attrs:{id:"retention",disabled:e.disabled},domProps:{value:e.retention},on:{change:function(t){return e.$store.commit("upload/RETENTION",t.target.value)}}},e._l(e.config.retentions,(function(n,r){return t("option",{domProps:{value:r,selected:r===e.retention}},[e._v(e._s(e.$root.lang.retentions[r]||n))])})),0)]),t("div",[t("label",{attrs:{for:"password"}},[e._v(e._s(e.$root.lang.password))]),t("div",{staticClass:"input-group",class:{"has-error":e.config.requireBucketPassword&&!e.password}},[t("input",{staticClass:"form-control",attrs:{id:"password",type:"text",disabled:e.disabled,placeholder:e.config.requireBucketPassword?e.$root.lang.required:e.$root.lang.optional,required:"config.requireBucketPassword"},domProps:{value:e.password},on:{input:function(t){return e.$store.commit("upload/PASSWORD",t.target.value)}}}),t("span",{staticClass:"input-group-addon",staticStyle:{cursor:"pointer"},attrs:{title:e.$root.lang.generateRandomPassword,tabindex:"0",role:"button"},on:{click:function(t){return e.generatePassword()},keydown:[function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:(t.preventDefault(),e.generatePassword())},function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"space",32,t.key,[" ","Spacebar"])?null:(t.preventDefault(),e.generatePassword())}]}},[t("icon",{attrs:{name:"key"}})],1)])])])])]):e._e()}),[],!1,null,null,null).exports;var Zt=n(628),Kt=n.n(Zt),Yt=n(842);Yt.A.register({plus:{width:448,height:512,paths:[{d:"M416 208c17.7 0 32 14.3 32 32v32c0 17.7-14.3 32-32 32h-144v144c0 17.7-14.3 32-32 32h-32c-17.7 0-32-14.3-32-32v-144h-144c-17.7 0-32-14.3-32-32v-32c0-17.7 14.3-32 32-32h144v-144c0-17.7 14.3-32 32-32h32c17.7 0 32 14.3 32 32v144h144z"}]}}),Yt.A.register({"plus-circle":{width:512,height:512,paths:[{d:"M256 8c137 0 248 111 248 248s-111 248-248 248-248-111-248-248 111-248 248-248zM400 284v-56c0-6.6-5.4-12-12-12h-92v-92c0-6.6-5.4-12-12-12h-56c-6.6 0-12 5.4-12 12v92h-92c-6.6 0-12 5.4-12 12v56c0 6.6 5.4 12 12 12h92v92c0 6.6 5.4 12 12 12h56c6.6 0 12-5.4 12-12v-92h92c6.6 0 12-5.4 12-12z"}]}}),Yt.A.register({times:{width:352,height:512,paths:[{d:"M242.7 256l100.1 100.1c12.3 12.3 12.3 32.2 0 44.5l-22.2 22.2c-12.3 12.3-32.2 12.3-44.5 0l-100.1-100.1-100.1 100.1c-12.3 12.3-32.2 12.3-44.5 0l-22.2-22.2c-12.3-12.3-12.3-32.2 0-44.5l100.1-100.1-100.1-100.1c-12.3-12.3-12.3-32.2 0-44.5l22.2-22.2c12.3-12.3 32.2-12.3 44.5 0l100.1 100.1 100.1-100.1c12.3-12.3 32.2-12.3 44.5 0l22.2 22.2c12.3 12.3 12.3 32.2 0 44.5z"}]}}),n(280),n(908),n(434),n(98),n(843),n(183),n(207);const Xt={props:["file"],computed:{iconClass(){const e=this.file.type||this.file.metadata&&this.file.metadata.type;return e?e.startsWith("image")?"regular/file-image":e.startsWith("text")?"regular/file-alt":e.startsWith("video")?"regular/file-video":e.startsWith("audio")?"regular/file-audio":"application/pdf"===e?"regular/file-pdf":e.startsWith("application")?"regular/file-archive":"regular/file":"regular/file"},isImageBlob(){return!(!URL&&!webkitURL)&&this.file instanceof File&&this.file.type.startsWith("image")},blobUrl(){if(this.isImageBlob)return(URL||webkitURL).createObjectURL(this.file)}}},en=(0,Gt.A)(Xt,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"file-icon"},[e.isImageBlob?e._e():t("icon",{attrs:{name:e.iconClass,scale:"3"}}),e.isImageBlob?t("img",{attrs:{src:e.blobUrl}}):e._e()],1)}),[],!1,null,null,null).exports;var tn=n(751),nn=n.n(tn);const rn={randomUUID:"undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};let on;const sn=new Uint8Array(16),an=[];for(let e=0;e<256;++e)an.push((e+256).toString(16).slice(1));const ln=function(e,t,n){if(rn.randomUUID&&!t&&!e)return rn.randomUUID();const r=(e=e||{}).random??e.rng?.()??function(){if(!on){if("undefined"==typeof crypto||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");on=crypto.getRandomValues.bind(crypto)}return on(sn)}();if(r.length<16)throw new Error("Random bytes length must be >= 16");if(r[6]=15&r[6]|64,r[8]=63&r[8]|128,t){if((n=n||0)<0||n+16>t.length)throw new RangeError(`UUID byte range ${n}:${n+15} is out of buffer bounds`);for(let e=0;e<16;++e)t[n+e]=r[e];return t}return function(e,t=0){return(an[e[t+0]]+an[e[t+1]]+an[e[t+2]]+an[e[t+3]]+"-"+an[e[t+4]]+an[e[t+5]]+"-"+an[e[t+6]]+an[e[t+7]]+"-"+an[e[t+8]]+an[e[t+9]]+"-"+an[e[t+10]]+an[e[t+11]]+an[e[t+12]]+an[e[t+13]]+an[e[t+14]]+an[e[t+15]]).toLowerCase()}(r)};function cn(e){let t=-1;do{e/=1024,t++}while(e>1024);return Math.max(e,.01).toFixed(2)+[" kB"," MB"," GB"," TB","PB","EB","ZB","YB"][t]}let un=null,dn=!1;const pn={namespaced:!0,state:{retention:null,password:"",files:[],sid:function(){const e=document.location.search.match(/sid=([^&]+)/);return e?e[1]:nn()(ln()).toString().substr(0,12)}(),uploadURI:(window.PSITRANSFER_UPLOAD_PATH||"/")+"files"},getters:{shareUrl:e=>document.head.getElementsByTagName("base")[0].href+e.sid,percentUploaded:(e,t)=>Math.min(Math.round(t.bytesUploaded/t.bucketSize*100),100),bytesUploaded:e=>e.files.reduce(((e,t)=>e+t.progress.bytesUploaded),0),bucketSize:e=>e.files.reduce(((e,t)=>e+t._File.size),0),bucketSizeError:(e,t,n)=>{const r=n.config&&n.config.maxBucketSize;return!!r&&t.bucketSize>r&&n.lang.bucketSizeExceed.replace("%%",cn(t.bucketSize)).replace("%%",cn(r))}},mutations:{RETENTION(e,t){e.retention=t},PASSWORD(e,t){e.password=t},SET_SID(e,t){e.sid=t},ADD_FILE(e,t){e.files.splice(0,0,t)},REMOVE_FILE(e,t){let n=e.files.indexOf(t);n>-1&&e.files.splice(n,1)},UPDATE_FILE(e,t){for(let e in t.data)t.file[e]=t.data[e]},NEW_SESSION(e){e.password="",e.files.splice(0,e.files.length),e.sid=nn()(ln()).toString().substr(0,12)}},actions:{addFiles({commit:e,state:t,rootState:n},r){if(!t.disabled)for(let t=0;t<r.length;t++){let o=!1;const{maxFileSize:s}=n.config;s&&r[t].size>s&&(o=n.lang.fileSizeExceed.replace("%%",cn(r[t].size)).replace("%%",cn(s))),e("ADD_FILE",{_File:r[t],name:r[t].name,comment:"",progress:{percentage:0,humanSize:0,bytesUploaded:0},uploaded:!1,error:o,humanSize:cn(r[t].size),_retryDelay:500,_retries:0})}},removeFile({commit:e,state:t},n){e("REMOVE_FILE",n)},newSession({commit:e}){e("NEW_SESSION")},upload({commit:e,dispatch:t,state:n,rootState:r}){e("STATE","uploading",{root:!0}),e("ERROR","",{root:!0}),null===un&&(un=function(){dn=!1,e("ERROR",!1,{root:!0}),t("upload")}),dn&&window.removeEventListener("online",un),n.files.forEach((async t=>{t.error="",t._retries=0,t._retryDelay=500;const o=t._File,s=()=>{new $t(o,{uploadUrl:t._uploadUrl,metadata:{sid:n.sid,retention:n.retention,password:n.password,name:t.name,comment:t.comment,type:t._File.type},headers:{"x-passwd":r.config.uploadPass},parallelUploads:1,chunkSize:5e6,endpoint:n.uploadURI,storeFingerprintForResuming:!1,retryDelays:null,onAfterResponse:function(e,n){if("POST"===e.getMethod()&&e.getURL()===this.endpoint&&201===n.getStatus()){t._uploadUrl=n.getHeader("location");const e=n.getHeader("location").split("++");e.length>1&&(t._key=e[1])}},onError(r){let o=null;try{o=JSON.parse(r.originalResponse.getBody()).message}catch(e){}if(navigator.onLine)if(r&&r.originalResponse&&r.originalResponse._xhr&&r.originalResponse._xhr.status>=400&&r.originalResponse._xhr.status<500)e("UPDATE_FILE",{file:t,data:{error:o||r.message||r.toString()}});else{if(t._retries>30)return e("UPDATE_FILE",{file:t,data:{error:o||r.message||r.toString()}}),void(n.files.every((e=>e.error))&&(e("STATE","uploadError",{root:!0}),e("ERROR","Upload failed.",{root:!0})));t._retryDelay=Math.min(1.7*t._retryDelay,1e4),t._retries++,console&&console.log(r.message||r.toString(),"; will retry in",t._retryDelay,"ms"),setTimeout(s,t._retryDelay)}else e("ERROR","You are offline. Your uploads will resume as soon as you are back online.",{root:!0}),dn||(dn=!0,window.addEventListener("online",un))},onProgress(n,r){if(n===r)return;t.error="",t._retries=0,t._retryDelay=500;const o=Math.round(n/r*1e4)/100;e("UPDATE_FILE",{file:t,data:{progress:{percentage:o,humanSize:cn(n),bytesUploaded:n}}})},onSuccess(){e("UPDATE_FILE",{file:t,data:{uploaded:!0,progress:{percentage:100,humanFileSize:t.humanSize,bytesUploaded:t._File.size}}}),r.rooms.currentRoom&&t._key&&e("rooms/ADD_ROOM_FILE",{roomId:r.rooms.currentRoom.id,file:{name:t.name,key:t._key,size:t._File.size,humanSize:t.humanSize,uploaded:!0,roomId:r.rooms.currentRoom.id,uploadedAt:Date.now()}},{root:!0}),n.files.every((e=>e.uploaded))&&(fetch(n.uploadURI+"/"+n.sid+"?lock=yes",{method:"PATCH"}),e("STATE","uploaded",{root:!0}))}}).start()};s()}))}}},fn={name:"Files",components:{FileIcon:en},computed:{...Pe("upload",["files"]),...Pe(["state"]),...Ie("upload",["bucketSize","bucketSizeError"]),...Ie(["disabled"])},mounted(){this.dragDropCleanup=Kt()("body",(e=>this.$store.dispatch("upload/addFiles",e)))},watch:{state:function(e){"uploading"===e&&this.dragDropCleanup()}},methods:{humanFileSize:cn,triggerFileInput(){if(this.disabled)return;const e=document.getElementById("fileInput");e&&e.click()}}};const hn=(0,Gt.A)(fn,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"upload-files"},[t("div",{staticClass:"panel panel-default",class:{"panel-primary":!e.disabled}},[t("div",{staticClass:"panel-heading"},[t("span",{directives:[{name:"show",rawName:"v-show",value:e.bucketSize>0,expression:"bucketSize > 0"}],staticClass:"pull-right"},[e._v(e._s(e.humanFileSize(e.bucketSize)))]),t("strong",[e._v(e._s(e.$root.lang.files))])]),t("div",{staticClass:"panel-body"},[t("div",{directives:[{name:"show",rawName:"v-show",value:0===e.files.length,expression:"files.length === 0"}],staticClass:"empty-files-big-plus",style:{cursor:e.disabled?"default":"pointer"},attrs:{tabindex:"0",role:"button"},on:{click:function(t){return e.triggerFileInput()},keydown:[function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:(t.preventDefault(),e.triggerFileInput())},function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"space",32,t.key,[" ","Spacebar"])?null:(t.preventDefault(),e.triggerFileInput())}]}},[t("a",[t("icon",{attrs:{name:"plus",scale:"4"}}),t("br"),e._v(" "+e._s(e.$root.lang.dropFilesHere))],1)]),t("table",{staticClass:"table table-striped"},[t("tbody",e._l(e.files,(function(n){return t("tr",[t("td",{staticClass:"file-icon"},[t("file-icon",{attrs:{file:n._File}})],1),t("td",[t("p",[t("strong",[e._v(" "+e._s(n.name))]),t("small",[e._v(" ("+e._s(n.humanSize)+")")])]),t("p",[t("input",{directives:[{name:"model",rawName:"v-model",value:n.comment,expression:"file.comment"}],staticClass:"form-control input-sm",attrs:{type:"text",placeholder:e.$root.lang.comment,disabled:e.disabled},domProps:{value:n.comment},on:{input:function(t){t.target.composing||e.$set(n,"comment",t.target.value)}}})]),n.error?t("div",{staticClass:"alert alert-danger"},[t("icon",{staticClass:"fa-fw",attrs:{name:"exclamation-triangle"}}),e._v(" "+e._s(n.error))],1):e._e(),t("div",{directives:[{name:"show",rawName:"v-show",value:!n.error&&("uploading"===e.state||"uploaded"===e.state),expression:"!file.error && (state === 'uploading' || state === 'uploaded')"}],staticClass:"progress"},[t("div",{staticClass:"progress-bar progress-bar-success progress-bar-striped",class:{active:!n.uploaded},style:{width:n.progress.percentage+"%"}})])]),t("td",{staticClass:"btns"},[t("a",{directives:[{name:"show",rawName:"v-show",value:!e.disabled||e.bucketSizeError,expression:"!disabled || bucketSizeError"}],staticStyle:{cursor:"pointer"},attrs:{tabindex:"0",role:"button"},on:{click:function(t){return e.$store.dispatch("upload/removeFile",n)},keydown:[function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:(t.preventDefault(),e.$store.dispatch("upload/removeFile",n))},function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"space",32,t.key,[" ","Spacebar"])?null:(t.preventDefault(),e.$store.dispatch("upload/removeFile",n))}]}},[t("icon",{attrs:{name:"times"}})],1)])])})),0)]),t("input",{staticStyle:{display:"none"},attrs:{id:"fileInput",type:"file",multiple:"",disabled:e.disabled},on:{change:function(t){return e.$store.dispatch("upload/addFiles",t.target.files)}}}),t("div",{staticClass:"text-right"},[t("a",{directives:[{name:"show",rawName:"v-show",value:e.files.length>0,expression:"files.length>0"}],staticClass:"btn btn-success btn-sm",attrs:{disabled:e.disabled,tabindex:"0",role:"button"},on:{click:function(t){return e.triggerFileInput()},keydown:[function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:(t.preventDefault(),e.triggerFileInput())},function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"space",32,t.key,[" ","Spacebar"])?null:(t.preventDefault(),e.triggerFileInput())}]}},[t("icon",{attrs:{name:"plus-circle"}})],1)])])])])}),[],!1,null,null,null).exports,mn={props:{hasHeader:{type:Boolean,default:!1},hasFooter:{type:Boolean,default:!1}},mounted(){this.$nextTick((function(){this.$refs.modal.focus()}))},methods:{close(){this.$emit("close")}}},wn=(0,Gt.A)(mn,(function(){var e=this,t=e._self._c;return t("div",{ref:"modal",staticClass:"modal fade in background-darken",staticStyle:{display:"block"},attrs:{tabindex:"-1",role:"dialog"},on:{click:function(t){return t.target!==t.currentTarget?null:e.close()},keyup:[function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"esc",27,t.key,["Esc","Escape"])?null:e.close()},function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"left",37,t.key,["Left","ArrowLeft"])||"button"in t&&0!==t.button?null:e.$emit("prev")},function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"right",39,t.key,["Right","ArrowRight"])||"button"in t&&2!==t.button?null:e.$emit("next")}]}},[t("div",{staticClass:"modal-dialog modal-fluid",attrs:{role:"document"}},[t("div",{staticClass:"modal-content"},[e.hasHeader?t("div",{staticClass:"modal-header"},[t("button",{staticClass:"close",attrs:{type:"button","data-dismiss":"modal","aria-label":"Close"},on:{click:function(t){return e.close()}}},[t("span",{attrs:{"aria-hidden":"true"}},[e._v("×")])]),t("h4",{staticClass:"modal-title"},[e._t("header",(function(){return[e._v(" Modal")]}))],2)]):e._e(),t("div",{staticClass:"modal-body"},[e._t("body",(function(){return[e._v(" Body")]}))],2),e.hasFooter?t("div",{staticClass:"modal-footer"},[e._t("footer")],2):e._e()])])])}),[],!1,null,null,null).exports;Yt.A.register({"info-circle":{width:512,height:512,paths:[{d:"M256 8c137 0 248 111.1 248 248 0 137-111 248-248 248s-248-111-248-248c0-136.9 111-248 248-248zM256 118c-23.2 0-42 18.8-42 42s18.8 42 42 42 42-18.8 42-42-18.8-42-42-42zM312 372v-24c0-6.6-5.4-12-12-12h-12v-100c0-6.6-5.4-12-12-12h-64c-6.6 0-12 5.4-12 12v24c0 6.6 5.4 12 12 12h12v64h-12c-6.6 0-12 5.4-12 12v24c0 6.6 5.4 12 12 12h88c6.6 0 12-5.4 12-12z"}]}}),Yt.A.register({spinner:{width:512,height:512,paths:[{d:"M304 48c0 26.5-21.5 48-48 48s-48-21.5-48-48 21.5-48 48-48 48 21.5 48 48zM256 416c26.5 0 48 21.5 48 48s-21.5 48-48 48-48-21.5-48-48 21.5-48 48-48zM464 208c26.5 0 48 21.5 48 48s-21.5 48-48 48-48-21.5-48-48 21.5-48 48-48zM96 256c0 26.5-21.5 48-48 48s-48-21.5-48-48 21.5-48 48-48 48 21.5 48 48zM108.9 355.1c26.5 0 48 21.5 48 48 0 26.5-21.5 48-48 48s-48-21.5-48-48 21.5-48 48-48zM403.1 355.1c26.5 0 48 21.5 48 48 0 26.5-21.5 48-48 48s-48-21.5-48-48 21.5-48 48-48zM108.9 60.9c26.5 0 48 21.5 48 48s-21.5 48-48 48-48-21.5-48-48 21.5-48 48-48z"}]}}),Yt.A.register({"check-circle":{width:512,height:512,paths:[{d:"M504 256c0 137-111 248-248 248s-248-111-248-248 111-248 248-248 248 111 248 248zM227.3 387.3l184-184c6.2-6.2 6.2-16.4 0-22.6l-22.6-22.6c-6.2-6.2-16.4-6.2-22.6 0l-150.1 150.1-70.1-70.1c-6.2-6.2-16.4-6.2-22.6 0l-22.6 22.6c-6.2 6.2-6.2 16.4 0 22.6l104 104c6.2 6.2 16.4 6.2 22.6 0z"}]}});const gn={name:"RoomCreation",components:{Modal:wn},data:()=>({roomName:"",roomPassword:"",confirmPassword:"",error:"",creating:!1,roomCreated:!1,createdRoomId:""}),methods:{async createRoom(){if(this.error="",this.roomName.trim())if(this.roomPassword.length<4)this.error="Password must be at least 4 characters";else if(this.roomPassword===this.confirmPassword){this.creating=!0;try{const e=await this.$store.dispatch("rooms/createRoom",{name:this.roomName,password:this.roomPassword});this.roomCreated=!0,this.createdRoomId=e.id}catch(e){this.error=e.message}finally{this.creating=!1}}else this.error="Passwords do not match";else this.error="Please enter a room name"}}};n(775);const vn=(0,Gt.A)(gn,(function(){var e=this,t=e._self._c;return t("modal",{attrs:{"has-header":!0},on:{close:function(t){return e.$emit("close")}}},[t("div",{attrs:{slot:"header"},slot:"header"},[t("h4",[e._v("Create Private Room")])]),t("div",{attrs:{slot:"body"},slot:"body"},[e.roomCreated?t("div",{staticClass:"alert alert-success"},[t("icon",{staticClass:"fa-fw",attrs:{name:"check-circle"}}),t("strong",[e._v(" Room Created Successfully!")]),t("p",{staticStyle:{margin:"10px 0 5px 0"}},[t("strong",[e._v("Room ID:")]),t("code",{staticStyle:{background:"#fff",padding:"2px 8px","border-radius":"3px","font-size":"14px","user-select":"all"}},[e._v(e._s(e.createdRoomId))])]),t("p",{staticStyle:{margin:"5px 0"}},[t("strong",[e._v("Password:")]),t("code",{staticStyle:{background:"#fff",padding:"2px 8px","border-radius":"3px","font-size":"14px"}},[e._v(e._s(e.roomPassword))])]),t("p",{staticStyle:{"margin-top":"10px","font-size":"13px",color:"#666"}},[t("icon",{staticClass:"fa-fw",attrs:{name:"info-circle"}}),e._v(" Share this Room ID and password with your team members so they can join.")],1),t("div",{staticClass:"text-right",staticStyle:{"margin-top":"15px"}},[t("button",{staticClass:"btn btn-primary",attrs:{type:"button"},on:{click:function(t){return e.$emit("close")}}},[t("icon",{staticClass:"fa-fw",attrs:{name:"check"}}),e._v(" Done")],1)])],1):e._e(),e.roomCreated?e._e():t("div",{staticClass:"alert alert-info"},[t("icon",{staticClass:"fa-fw",attrs:{name:"info-circle"}}),e._v(" Create a private room to share files with specific people. Share the room ID and password with your team.")],1),e.error&&!e.roomCreated?t("div",{staticClass:"alert alert-danger"},[t("icon",{staticClass:"fa-fw",attrs:{name:"exclamation-triangle"}}),e._v(" "+e._s(e.error))],1):e._e(),e.roomCreated?e._e():t("form",{on:{submit:function(t){return t.preventDefault(),e.createRoom.apply(null,arguments)}}},[t("div",{staticClass:"form-group"},[t("label",{attrs:{for:"roomName"}},[e._v("Room Name")]),t("input",{directives:[{name:"model",rawName:"v-model",value:e.roomName,expression:"roomName"}],staticClass:"form-control",attrs:{id:"roomName",type:"text",placeholder:"Enter room name",required:"",autofocus:""},domProps:{value:e.roomName},on:{input:function(t){t.target.composing||(e.roomName=t.target.value)}}})]),t("div",{staticClass:"form-group"},[t("label",{attrs:{for:"roomPassword"}},[e._v("Room Password")]),t("input",{directives:[{name:"model",rawName:"v-model",value:e.roomPassword,expression:"roomPassword"}],staticClass:"form-control",attrs:{id:"roomPassword",type:"password",placeholder:"Create a password",required:""},domProps:{value:e.roomPassword},on:{input:function(t){t.target.composing||(e.roomPassword=t.target.value)}}})]),t("div",{staticClass:"form-group"},[t("label",{attrs:{for:"confirmPassword"}},[e._v("Confirm Password")]),t("input",{directives:[{name:"model",rawName:"v-model",value:e.confirmPassword,expression:"confirmPassword"}],staticClass:"form-control",attrs:{id:"confirmPassword",type:"password",placeholder:"Confirm password",required:""},domProps:{value:e.confirmPassword},on:{input:function(t){t.target.composing||(e.confirmPassword=t.target.value)}}})]),t("div",{staticClass:"text-right"},[t("button",{staticClass:"btn btn-default",staticStyle:{"margin-right":"10px"},attrs:{type:"button"},on:{click:function(t){return e.$emit("close")}}},[e._v("Cancel")]),t("button",{staticClass:"btn btn-primary",attrs:{type:"submit",disabled:e.creating}},[e.creating?t("icon",{staticClass:"fa-fw",attrs:{name:"spinner",spin:""}}):t("icon",{staticClass:"fa-fw",attrs:{name:"plus"}}),e._v(" Create Room")],1)])])])])}),[],!1,null,"11d25acc",null).exports;n(254);const bn={name:"RoomJoin",components:{Modal:wn},data:()=>({roomId:"",password:"",error:"",joining:!1}),methods:{async joinRoom(){if(this.error="",this.roomId.trim())if(this.password){this.joining=!0;try{await this.$store.dispatch("rooms/joinRoom",{id:this.roomId,password:this.password}),this.$emit("close")}catch(e){this.error=e.message}finally{this.joining=!1}}else this.error="Please enter the room password";else this.error="Please enter a room ID"}}},yn=(0,Gt.A)(bn,(function(){var e=this,t=e._self._c;return t("modal",{attrs:{"has-header":!0},on:{close:function(t){return e.$emit("close")}}},[t("div",{attrs:{slot:"header"},slot:"header"},[t("h4",[e._v("Join Private Room")])]),t("div",{attrs:{slot:"body"},slot:"body"},[t("div",{staticClass:"alert alert-info"},[t("icon",{staticClass:"fa-fw",attrs:{name:"info-circle"}}),e._v(" Enter the room ID and password shared with you to join a private room.")],1),e.error?t("div",{staticClass:"alert alert-danger"},[t("icon",{staticClass:"fa-fw",attrs:{name:"exclamation-triangle"}}),e._v(" "+e._s(e.error))],1):e._e(),t("form",{on:{submit:function(t){return t.preventDefault(),e.joinRoom.apply(null,arguments)}}},[t("div",{staticClass:"form-group"},[t("label",{attrs:{for:"roomId"}},[e._v("Room ID")]),t("input",{directives:[{name:"model",rawName:"v-model",value:e.roomId,expression:"roomId"}],staticClass:"form-control",attrs:{id:"roomId",type:"text",placeholder:"Enter room ID",required:"",autofocus:""},domProps:{value:e.roomId},on:{input:function(t){t.target.composing||(e.roomId=t.target.value)}}})]),t("div",{staticClass:"form-group"},[t("label",{attrs:{for:"password"}},[e._v("Room Password")]),t("input",{directives:[{name:"model",rawName:"v-model",value:e.password,expression:"password"}],staticClass:"form-control",attrs:{id:"password",type:"password",placeholder:"Enter room password",required:""},domProps:{value:e.password},on:{input:function(t){t.target.composing||(e.password=t.target.value)}}})]),t("div",{staticClass:"text-right"},[t("button",{staticClass:"btn btn-default",staticStyle:{"margin-right":"10px"},attrs:{type:"button"},on:{click:function(t){return e.$emit("close")}}},[e._v("Cancel")]),t("button",{staticClass:"btn btn-primary",attrs:{type:"submit",disabled:e.joining}},[e.joining?t("icon",{staticClass:"fa-fw",attrs:{name:"spinner",spin:""}}):t("icon",{staticClass:"fa-fw",attrs:{name:"sign-in-alt"}}),e._v(" Join Room")],1)])])])])}),[],!1,null,null,null).exports;n(548),Yt.A.register({upload:{width:512,height:512,paths:[{d:"M296 384h-80c-13.3 0-24-10.7-24-24v-168h-87.7c-17.8 0-26.7-21.5-14.1-34.1l152.1-152.2c7.5-7.5 19.8-7.5 27.3 0l152.2 152.2c12.6 12.6 3.7 34.1-14.1 34.1h-87.7v168c0 13.3-10.7 24-24 24zM512 376v112c0 13.3-10.7 24-24 24h-464c-13.3 0-24-10.7-24-24v-112c0-13.3 10.7-24 24-24h136v8c0 30.9 25.1 56 56 56h80c30.9 0 56-25.1 56-56v-8h136c13.3 0 24 10.7 24 24zM388 464c0-11-9-20-20-20s-20 9-20 20 9 20 20 20 20-9 20-20zM452 464c0-11-9-20-20-20s-20 9-20 20 9 20 20 20 20-9 20-20z"}]}}),Yt.A.register({envelope:{width:512,height:512,paths:[{d:"M502.3 190.8c3.9-3.1 9.7-0.2 9.7 4.7v204.5c0 26.5-21.5 48-48 48h-416c-26.5 0-48-21.5-48-48v-204.4c0-5 5.7-7.8 9.7-4.7 22.4 17.4 52.1 39.5 154.1 113.6 21.1 15.4 56.7 47.8 92.2 47.6 35.7 0.3 72-32.8 92.3-47.6 102-74.1 131.6-96.3 154-113.7zM256 320c-23.2 0.4-56.6-29.2-73.4-41.4-132.7-96.3-142.8-104.8-173.4-128.7-5.8-4.6-9.2-11.5-9.2-18.9v-19c0-26.5 21.5-48 48-48h416c26.5 0 48 21.5 48 48v19c0 7.4-3.4 14.4-9.2 18.9-30.6 24-40.7 32.4-173.4 128.7-16.8 12.2-50.2 41.8-73.4 41.4z"}]}}),Yt.A.register({qrcode:{width:448,height:512,paths:[{d:"M0 224v-192h192v192h-192zM64 96v64h64v-64h-64zM256 32h192v192h-192v-192zM384 160v-64h-64v64h64zM0 480v-192h192v192h-192zM64 352v64h64v-64h-64zM416 288h32v128h-96v-32h-32v96h-64v-192h96v32h64v-32zM416 448h32v32h-32v-32zM352 448h32v32h-32v-32z"}]}}),Yt.A.register({users:{width:640,height:512,paths:[{d:"M96 224c-35.3 0-64-28.7-64-64s28.7-64 64-64 64 28.7 64 64-28.7 64-64 64zM544 224c-35.3 0-64-28.7-64-64s28.7-64 64-64 64 28.7 64 64-28.7 64-64 64zM576 256c35.3 0 64 28.7 64 64v32c0 17.7-14.3 32-32 32h-66c-6.2-47.4-34.8-87.3-75.1-109.4 11.6-11.5 27.5-18.6 45.1-18.6h64zM320 256c-61.9 0-112-50.1-112-112s50.1-112 112-112 112 50.1 112 112-50.1 112-112 112zM396.8 288c63.6 0 115.2 51.6 115.2 115.2v28.8c0 26.5-21.5 48-48 48h-288c-26.5 0-48-21.5-48-48v-28.8c0-63.6 51.6-115.2 115.2-115.2h8.3c20.9 10 43.9 16 68.5 16s47.7-6 68.5-16h8.3zM173.1 274.6c-40.3 22.1-68.9 62-75.2 109.4h-65.9c-17.7 0-32-14.3-32-32v-32c0-35.3 28.7-64 64-64h64c17.6 0 33.5 7.1 45.1 18.6z"}]}}),Yt.A.register({"sign-out-alt":{width:512,height:512,paths:[{d:"M497 273l-168 168c-15 15-41 4.5-41-17v-96h-136c-13.3 0-24-10.7-24-24v-96c0-13.3 10.7-24 24-24h136v-96c0-21.4 25.9-32 41-17l168 168c9.3 9.4 9.3 24.6 0 34zM192 436c0 6.6-5.4 12-12 12h-84c-53 0-96-43-96-96v-192c0-53 43-96 96-96h84c6.6 0 12 5.4 12 12v40c0 6.6-5.4 12-12 12h-84c-17.7 0-32 14.3-32 32v192c0 17.7 14.3 32 32 32h84c6.6 0 12 5.4 12 12v40z"}]}}),Yt.A.register({link:{width:512,height:512,paths:[{d:"M326.6 185.4c59.7 59.8 58.9 155.7 0.4 214.6-0.1 0.1-0.2 0.3-0.4 0.4l-67.2 67.2c-59.3 59.3-155.7 59.3-215 0-59.3-59.3-59.3-155.7 0-215l37.1-37.1c9.8-9.8 26.8-3.3 27.3 10.6 0.6 17.7 3.8 35.5 9.7 52.7 2 5.8 0.6 12.3-3.8 16.6l-13.1 13.1c-28 28-28.9 73.7-1.2 102 28 28.6 74.1 28.7 102.3 0.5l67.2-67.2c28.2-28.2 28.1-73.8 0-101.8-3.7-3.7-7.4-6.6-10.3-8.6-4.1-2.8-6.7-7.4-6.9-12.6-0.4-10.6 3.3-21.5 11.7-29.8l21.1-21.1c5.5-5.5 14.2-6.2 20.6-1.7 7.4 5.2 14.2 10.8 20.5 17.2zM467.5 44.4c59.3 59.3 59.3 155.7 0 215l-37.1 37.1c-9.8 9.8-26.8 3.3-27.3-10.6-0.6-17.7-3.8-35.5-9.7-52.7-2-5.8-0.6-12.3 3.8-16.6l13.1-13.1c28-28 28.9-73.7 1.2-102-28-28.6-74.1-28.7-102.3-0.5l-67.2 67.2c-28.2 28.2-28.1 73.8 0 101.8 3.7 3.7 7.4 6.6 10.3 8.6 4.1 2.8 6.7 7.4 6.9 12.6 0.4 10.6-3.3 21.5-11.7 29.8l-21.1 21.1c-5.5 5.5-14.2 6.2-20.6 1.7-7.4-5.2-14.2-10.8-20.5-17.2-59.7-59.8-58.9-155.7-0.4-214.6 0.1-0.1 0.2-0.3 0.4-0.4l67.2-67.2c59.3-59.3 155.7-59.3 215 0z"}]}}),Yt.A.register({"share-alt":{width:448,height:512,paths:[{d:"M352 320c53 0 96 43 96 96s-43 96-96 96-96-43-96-96c0 0 0 0 0 0 0-7.2 0.8-14.2 2.3-20.9l-102.5-64.1c-16.4 13.1-37.2 20.9-59.8 20.9-53 0-96-43-96-96s43-96 96-96c22.6 0 43.4 7.8 59.8 20.9l102.5-64.1c-1.5-6.7-2.3-13.7-2.3-20.8 0-53 43-96 96-96s96 43 96 96-43 96-96 96c-22.6 0-43.4-7.8-59.8-20.9l-102.5 64.1c1.5 6.7 2.3 13.6 2.3 20.8s-0.8 14.2-2.3 20.9l102.5 64.1c16.4-13.1 37.2-20.9 59.8-20.9z"}]}}),Yt.A.register({comments:{width:576,height:512,paths:[{d:"M416 192c0 88.4-93.1 160-208 160-41 0-79.1-9.3-111.3-25-21.8 12.7-52.1 25-88.7 25-3.2 0-6-1.8-7.3-4.8s-0.7-6.4 1.5-8.7c0.3-0.3 22.4-24.3 35.8-54.5-23.9-26.1-38-57.7-38-92 0-88.4 93.1-160 208-160s208 71.6 208 160zM538 412c13.4 30.3 35.5 54.2 35.8 54.5 2.2 2.4 2.8 5.8 1.5 8.7-1.2 2.9-4.1 4.8-7.3 4.8-36.6 0-66.9-12.3-88.7-25-32.2 15.8-70.3 25-111.3 25-86.2 0-160.2-40.4-191.7-97.9 10.4 1.1 20.9 1.9 31.7 1.9 132.3 0 240-86.1 240-192 0-6.8-0.4-13.5-1.3-20.1 75.8 23.9 129.3 81.2 129.3 148.1 0 34.3-14.1 66-38 92z"}]}}),Yt.A.register({file:{width:384,height:512,paths:[{d:"M224 136c0 13.2 10.8 24 24 24h136v328c0 13.3-10.7 24-24 24h-336c-13.3 0-24-10.7-24-24v-464c0-13.3 10.7-24 24-24h200v136zM384 121.9v6.1h-128v-128h6.1c6.4 0 12.5 2.5 17 7l97.9 98c4.5 4.5 7 10.6 7 16.9z"}]}}),n(595);const An={name:"Upload",components:{Settings:Vt,Files:hn,Clipboard:Jt,RoomCreation:vn,RoomJoin:yn},data:()=>({uploadPassword:"",uploadPasswordWrong:null,showRoomCreation:!1,showRoomJoin:!1,viewMode:"upload",roomUploadFiles:[],roomUploadMessage:"",roomUploading:!1,roomDownloadLimit:10,downloadStatsInterval:null}),computed:{...Pe(["state"]),...Pe("config",["uploadPassRequired","uploadPass","requireBucketPassword","disableQrCode"]),...Pe("upload",["sid","files","password"]),...Ie(["error","disabled"]),...Ie("upload",["percentUploaded","shareUrl","bucketSize","bytesUploaded"]),mailLnk:function(){return this.$store.state.config&&this.$store.state.config.mailTemplate&&this.$store.state.config.mailTemplate.replace("%%URL%%",this.shareUrl)},showLogin(){return this.uploadPassRequired&&!1!==this.uploadPasswordWrong},showUploadBtn(){return this.files.length&&!this.disabled&&(this.requireBucketPassword&&this.password||!this.requireBucketPassword)},roomMessages(){return this.$store.state.rooms.currentRoom&&this.$store.state.rooms.currentRoom.messages||[]}},watch:{state:function(e){if("uploaded"===e||"uploadError"===e){const e=document.getElementById("uploadApp");if(!e||!e.scrollIntoView)return;e.scrollIntoView(!0)}},roomMessages:{handler(){this.$nextTick((()=>{this.scrollMessagesToBottom()}))},deep:!0}},async mounted(){await this.$store.dispatch("rooms/initializeFromStorage"),this.startDownloadStatsRefresh()},beforeDestroy(){this.downloadStatsInterval&&clearInterval(this.downloadStatsInterval)},methods:{newSession(){confirm(this.$root.lang.createNewUploadSession)&&document.location.reload()},async setUploadPass(){try{this.$store.commit("config/SET",{uploadPass:this.uploadPassword}),await this.$store.dispatch("config/fetch"),this.uploadPasswordWrong=!1}catch(e){"PWDREQ"===e.code?(this.uploadPassword="",this.uploadPasswordWrong=!0):console.error(e)}},showQrCode(){const e=new ue({level:"H"}).encode(new de(this.shareUrl)).toDataURL(7,10),t=e.substr(e.indexOf(",")+1),n=atob(t),r=new Array(n.length);for(let e=0;e<n.length;e++)r[e]=n.charCodeAt(e);const o=new Uint8Array(r),s=new Blob([o],{type:"image/gif;base64"});window.open(URL.createObjectURL(s))},humanFileSize:cn,leaveRoom(){confirm("Are you sure you want to leave this room?")&&this.$store.dispatch("rooms/leaveRoom")},copyRoomId(){const e=this.$store.state.rooms.currentRoom.id;navigator.clipboard&&navigator.clipboard.writeText?navigator.clipboard.writeText(e).then((()=>{alert("Room ID copied to clipboard!")})).catch((()=>{this.fallbackCopyRoomId(e)})):this.fallbackCopyRoomId(e)},fallbackCopyRoomId(e){const t=document.createElement("textarea");t.value=e,t.style.position="fixed",t.style.left="-999999px",document.body.appendChild(t),t.select();try{document.execCommand("copy"),alert("Room ID copied to clipboard!")}catch(t){alert("Failed to copy. Room ID: "+e)}document.body.removeChild(t)},handleRoomFileSelect(e){this.roomUploadFiles=Array.from(e.target.files)},async uploadToRoom(){if(0!==this.roomUploadFiles.length){this.roomUploading=!0;try{const e=await this.uploadFilesAndGetLink(this.roomUploadFiles);await this.$store.dispatch("rooms/addMessage",{fileName:this.roomUploadFiles.map((e=>e.name)).join(", "),fileSize:cn(this.roomUploadFiles.reduce(((e,t)=>e+t.size),0)),fileLink:e.shareUrl,message:this.roomUploadMessage,userName:"You",isOwn:!0,downloadLimit:this.roomDownloadLimit,downloadCount:0}),this.roomUploadFiles=[],this.roomUploadMessage="",this.roomDownloadLimit=10,this.$refs.roomFileInput.value="",alert("File uploaded and shared with team!")}catch(e){console.error("Upload failed:",e),alert("Failed to upload file: "+e.message)}finally{this.roomUploading=!1}}},async uploadFilesAndGetLink(e){return new Promise(((t,n)=>{const r=Math.random().toString(36).substr(2,9),o=document.head.getElementsByTagName("base")[0].href+r,s=(window.PSITRANSFER_UPLOAD_PATH||"/")+"files";let i=0;const a=e.length;e.forEach((e=>{const l=new $t(e,{endpoint:s,metadata:{sid:r,retention:this.$store.state.config.defaultRetention||"2592000",password:"",name:e.name,comment:"",type:e.type,downloadLimit:this.roomDownloadLimit.toString(),downloadCount:"0"},headers:{"x-passwd":this.$store.state.config.uploadPass||""},chunkSize:5e6,onSuccess:()=>{i++,i===a&&(fetch(s+"/"+r+"?lock=yes",{method:"PATCH"}),t({shareUrl:o,sid:r}))},onError:e=>{n(e)}});l.start()}))}))},formatDate(e){const t=new Date(e),n=new Date-t;return n<6e4?"Just now":n<36e5?Math.floor(n/6e4)+" min ago":n<864e5?Math.floor(n/36e5)+" hours ago":t.toLocaleString()},scrollMessagesToBottom(){const e=this.$refs.messageArea;e&&(e.scrollTop=e.scrollHeight)},onRoomCreated(){this.viewMode="room"},async refreshDownloadStats(){if(!this.$store.getters["rooms/isInRoom"]||0===this.roomMessages.length)return;const e=document.head.getElementsByTagName("base")[0].href;for(const t of this.roomMessages)if(t.fileLink&&t.downloadLimit)try{const n=t.fileLink.split("/files/");if(n.length<2)continue;const r=n[1],o=await fetch(`${e}file-stats/${r}`);if(o.ok){const e=await o.json();t.downloadCount=e.downloadCount,await this.$store.dispatch("rooms/updateMessageStats",{messageId:t.id,downloadCount:e.downloadCount})}}catch(e){console.error("Failed to fetch download stats:",e)}},startDownloadStatsRefresh(){this.downloadStatsInterval=setInterval((()=>{"room"===this.viewMode&&this.$store.getters["rooms/isInRoom"]&&this.refreshDownloadStats()}),5e3)}}},_n=An;n(866);const Cn=(0,Gt.A)(_n,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"upload-app",attrs:{id:"uploadApp"}},[e.showLogin?e._e():t("div",{staticClass:"room-toggle"},[t("div",{staticClass:"btn-group btn-group-sm"},[t("button",{staticClass:"btn btn-default",class:{active:"upload"===e.viewMode},on:{click:function(t){e.viewMode="upload"}}},[t("icon",{attrs:{name:"cloud-upload-alt"}}),e._v(" Upload Files")],1),t("button",{staticClass:"btn btn-info",class:{active:"room"===e.viewMode},on:{click:function(t){e.viewMode="room"}}},[t("icon",{attrs:{name:"comments"}}),e._v(" Team Room")],1)])]),"upload"===e.viewMode?t("div",[e.showLogin?e._e():t("a",{staticClass:"btn btn-sm btn-info btn-new-session",attrs:{title:e.$root.lang.newUpload,tabindex:"-1",role:"button"},on:{click:function(t){return e.newSession()},keydown:[function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:(t.preventDefault(),e.newSession())},function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"space",32,t.key,[" ","Spacebar"])?null:(t.preventDefault(),e.newSession())}]}},[t("icon",{staticClass:"fa-fw",attrs:{name:"cloud-upload-alt"}}),t("span",{staticClass:"hidden-xs"},[e._v(" "+e._s(e.$root.lang.newUpload))])],1),t("div",{directives:[{name:"show",rawName:"v-show",value:e.error,expression:"error"}],staticClass:"alert alert-danger"},[t("strong",[t("icon",{staticClass:"fa-fw",attrs:{name:"exclamation-triangle"}}),e._v(" "+e._s(e.error))],1)]),e.showLogin?t("form",{staticClass:"well upload-uploadPassword",on:{submit:function(t){return t.preventDefault(),e.setUploadPass()}}},[t("h3",[e._v(e._s(e.$root.lang.uploadPassword))]),t("div",{staticClass:"form-group"},[t("input",{directives:[{name:"model",rawName:"v-model",value:e.uploadPassword,expression:"uploadPassword"}],staticClass:"form-control",attrs:{type:"password",autofocus:""},domProps:{value:e.uploadPassword},on:{input:function(t){t.target.composing||(e.uploadPassword=t.target.value)}}})]),t("p",{directives:[{name:"show",rawName:"v-show",value:e.uploadPasswordWrong,expression:"uploadPasswordWrong"}],staticClass:"text-danger"},[t("strong",[e._v(e._s(e.$root.lang.accessDenied))])]),t("button",{staticClass:"uploadPass btn btn-primary",attrs:{disabled:e.uploadPassword.length<1,type:"submit"}},[t("icon",{staticClass:"fa-fw",attrs:{name:"key"}}),e._v(" "+e._s(e.$root.lang.login))],1)]):e.$root.configFetched?t("div",[t("div",{directives:[{name:"show",rawName:"v-show",value:"uploaded"===e.state,expression:"state === 'uploaded'"}],staticClass:"well"},[t("div",{staticClass:"pull-right btn-group upload-success-btns"},[e.disableQrCode?e._e():t("a",{staticClass:"btn btn-primary",attrs:{href:"#",title:e.$root.lang.showQrCode,tabindex:"0",role:"button"},on:{click:function(t){return t.preventDefault(),e.showQrCode.apply(null,arguments)},keydown:[function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:(t.preventDefault(),e.showQrCode.apply(null,arguments))},function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"space",32,t.key,[" ","Spacebar"])?null:(t.preventDefault(),e.showQrCode.apply(null,arguments))}]}},[t("icon",{staticClass:"fa-fw",attrs:{name:"qrcode"}}),e._v("QR-Code")],1),t("a",{staticClass:"btn btn-primary",attrs:{href:e.mailLnk,title:e.$root.lang.sendViaMail,tabindex:"0"}},[t("icon",{staticClass:"fa-fw",attrs:{name:"envelope"}}),e._v(" "+e._s(e.$root.lang.email))],1),t("clipboard",{staticClass:"btn btn-primary",attrs:{value:e.shareUrl,title:e.$root.lang.copyToClipboard,tabindex:"0"}})],1),t("h3",{staticClass:"text-success"},[t("icon",{staticClass:"fa-fw",attrs:{name:"check"}}),e._v(" "+e._s(e.$root.lang.uploadCompleted))],1),t("div",{staticClass:"share-link"},[t("span",{staticClass:"title"},[e._v(e._s(e.$root.lang.downloadLink)+":")]),t("a",{attrs:{href:e.shareUrl}},[e._v(e._s(e.shareUrl))])])]),t("div",{directives:[{name:"show",rawName:"v-show",value:"uploading"===e.state,expression:"state === 'uploading'"}],staticClass:"row overall-process"},[t("div",{staticClass:"col-xs-12"},[t("icon",{staticClass:"pull-left",staticStyle:{"margin-right":"10px"},attrs:{name:"spinner",scale:"2",spin:""}}),t("div",{staticClass:"progress"},[t("div",{staticClass:"progress-bar progress-bar-success progress-bar-striped active",style:{width:e.percentUploaded+"%"}},[t("span",{directives:[{name:"show",rawName:"v-show",value:e.percentUploaded>8,expression:"percentUploaded>8"}]},[e._v(e._s(e.percentUploaded)+"%")]),t("span",{directives:[{name:"show",rawName:"v-show",value:e.percentUploaded>15,expression:"percentUploaded>15"}],staticStyle:{"margin-left":"10px"}},[e._v("("+e._s(e.humanFileSize(e.bytesUploaded))+" / "+e._s(e.humanFileSize(e.bucketSize))+")")])])])],1)]),t("div",{staticClass:"row"},[t("div",{staticClass:"col-sm-7"},[t("files")],1),t("div",{staticClass:"col-sm-5"},[t("settings"),t("div",{directives:[{name:"show",rawName:"v-show",value:e.showUploadBtn,expression:"showUploadBtn"}],staticClass:"text-right"},[t("button",{staticClass:"btn btn-lg btn-success",attrs:{id:"uploadBtn"},on:{click:function(t){return e.$store.dispatch("upload/upload")}}},[t("icon",{staticClass:"fa-fw",attrs:{name:"upload"}}),e._v(" "+e._s(e.$root.lang.upload))],1)]),t("div",{directives:[{name:"show",rawName:"v-show",value:"uploadError"===e.state,expression:"state === 'uploadError'"}],staticClass:"text-right"},[t("button",{staticClass:"btn btn-lg btn-success",attrs:{id:"uploadRetryBtn"},on:{click:function(t){return e.$store.dispatch("upload/upload")}}},[t("icon",{staticClass:"fa-fw",attrs:{name:"upload"}}),e._v(" "+e._s(e.$root.lang.retry))],1)])],1)])]):e._e()]):e._e(),"room"===e.viewMode?t("div",[e.$store.getters["rooms/isInRoom"]?e._e():t("div",{staticClass:"room-lobby"},[t("div",{staticClass:"well text-center"},[t("h3",[t("icon",{attrs:{name:"comments"}}),e._v(" Team Room")],1),t("p",[e._v("Share file links with your team in a private room")]),t("div",{staticClass:"row"},[t("div",{staticClass:"col-sm-6"},[t("div",{staticClass:"panel panel-primary"},[e._m(0),t("div",{staticClass:"panel-body"},[t("button",{staticClass:"btn btn-primary btn-block",on:{click:function(t){e.showRoomCreation=!0}}},[t("icon",{attrs:{name:"plus"}}),e._v(" Create Room")],1)])])]),t("div",{staticClass:"col-sm-6"},[t("div",{staticClass:"panel panel-info"},[e._m(1),t("div",{staticClass:"panel-body"},[t("button",{staticClass:"btn btn-info btn-block",on:{click:function(t){e.showRoomJoin=!0}}},[t("icon",{attrs:{name:"sign-in-alt"}}),e._v(" Join Room")],1)])])])])])]),e.$store.getters["rooms/isInRoom"]?t("div",{staticClass:"room-chat"},[t("div",{staticClass:"panel panel-info"},[t("div",{staticClass:"panel-heading"},[t("div",{staticClass:"pull-right"},[t("button",{staticClass:"btn btn-xs btn-warning",on:{click:e.leaveRoom}},[t("icon",{attrs:{name:"sign-out-alt"}}),e._v(" Leave Room")],1)]),t("h4",{staticStyle:{margin:"5px 0"}},[t("icon",{attrs:{name:"users"}}),e._v(" "+e._s(e.$store.state.rooms.currentRoom.name))],1)]),t("div",{staticClass:"panel-body"},[t("div",{staticClass:"room-info"},[t("div",{staticClass:"row"},[t("div",{staticClass:"col-sm-6"},[t("p",{staticStyle:{margin:"5px 0"}},[t("strong",[e._v("Room ID:")]),t("code",{staticClass:"room-code"},[e._v(e._s(e.$store.state.rooms.currentRoom.id))]),t("button",{staticClass:"btn btn-xs btn-default",staticStyle:{"margin-left":"5px"},on:{click:e.copyRoomId}},[t("icon",{attrs:{name:"copy"}})],1)])]),t("div",{staticClass:"col-sm-6"},[t("p",{staticStyle:{margin:"5px 0"}},[t("strong",[e._v("Password:")]),t("code",{staticClass:"room-code"},[e._v(e._s(e.$store.state.rooms.currentRoom.password))])])])])])])]),t("div",{staticClass:"room-messages-container"},[t("div",{staticClass:"panel panel-default"},[t("div",{staticClass:"panel-heading"},[t("strong",[t("icon",{attrs:{name:"comments"}}),e._v(" Shared Files")],1)]),t("div",{ref:"messageArea",staticClass:"panel-body room-messages",staticStyle:{height:"400px","overflow-y":"auto",background:"#f9f9f9"}},[0===e.roomMessages.length?t("div",{staticClass:"alert alert-info text-center"},[t("icon",{attrs:{name:"info-circle"}}),e._v(" No files shared yet. Upload a file below to share with your team.")],1):e._e(),e._l(e.roomMessages,(function(n){return t("div",{key:n.id,staticClass:"message-item",class:{own:n.isOwn}},[t("div",{staticClass:"message-header"},[t("strong",[e._v(e._s(n.userName))]),t("small",{staticClass:"text-muted"},[e._v(" "+e._s(e.formatDate(n.timestamp)))])]),t("div",{staticClass:"message-content"},[t("div",{staticClass:"file-share-box"},[t("icon",{staticClass:"file-icon",attrs:{name:"file",scale:"1.5"}}),t("div",{staticClass:"file-info"},[t("p",{staticClass:"file-name"},[t("strong",[e._v(e._s(n.fileName))]),n.fileSize?t("span",{staticClass:"text-muted"},[e._v(" ("+e._s(n.fileSize)+")")]):e._e()]),n.message?t("p",{staticClass:"file-message"},[e._v(e._s(n.message))]):e._e(),n.downloadLimit?t("p",{staticClass:"download-limit"},[t("small",{staticClass:"text-muted"},[t("icon",{attrs:{name:"download"}}),e._v(" Downloads: "+e._s(n.downloadCount||0)+" / "+e._s(n.downloadLimit)),n.downloadCount>=n.downloadLimit?t("span",{staticClass:"text-danger"},[e._v(" (Link Expired)")]):e._e()],1)]):e._e()]),t("div",{staticClass:"file-actions"},[t("a",{staticClass:"btn btn-sm btn-success",class:{disabled:n.downloadCount>=n.downloadLimit},attrs:{href:n.fileLink,target:"_blank",disabled:n.downloadCount>=n.downloadLimit}},[t("icon",{attrs:{name:"download"}}),e._v(" "+e._s(n.downloadCount>=n.downloadLimit?"Expired":"Download"))],1),n.downloadCount<n.downloadLimit?t("clipboard",{staticClass:"btn btn-sm btn-default",attrs:{value:n.fileLink,title:"Copy link"}},[t("icon",{attrs:{name:"copy"}})],1):e._e()],1)],1)])])}))],2)])]),t("div",{staticClass:"room-upload-section"},[t("div",{staticClass:"panel panel-success"},[t("div",{staticClass:"panel-heading"},[t("strong",[t("icon",{attrs:{name:"upload"}}),e._v(" Share a File with Team")],1)]),t("div",{staticClass:"panel-body"},[t("div",{staticClass:"alert alert-info",staticStyle:{"margin-bottom":"15px"}},[t("icon",{attrs:{name:"info-circle"}}),e._v(" Upload a file below. Once uploaded, the link will be automatically shared in the room.")],1),t("div",{staticClass:"row"},[t("div",{staticClass:"col-sm-8"},[t("div",{staticClass:"form-group"},[t("label",[e._v("Select File to Share")]),t("input",{ref:"roomFileInput",staticClass:"form-control",attrs:{type:"file",multiple:""},on:{change:e.handleRoomFileSelect}})]),e.roomUploadFiles.length>0?t("div",{staticClass:"form-group"},[t("label",[e._v("Add a message (optional)")]),t("input",{directives:[{name:"model",rawName:"v-model",value:e.roomUploadMessage,expression:"roomUploadMessage"}],staticClass:"form-control",attrs:{placeholder:"Enter a message about this file...",maxlength:"200"},domProps:{value:e.roomUploadMessage},on:{input:function(t){t.target.composing||(e.roomUploadMessage=t.target.value)}}})]):e._e(),e.roomUploadFiles.length>0?t("div",{staticClass:"form-group"},[t("label",[e._v("Download Limit")]),t("div",{staticClass:"input-group"},[t("input",{directives:[{name:"model",rawName:"v-model.number",value:e.roomDownloadLimit,expression:"roomDownloadLimit",modifiers:{number:!0}}],staticClass:"form-control",attrs:{type:"number",min:"1",max:"100",placeholder:"Max downloads"},domProps:{value:e.roomDownloadLimit},on:{input:function(t){t.target.composing||(e.roomDownloadLimit=e._n(t.target.value))},blur:function(t){return e.$forceUpdate()}}}),t("span",{staticClass:"input-group-addon"},[t("icon",{attrs:{name:"download"}})],1)]),t("small",{staticClass:"text-muted"},[e._v("Link will be destroyed after this many downloads")])]):e._e()]),t("div",{staticClass:"col-sm-4"},[t("label",[e._v(" ")]),t("button",{staticClass:"btn btn-success btn-block",staticStyle:{"margin-top":"25px"},attrs:{disabled:0===e.roomUploadFiles.length||e.roomUploading},on:{click:e.uploadToRoom}},[e.roomUploading?t("icon",{attrs:{name:"spinner",spin:""}}):t("icon",{attrs:{name:"upload"}}),e._v(" "+e._s(e.roomUploading?"Uploading...":"Upload & Share"))],1)])]),e.roomUploadFiles.length>0?t("div",{staticClass:"selected-files"},[e._m(2),t("ul",e._l(e.roomUploadFiles,(function(n,r){return t("li",{key:r},[e._v(e._s(n.name)+" ("+e._s(e.humanFileSize(n.size))+")")])})),0)]):e._e()])])])]):e._e()]):e._e(),e.showRoomCreation?t("RoomCreation",{on:{close:function(t){e.showRoomCreation=!1},created:e.onRoomCreated}}):e._e(),e.showRoomJoin?t("RoomJoin",{on:{close:function(t){e.showRoomJoin=!1}}}):e._e()],1)}),[function(){var e=this._self._c;return e("div",{staticClass:"panel-heading"},[e("strong",[this._v("Create New Room")])])},function(){var e=this._self._c;return e("div",{staticClass:"panel-heading"},[e("strong",[this._v("Join Existing Room")])])},function(){var e=this._self._c;return e("p",[e("strong",[this._v("Selected Files:")])])}],!1,null,null,null).exports,xn={namespaced:!0,state:{uploadPassRequired:!1,uploadPass:null},mutations:{SET(e,t){for(let n in t)o().set(e,n,t[n])}},actions:{fetch:({commit:e,state:t})=>new Promise(((n,r)=>{const o=new XMLHttpRequest;o.open("GET","config.json"),t.uploadPass&&o.setRequestHeader("x-passwd",t.uploadPass),o.onload=()=>{if(200===o.status)try{const t=JSON.parse(o.responseText);e("SET",t),e("upload/RETENTION",t.defaultRetention,{root:!0})}catch(t){e("ERROR",`Config parse Error: ${t.message}`,{root:!0})}else if(401===o.status||403===o.status){e("SET",{uploadPassRequired:!0,uploadPass:null});const t=new Error("Password required");t.code="PWDREQ",r(t)}else e("ERROR",`Config load error: ${o.status} ${o.statusText}`,{root:!0});n()},o.send()}))}},Sn={namespaced:!0,state:{currentRoom:null,rooms:{},userName:"Member"},getters:{isInRoom:e=>!!e.currentRoom,currentRoomName:e=>e.currentRoom?e.currentRoom.name:"",currentRoomId:e=>e.currentRoom?e.currentRoom.id:"",currentRoomPassword:e=>e.currentRoom?e.currentRoom.password:""},mutations:{SET_CURRENT_ROOM(e,t){e.currentRoom=t,t?localStorage.setItem("currentRoom",JSON.stringify(t)):localStorage.removeItem("currentRoom")},ADD_ROOM(e,t){e.rooms[t.id]=t,localStorage.setItem("rooms",JSON.stringify(e.rooms))},REMOVE_ROOM(e,t){delete e.rooms[t],localStorage.setItem("rooms",JSON.stringify(e.rooms))},LOAD_FROM_STORAGE(e){const t=localStorage.getItem("currentRoom");if(t)try{e.currentRoom=JSON.parse(t)}catch(e){console.error("Failed to load current room from localStorage",e)}const n=localStorage.getItem("rooms");if(n)try{e.rooms=JSON.parse(n)}catch(e){console.error("Failed to load rooms from localStorage",e)}}},actions:{initializeFromStorage({commit:e}){e("LOAD_FROM_STORAGE")},async createRoom({commit:e,rootState:t,dispatch:n},{name:r,password:o}){const s=Math.random().toString(36).substr(2,9).toUpperCase(),i={id:s,name:r,password:o,created:Date.now(),messages:[]};return e("ADD_ROOM",i),e("SET_CURRENT_ROOM",i),e("upload/SET_SID",s,{root:!0}),o&&e("upload/PASSWORD",o,{root:!0}),i},async joinRoom({commit:e,state:t},{id:n,password:r}){const o=t.rooms[n];if(o&&o.password===r)return e("SET_CURRENT_ROOM",o),e("upload/SET_SID",n,{root:!0}),r&&e("upload/PASSWORD",r,{root:!0}),o;const s={id:n,name:`Room ${n}`,password:r,joined:Date.now(),messages:[]};return e("ADD_ROOM",s),e("SET_CURRENT_ROOM",s),e("upload/SET_SID",n,{root:!0}),r&&e("upload/PASSWORD",r,{root:!0}),s},leaveRoom({commit:e,dispatch:t}){e("SET_CURRENT_ROOM",null),t("upload/newSession",null,{root:!0})},addMessage({commit:e,state:t},n){if(!t.currentRoom)return;const r={id:Date.now()+Math.random(),timestamp:Date.now(),...n};t.currentRoom.messages.push(r);const o=t.rooms[t.currentRoom.id];o&&(o.messages=t.currentRoom.messages,e("ADD_ROOM",o))},updateMessageStats({commit:e,state:t},{messageId:n,downloadCount:r}){if(!t.currentRoom)return;const o=t.currentRoom.messages.find((e=>e.id===n));if(o){o.downloadCount=r;const s=t.rooms[t.currentRoom.id];if(s){const t=s.messages.find((e=>e.id===n));t&&(t.downloadCount=r),e("ADD_ROOM",s)}}}}};o().use(je);const Rn=new je.Store({modules:{config:xn,upload:pn,rooms:Sn},state:{error:"",disabled:!1,state:"new",lang:{}},getters:{error:(e,t)=>e.error||t["upload/bucketSizeError"],disabled:(e,t)=>!!t.error||e.disabled},mutations:{ERROR(e,t){e.error=t,e.disabled=!0},DISABLE(e){e.disabled=!0},STATE(e,t){e.state=t,"new"!==t&&(e.disabled=!0)},LANG(e,t){e.lang=t}}});o().component("icon",Yt.A),new(o())({el:"#upload",store:Rn,data:{baseURI:document.head.getElementsByTagName("base")[0].href,lang:{},configFetched:!1},render:e=>e(Cn),async mounted(){try{const e=await fetch(this.baseURI+"lang.json");this.lang=await e.json(),this.$store.commit("LANG",this.lang)}catch(e){console.error("Failed to load translations",e)}try{await this.$store.dispatch("config/fetch"),this.configFetched=!0}catch(e){"PWDREQ"===e.code?(this.$store.commit("config/UPLOAD_PASS_REQUIRED",!0),this.configFetched=!0):(console.error(e),this.$store.commit("ERROR",e.message||e.toString()))}Kt()("body",(e=>{this.$store.state.disabled||this.$store.dispatch("upload/addFiles",e)}))}}),window.PSITRANSFER_VERSION="#467d9a7ce1"}},n={};function r(e){var o=n[e];if(void 0!==o)return o.exports;var s=n[e]={id:e,exports:{}};return t[e].call(s.exports,s,s.exports,r),s.exports}r.m=t,e=[],r.O=(t,n,o,s)=>{if(!n){var i=1/0;for(u=0;u<e.length;u++){for(var[n,o,s]=e[u],a=!0,l=0;l<n.length;l++)(!1&s||i>=s)&&Object.keys(r.O).every((e=>r.O[e](n[l])))?n.splice(l--,1):(a=!1,s<i&&(i=s));if(a){e.splice(u--,1);var c=o();void 0!==c&&(t=c)}}return t}s=s||0;for(var u=e.length;u>0&&e[u-1][2]>s;u--)e[u]=e[u-1];e[u]=[n,o,s]},r.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return r.d(t,{a:t}),t},r.d=(e,t)=>{for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.j=188,(()=>{var e={188:0};r.O.j=t=>0===e[t];var t=(t,n)=>{var o,s,[i,a,l]=n,c=0;if(i.some((t=>0!==e[t]))){for(o in a)r.o(a,o)&&(r.m[o]=a[o]);if(l)var u=l(r)}for(t&&t(n);c<i.length;c++)s=i[c],r.o(e,s)&&e[s]&&e[s][0](),e[s]=0;return r.O(u)},n=self.webpackChunkpsitransfer=self.webpackChunkpsitransfer||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})();var o=r.O(void 0,[76],(()=>r(891)));o=r.O(o)})();
//# sourceMappingURL=upload.js.map