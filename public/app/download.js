(()=>{var e,t={17:(e,t,a)=>{"use strict";a(459);var s=a(257),n=a.n(s),r=a(751),i=a.n(r);a(280),a(908),a(434),a(98),a(843),a(183),a(207);const o={props:["file"],computed:{iconClass(){const e=this.file.type||this.file.metadata&&this.file.metadata.type;return e?e.startsWith("image")?"regular/file-image":e.startsWith("text")?"regular/file-alt":e.startsWith("video")?"regular/file-video":e.startsWith("audio")?"regular/file-audio":"application/pdf"===e?"regular/file-pdf":e.startsWith("application")?"regular/file-archive":"regular/file":"regular/file"},isImageBlob(){return!(!URL&&!webkitURL)&&this.file instanceof File&&this.file.type.startsWith("image")},blobUrl(){if(this.isImageBlob)return(URL||webkitURL).createObjectURL(this.file)}}};var l=a(486);const c=(0,l.A)(o,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"file-icon"},[e.isImageBlob?e._e():t("icon",{attrs:{name:e.iconClass,scale:"3"}}),e.isImageBlob?t("img",{attrs:{src:e.blobUrl}}):e._e()],1)}),[],!1,null,null,null).exports;a(547),a(794),a(211);const d={name:"Clipboard",props:{value:{type:String,required:!0}},data:()=>({state:"pristine"}),methods:{copy(){let e=document.createElement("textarea");Object.assign(e.style,{position:"absolute",left:"-200%"}),e.value=this.value,document.body.appendChild(e);let t=!1;try{e.select(),t=document.execCommand("copy")}catch(e){alert(this.$root.lang.oldBrowserError),console.error(e)}document.body.removeChild(e),this.state=t?"copied":"error",this.$emit("change",this.state)}}},u=(0,l.A)(d,(function(){var e=this,t=e._self._c;return t("span",{staticStyle:{cursor:"pointer"},on:{click:function(t){return t.stopPropagation(),e.copy()}}},[e._t("default",(function(){return["pristine"===e.state?t("icon",{staticClass:"fa-fw",attrs:{name:"copy"}}):e._e(),"copied"===e.state?t("icon",{staticClass:"fa-fw",attrs:{name:"check"}}):e._e(),"error"===e.state?t("icon",{staticClass:"fa-fw",attrs:{name:"exclamation-triangle"}}):e._e(),e._t("text",(function(){return[e._v(" "+e._s(e.$root.lang.clipboard))]}))]}),{state:e.state})],2)}),[],!1,null,null,null).exports,p={props:{hasHeader:{type:Boolean,default:!1},hasFooter:{type:Boolean,default:!1}},mounted(){this.$nextTick((function(){this.$refs.modal.focus()}))},methods:{close(){this.$emit("close")}}},h=(0,l.A)(p,(function(){var e=this,t=e._self._c;return t("div",{ref:"modal",staticClass:"modal fade in background-darken",staticStyle:{display:"block"},attrs:{tabindex:"-1",role:"dialog"},on:{click:function(t){return t.target!==t.currentTarget?null:e.close()},keyup:[function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"esc",27,t.key,["Esc","Escape"])?null:e.close()},function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"left",37,t.key,["Left","ArrowLeft"])||"button"in t&&0!==t.button?null:e.$emit("prev")},function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"right",39,t.key,["Right","ArrowRight"])||"button"in t&&2!==t.button?null:e.$emit("next")}]}},[t("div",{staticClass:"modal-dialog modal-fluid",attrs:{role:"document"}},[t("div",{staticClass:"modal-content"},[e.hasHeader?t("div",{staticClass:"modal-header"},[t("button",{staticClass:"close",attrs:{type:"button","data-dismiss":"modal","aria-label":"Close"},on:{click:function(t){return e.close()}}},[t("span",{attrs:{"aria-hidden":"true"}},[e._v("Ã—")])]),t("h4",{staticClass:"modal-title"},[e._t("header",(function(){return[e._v(" Modal")]}))],2)]):e._e(),t("div",{staticClass:"modal-body"},[e._t("body",(function(){return[e._v(" Body")]}))],2),e.hasFooter?t("div",{staticClass:"modal-footer"},[e._t("footer")],2):e._e()])])])}),[],!1,null,null,null).exports;var f=a(842);f.A.register({"arrow-left":{width:448,height:512,paths:[{d:"M257.5 445.1l-22.2 22.2c-9.4 9.4-24.6 9.4-33.9 0l-194.4-194.3c-9.4-9.4-9.4-24.6 0-33.9l194.4-194.4c9.4-9.4 24.6-9.4 33.9 0l22.2 22.2c9.5 9.5 9.3 25-0.4 34.3l-120.5 114.8h287.4c13.3 0 24 10.7 24 24v32c0 13.3-10.7 24-24 24h-287.4l120.5 114.8c9.8 9.3 10 24.8 0.4 34.3z"}]}}),f.A.register({"arrow-right":{width:448,height:512,paths:[{d:"M190.5 66.9l22.2-22.2c9.4-9.4 24.6-9.4 33.9 0l194.4 194.3c9.4 9.4 9.4 24.6 0 33.9l-194.4 194.4c-9.4 9.4-24.6 9.4-33.9 0l-22.2-22.2c-9.5-9.5-9.3-25 0.4-34.3l120.5-114.8h-287.4c-13.3 0-24-10.7-24-24v-32c0-13.3 10.7-24 24-24h287.4l-120.5-114.8c-9.8-9.3-10-24.8-0.4-34.3z"}]}}),f.A.register({"undo-alt":{width:512,height:512,paths:[{d:"M255.5 8c136.8-0.2 248.5 111.2 248.5 248 0 137-111 248-248 248-63.9 0-122.2-24.2-166.2-63.9-5.1-4.6-5.4-12.6-0.5-17.4l39.7-39.7c4.5-4.5 11.6-4.7 16.4-0.6 30.6 26.9 69.5 41.6 110.6 41.6 93.8 0 167.2-76 168-166.6 0.8-95.5-77.1-170.2-169.5-169.4-42.4 0.4-82.4 16.4-113.2 45.3l41.8 41.8c15.1 15.1 4.4 41-17 41h-134.1c-13.3 0-24-10.7-24-24v-134.1c0-21.4 25.9-32.1 41-17l35.7 35.7c44.4-42.5 104.6-68.6 170.9-68.7z"}]}});const m={components:{Modal:h},props:["preview","files","maxSize"],data:()=>({previewText:"",lineWrap:!1,current:!1}),computed:{currentIndex:function(){return this.files.indexOf(this.current)}},watch:{preview:function(e){this.current=e},current:function(e,t){!1===e&&this.$emit("close"),"text"===e.previewType&&e!==t&&this.getPreviewText()}},methods:{next(){this.currentIndex>=this.files.length-1||(this.current=this.files[this.currentIndex+1])},prev(){this.currentIndex<=0||(this.current=this.files[this.currentIndex-1])},getPreviewText(){this.previewText="";const e=new XMLHttpRequest;e.open("GET",this.current.url),e.onload=()=>{200===e.status?this.previewText=e.responseText:this.previewText=`${e.status} ${e.statusText}: ${e.responseText}`},e.send()}}},v=(0,l.A)(m,(function(){var e=this,t=e._self._c;return e.current?t("modal",{staticClass:"preview-modal",attrs:{"has-header":!0},on:{close:function(t){e.current=!1},next:e.next,prev:e.prev}},[t("div",{staticClass:"header",attrs:{slot:"header"},slot:"header"},[t("p",[t("strong",[e._v(e._s(e.current.metadata.name))])]),t("div",[t("small",[e._v(e._s(e.currentIndex+1)+" / "+e._s(e.files.length))]),t("span",{staticClass:"btn-group"},[t("a",{directives:[{name:"show",rawName:"v-show",value:e.currentIndex>0,expression:"currentIndex > 0"}],staticClass:"btn btn-sm btn-default",attrs:{title:"previous"},on:{click:e.prev}},[t("icon",{attrs:{name:"arrow-left"}})],1),t("a",{directives:[{name:"show",rawName:"v-show",value:e.currentIndex<e.files.length-1,expression:"currentIndex < files.length-1"}],staticClass:"btn btn-sm btn-default",attrs:{title:"next"},on:{click:e.next}},[t("icon",{attrs:{name:"arrow-right"}})],1),t("a",{directives:[{name:"show",rawName:"v-show",value:"text"===e.current.previewType,expression:"current.previewType === 'text'"}],staticClass:"btn btn-sm btn-default",class:{active:e.lineWrap},attrs:{title:"toggle line wrap"},on:{click:function(t){e.lineWrap=!e.lineWrap}}},[t("icon",{attrs:{name:"undo-alt",flip:"vertical"}})],1)])])]),t("div",{attrs:{slot:"body"},slot:"body"},["image"===e.current.previewType?t("div",{staticStyle:{"text-align":"center"}},[t("img",{staticStyle:{"max-width":"100%",height:"auto"},attrs:{src:e.current.url}})]):e._e(),"text"===e.current.previewType?t("div",[t("pre",{style:{"white-space":e.lineWrap?"pre-wrap":"pre"}},[e._v(e._s(e.previewText))])]):e._e(),!1===e.current.previewType?t("p",{staticStyle:{"text-align":"center"}},[t("strong",{staticClass:"text-danger"},[e._v(e._s(e.$root.lang.noPreviewAvailable))])]):e._e()])]):e._e()}),[],!1,null,null,null).exports;a(548),f.A.register({download:{width:512,height:512,paths:[{d:"M216 0h80c13.3 0 24 10.7 24 24v168h87.7c17.8 0 26.7 21.5 14.1 34.1l-152.1 152.2c-7.5 7.5-19.8 7.5-27.3 0l-152.3-152.2c-12.6-12.6-3.7-34.1 14.1-34.1h87.8v-168c0-13.3 10.7-24 24-24zM512 376v112c0 13.3-10.7 24-24 24h-464c-13.3 0-24-10.7-24-24v-112c0-13.3 10.7-24 24-24h146.7l49 49c20.1 20.1 52.5 20.1 72.6 0l49-49h146.7c13.3 0 24 10.7 24 24zM388 464c0-11-9-20-20-20s-20 9-20 20 9 20 20 20 20-9 20-20zM452 464c0-11-9-20-20-20s-20 9-20 20 9 20 20 20 20-9 20-20z"}]}}),a(560),f.A.register({eye:{width:576,height:512,paths:[{d:"M572.5 241.4c2.2 4.4 3.5 9.4 3.5 14.6 0 5.2-1.2 10.2-3.5 14.6-54.2 105.8-161.6 177.4-284.5 177.4s-230.3-71.6-284.5-177.4c-2.2-4.4-3.5-9.4-3.5-14.6 0-5.2 1.2-10.2 3.5-14.6 54.2-105.8 161.6-177.4 284.5-177.4s230.3 71.6 284.5 177.4zM288 400c0 0 0 0 0.1 0 79.4 0 143.9-64.5 143.9-143.9v-0.1c0-79.5-64.5-144-144-144s-144 64.5-144 144 64.5 144 144 144zM288 160c0.1 0 0.2 0 0.2 0 52.9 0 95.8 42.9 95.8 95.8s-42.9 95.8-95.8 95.8-95.8-42.9-95.8-95.8c0-8.7 1.2-17.1 3.3-25.1 7.9 5.8 17.7 9.3 28.3 9.3 26.4 0 47.8-21.4 47.8-47.8 0-10.6-3.4-20.4-9.3-28.3 8-2.3 16.5-3.7 25.3-3.8z"}]}});const w={name:"app",components:{FileIcon:c,Clipboard:u,PreviewModal:v},data(){return{files:[],sid:document.location.pathname.match(/^.*\/([^\/?#]+)/)[1],baseURI:this.$root.baseURI,passwordWrong:!1,needsPassword:!1,loading:!0,password:"",content:"",error:"",config:{},preview:!1}},computed:{downloadsAvailable:function(){return this.files.filter((e=>!e.downloaded||"one-time"!==e.metadata.retention)).length>0},previewFiles:function(){return this.files.filter((e=>!!e.previewType))}},methods:{download(e){if(e.downloaded&&"one-time"===e.metadata.retention)return void alert(this.$root.lang.oneTimeDownloadExpired);const t=document.createElement("a");t.setAttribute("href",e.url),t.setAttribute("download",e.metadata.name),t.style.display="none",document.body.appendChild(t),t.click(),document.body.removeChild(t),e.downloaded=!0},downloadAll(e){document.location.href=this.$root.baseURI+"/files/"+this.sid+"++"+i()(this.files.filter((e=>!e.downloaded||"one-time"!==e.metadata.retention)).map((e=>e.key)).join()).toString()+"."+e,this.files.forEach((e=>{e.downloaded=!0}))},copied(e,t){e.downloaded="copied"===t},humanFileSize(e){let t=-1,a=e;do{a/=1024,t++}while(a>1024);return Math.max(a,.01).toFixed(2)+[" kB"," MB"," GB"," TB","PB","EB","ZB","YB"][t]},newSession(){document.location.href=this.$root.baseURI},isFinite:e=>"number"==typeof e&&!(e!=e||e===1/0||e===-1/0),fetchBucket(){const e=new XMLHttpRequest;e.open("GET",this.sid+".json"),this.password&&e.setRequestHeader("x-download-pass",this.password),e.onload=()=>{if(200===e.status)try{const t=JSON.parse(e.responseText);this.config=t.config,this.files=t.items.map((e=>{return Object.assign(e,{downloaded:!1,previewType:(t=e,a=this.config.maxPreviewSize,!(!t||!t.metadata)&&"one-time"!==t.metadata.retention&&!(t.size>a)&&(t.metadata.type&&t.metadata.type.match(/^image\/.*/)?"image":!!(t.metadata.type&&t.metadata.type.match(/(text\/|xml|json|javascript|x-sh)/)||t.metadata.name&&t.metadata.name.match(/\.(jsx|vue|sh|pug|less|scss|sass|c|h|conf|log|bat|cmd|lua|class|java|py|php|yml|sql|md)$/))&&"text"))});var t,a})),this.loading=!1,this.needsPassword=!1}catch(e){this.error=e.toString()}else 401===e.status?(this.needsPassword?this.passwordWrong=!0:this.needsPassword=!0,this.loading=!1):this.error=`${e.status} ${e.statusText}: ${e.responseText}`},e.send()}},beforeMount(){this.fetchBucket()}};const g=(0,l.A)(w,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"download-app"},[t("a",{staticClass:"btn btn-sm btn-info btn-new-session",attrs:{title:e.$root.lang.newUpload},on:{click:function(t){return e.newSession()}}},[t("icon",{staticClass:"fa-fw",attrs:{name:"cloud-upload-alt"}}),t("span",{staticClass:"hidden-xs"},[e._v(" "+e._s(e.$root.lang.newUpload))])],1),t("div",{directives:[{name:"show",rawName:"v-show",value:e.error,expression:"error"}],staticClass:"alert alert-danger"},[t("strong",[t("icon",{staticClass:"fa-fw",attrs:{name:"exclamation-triangle"}}),e._v(" "+e._s(e.error))],1)]),e.needsPassword?t("div",{staticClass:"well"},[t("h3",[e._v(e._s(e.$root.lang.password))]),t("div",{staticClass:"form-group"},[t("input",{directives:[{name:"model",rawName:"v-model",value:e.password,expression:"password"}],staticClass:"form-control",attrs:{type:"password",autofocus:""},domProps:{value:e.password},on:{keyup:function(t){if(!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter"))return null;e.password.length&&e.fetchBucket()},input:function(t){t.target.composing||(e.password=t.target.value)}}})]),t("p",{directives:[{name:"show",rawName:"v-show",value:e.passwordWrong,expression:"passwordWrong"}],staticClass:"text-danger"},[t("strong",[e._v(e._s(e.$root.lang.accessDenied))])]),t("button",{staticClass:"decrypt btn btn-primary",attrs:{disabled:e.password.length<1},on:{click:function(t){return e.fetchBucket()}}},[t("icon",{staticClass:"fa-fw",attrs:{name:"key"}}),e._v(" "+e._s(e.$root.lang.decrypt))],1)]):e._e(),e.needsPassword||e.loading?e._e():t("div",{staticClass:"panel panel-primary"},[t("div",{staticClass:"panel-heading"},[t("strong",[e._v(e._s(e.$root.lang.files))]),e.downloadsAvailable?t("div",{staticClass:"pull-right btn-group btn-download-archive"},[t("a",{staticClass:"btn btn-sm btn-default",attrs:{title:e.$root.lang.zipDownload,tabindex:"0",role:"button"},on:{click:function(t){return e.downloadAll("zip")},keydown:[function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:(t.preventDefault(),e.downloadAll("zip"))},function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"space",32,t.key,[" ","Spacebar"])?null:(t.preventDefault(),e.downloadAll("zip"))}]}},[t("icon",{staticClass:"fa-fw",attrs:{name:"download"}}),e._v(" zip")],1),t("a",{staticClass:"btn btn-sm btn-default",attrs:{title:e.$root.lang.tarGzDownload,tabindex:"0",role:"button"},on:{click:function(t){return e.downloadAll("tar.gz")},keydown:[function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:(t.preventDefault(),e.downloadAll("tar.gz"))},function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"space",32,t.key,[" ","Spacebar"])?null:(t.preventDefault(),e.downloadAll("tar.gz"))}]}},[t("icon",{staticClass:"fa-fw",attrs:{name:"download"}}),e._v(" tar.gz")],1)]):e._e()]),t("div",{staticClass:"panel-body"},[t("table",{staticClass:"table table-hover table-striped files"},[t("tbody",e._l(e.files,(function(a){return t("tr",{staticStyle:{cursor:"pointer"},attrs:{tabindex:"0",role:"button"},on:{click:function(t){return e.download(a)},keydown:[function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:(t.preventDefault(),e.download(a))},function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"space",32,t.key,[" ","Spacebar"])?null:(t.preventDefault(),e.download(a))}]}},[t("td",{staticClass:"file-icon"},[t("file-icon",{attrs:{file:a}})],1),t("td",[t("div",{staticClass:"pull-right btn-group"},[t("clipboard",{staticClass:"btn btn-sm btn-default",attrs:{value:e.baseURI+a.url,title:e.$root.lang.copyToClipboard},on:{change:function(t){return e.copied(a,t)}}},[t("a",[t("icon",{attrs:{name:"copy"}})],1)]),a.previewType?t("a",{staticClass:"btn btn-sm btn-default",attrs:{title:e.$root.lang.preview},on:{click:function(t){t.preventDefault(),t.stopPropagation(),e.preview=a}}},[t("icon",{attrs:{name:"eye"}})],1):e._e()],1),t("i",{directives:[{name:"show",rawName:"v-show",value:a.downloaded,expression:"file.downloaded"}],staticClass:"pull-right fa fa-check text-success downloaded"}),t("p",[t("strong",[e._v(e._s(a.metadata.name))]),isFinite(a.size)?t("small",{staticClass:"file-size"},[e._v("("+e._s(e.humanFileSize(a.size))+")")]):e._e()]),t("p",[e._v(e._s(a.metadata.comment))])])])})),0)])])]),t("preview-modal",{attrs:{preview:e.preview,files:e.previewFiles,"max-size":e.config.maxPreviewSize},on:{close:function(t){e.preview=!1}}})],1)}),[],!1,null,null,null).exports;String.prototype.startsWith||(String.prototype.startsWith=function(e,t){return t=t||0,this.indexOf(e,t)===t}),n().component("icon",f.A),new(n())({el:"#download",data:{baseURI:document.head.getElementsByTagName("base")[0].href.replace(/\/$/,""),lang:{}},async beforeCreate(){try{this.lang=await async function(){return new Promise(((e,t)=>{const a=new XMLHttpRequest;a.open("GET","lang.json"),a.onload=()=>{if(200===a.status)try{e(JSON.parse(a.responseText))}catch(e){t(e)}else t(new Error(`HTTP-GET error: ${a.status} ${a.statusText}`))},a.send()}))}()}catch(e){alert(e)}},render:e=>e(g)}),window.PSITRANSFER_VERSION="#36c67dfb4b"},477:()=>{}},a={};function s(e){var n=a[e];if(void 0!==n)return n.exports;var r=a[e]={exports:{}};return t[e].call(r.exports,r,r.exports,s),r.exports}s.m=t,e=[],s.O=(t,a,n,r)=>{if(!a){var i=1/0;for(d=0;d<e.length;d++){for(var[a,n,r]=e[d],o=!0,l=0;l<a.length;l++)(!1&r||i>=r)&&Object.keys(s.O).every((e=>s.O[e](a[l])))?a.splice(l--,1):(o=!1,r<i&&(i=r));if(o){e.splice(d--,1);var c=n();void 0!==c&&(t=c)}}return t}r=r||0;for(var d=e.length;d>0&&e[d-1][2]>r;d--)e[d]=e[d-1];e[d]=[a,n,r]},s.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return s.d(t,{a:t}),t},s.d=(e,t)=>{for(var a in t)s.o(t,a)&&!s.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})},s.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),s.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),s.j=467,(()=>{var e={467:0};s.O.j=t=>0===e[t];var t=(t,a)=>{var n,r,[i,o,l]=a,c=0;if(i.some((t=>0!==e[t]))){for(n in o)s.o(o,n)&&(s.m[n]=o[n]);if(l)var d=l(s)}for(t&&t(a);c<i.length;c++)r=i[c],s.o(e,r)&&e[r]&&e[r][0](),e[r]=0;return s.O(d)},a=self.webpackChunkpsitransfer=self.webpackChunkpsitransfer||[];a.forEach(t.bind(null,0)),a.push=t.bind(null,a.push.bind(a))})();var n=s.O(void 0,[76],(()=>s(17)));n=s.O(n)})();
//# sourceMappingURL=download.js.map